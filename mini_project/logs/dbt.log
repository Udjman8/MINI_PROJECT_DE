[0m19:09:55.940210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DD2B35A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DD2B35A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DD2B354C0>]}


============================== 19:09:55.940210 | dc59606c-8d88-448d-bb2c-747e2b9bd5f1 ==============================
[0m19:09:55.940210 [info ] [MainThread]: Running with dbt=1.7.19
[0m19:09:55.940210 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\DasariUday\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\DasariUday\\venv\\.venv\\mini_project\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:09:55.940210 [info ] [MainThread]: dbt version: 1.7.19
[0m19:09:55.940210 [info ] [MainThread]: python version: 3.12.9
[0m19:09:55.940210 [info ] [MainThread]: python path: c:\Users\DasariUday\venv\.venv\Scripts\python.exe
[0m19:09:55.940210 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m19:09:56.271073 [info ] [MainThread]: Using profiles dir at C:\Users\DasariUday\.dbt
[0m19:09:56.271073 [info ] [MainThread]: Using profiles.yml file at C:\Users\DasariUday\.dbt\profiles.yml
[0m19:09:56.272372 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\DasariUday\venv\.venv\mini_project\dbt_project.yml
[0m19:09:56.273415 [info ] [MainThread]: adapter type: snowflake
[0m19:09:56.274433 [info ] [MainThread]: adapter version: 1.7.0
[0m19:09:56.353096 [info ] [MainThread]: Configuration:
[0m19:09:56.354062 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:09:56.355063 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:09:56.355063 [info ] [MainThread]: Required dependencies:
[0m19:09:56.356063 [debug] [MainThread]: Executing "git --help"
[0m19:09:56.398558 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:09:56.398558 [debug] [MainThread]: STDERR: "b''"
[0m19:09:56.413801 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:09:56.414811 [info ] [MainThread]: Connection:
[0m19:09:56.415341 [info ] [MainThread]:   account: PVUSQTI-AJB57755
[0m19:09:56.415341 [info ] [MainThread]:   user: udaydasari8
[0m19:09:56.416369 [info ] [MainThread]:   database: MINI_PROJECT
[0m19:09:56.417300 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m19:09:56.417300 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m19:09:56.418339 [info ] [MainThread]:   schema: RAW
[0m19:09:56.419311 [info ] [MainThread]:   authenticator: None
[0m19:09:56.419311 [info ] [MainThread]:   private_key_path: None
[0m19:09:56.420306 [info ] [MainThread]:   token: None
[0m19:09:56.421308 [info ] [MainThread]:   oauth_client_id: None
[0m19:09:56.421308 [info ] [MainThread]:   query_tag: None
[0m19:09:56.422307 [info ] [MainThread]:   client_session_keep_alive: False
[0m19:09:56.422307 [info ] [MainThread]:   host: None
[0m19:09:56.423306 [info ] [MainThread]:   port: None
[0m19:09:56.424308 [info ] [MainThread]:   proxy_host: None
[0m19:09:56.424843 [info ] [MainThread]:   proxy_port: None
[0m19:09:56.425353 [info ] [MainThread]:   protocol: None
[0m19:09:56.426300 [info ] [MainThread]:   connect_retries: 1
[0m19:09:56.427453 [info ] [MainThread]:   connect_timeout: None
[0m19:09:56.427453 [info ] [MainThread]:   retry_on_database_errors: False
[0m19:09:56.428493 [info ] [MainThread]:   retry_all: False
[0m19:09:56.429459 [info ] [MainThread]:   insecure_mode: False
[0m19:09:56.429459 [info ] [MainThread]:   reuse_connections: None
[0m19:09:56.430461 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m19:09:56.432461 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m19:09:56.433459 [debug] [MainThread]: Using snowflake connection "debug"
[0m19:09:56.433459 [debug] [MainThread]: On debug: select 1 as id
[0m19:09:56.433459 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:09:58.900255 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m19:09:58.915226 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m19:09:58.915226 [debug] [MainThread]: On debug: No close available on handle
[0m19:09:58.916299 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m19:09:58.917044 [info ] [MainThread]: [31m1 check failed:[0m
[0m19:09:58.918161 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB: PVUSQTI-AJB57755.snowflakecomputing.com:443. Incorrect username or password was specified.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m19:09:58.919127 [debug] [MainThread]: Command `dbt debug` failed at 19:09:58.919127 after 3.12 seconds
[0m19:09:58.919127 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:09:58.920161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DD3780290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DD298C3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DD2ED07D0>]}
[0m19:09:58.920161 [debug] [MainThread]: Flushing usage events
[0m09:55:12.651391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DD26CC5370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DD26CC5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DD26CC4EC0>]}


============================== 09:55:12.656691 | 3e53c38a-7c49-4d40-afa0-b5af19513146 ==============================
[0m09:55:12.656691 [info ] [MainThread]: Running with dbt=1.7.19
[0m09:55:12.657432 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\DasariUday\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\DasariUday\\venv\\.venv\\mini_project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:55:12.658425 [info ] [MainThread]: dbt version: 1.7.19
[0m09:55:12.658425 [info ] [MainThread]: python version: 3.12.9
[0m09:55:12.659427 [info ] [MainThread]: python path: c:\Users\DasariUday\venv\.venv\Scripts\python.exe
[0m09:55:12.660392 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m09:55:12.969179 [info ] [MainThread]: Using profiles dir at C:\Users\DasariUday\.dbt
[0m09:55:12.969179 [info ] [MainThread]: Using profiles.yml file at C:\Users\DasariUday\.dbt\profiles.yml
[0m09:55:12.969179 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\DasariUday\venv\.venv\mini_project\dbt_project.yml
[0m09:55:12.969179 [info ] [MainThread]: adapter type: snowflake
[0m09:55:12.969179 [info ] [MainThread]: adapter version: 1.7.0
[0m09:55:13.064689 [info ] [MainThread]: Configuration:
[0m09:55:13.065688 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:55:13.066584 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:55:13.066584 [info ] [MainThread]: Required dependencies:
[0m09:55:13.067591 [debug] [MainThread]: Executing "git --help"
[0m09:55:13.114818 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:55:13.114818 [debug] [MainThread]: STDERR: "b''"
[0m09:55:13.114818 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:55:13.114818 [info ] [MainThread]: Connection:
[0m09:55:13.114818 [info ] [MainThread]:   account: pvusqti-ajb57755
[0m09:55:13.114818 [info ] [MainThread]:   user: udaydasari8
[0m09:55:13.114818 [info ] [MainThread]:   database: MINI_PROJECT
[0m09:55:13.114818 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m09:55:13.114818 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m09:55:13.114818 [info ] [MainThread]:   schema: RAW
[0m09:55:13.114818 [info ] [MainThread]:   authenticator: None
[0m09:55:13.114818 [info ] [MainThread]:   private_key_path: None
[0m09:55:13.114818 [info ] [MainThread]:   token: None
[0m09:55:13.123944 [info ] [MainThread]:   oauth_client_id: None
[0m09:55:13.123944 [info ] [MainThread]:   query_tag: None
[0m09:55:13.124985 [info ] [MainThread]:   client_session_keep_alive: False
[0m09:55:13.125950 [info ] [MainThread]:   host: None
[0m09:55:13.125950 [info ] [MainThread]:   port: None
[0m09:55:13.126950 [info ] [MainThread]:   proxy_host: None
[0m09:55:13.126950 [info ] [MainThread]:   proxy_port: None
[0m09:55:13.127951 [info ] [MainThread]:   protocol: None
[0m09:55:13.128646 [info ] [MainThread]:   connect_retries: 1
[0m09:55:13.129780 [info ] [MainThread]:   connect_timeout: None
[0m09:55:13.130775 [info ] [MainThread]:   retry_on_database_errors: False
[0m09:55:13.131773 [info ] [MainThread]:   retry_all: False
[0m09:55:13.131773 [info ] [MainThread]:   insecure_mode: False
[0m09:55:13.132771 [info ] [MainThread]:   reuse_connections: None
[0m09:55:13.133777 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m09:55:13.135694 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m09:55:13.135694 [debug] [MainThread]: Using snowflake connection "debug"
[0m09:55:13.136735 [debug] [MainThread]: On debug: select 1 as id
[0m09:55:13.136735 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:55:15.308816 [debug] [MainThread]: SQL status: SUCCESS 1 in 2.0 seconds
[0m09:55:15.308816 [debug] [MainThread]: On debug: Close
[0m09:55:15.963825 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:55:15.963825 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:55:15.963825 [debug] [MainThread]: Command `dbt debug` succeeded at 09:55:15.963825 after 3.46 seconds
[0m09:55:15.963825 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:55:15.963825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DD26A4BC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DD276E36E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DD28BAEF30>]}
[0m09:55:15.963825 [debug] [MainThread]: Flushing usage events
[0m09:57:17.678615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F130B6090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F130B6480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F130B4590>]}


============================== 09:57:17.684613 | f68815bd-fda3-4113-a57b-fce525cca6eb ==============================
[0m09:57:17.684613 [info ] [MainThread]: Running with dbt=1.7.19
[0m09:57:17.684613 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'c:\\Users\\DasariUday\\venv\\.venv\\mini_project\\logs', 'profiles_dir': 'C:\\Users\\DasariUday\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:57:17.834706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f68815bd-fda3-4113-a57b-fce525cca6eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F13151760>]}
[0m09:57:17.837707 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:57:17.840561 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:57:17.840561 [debug] [MainThread]: Command `cli deps` succeeded at 09:57:17.840561 after 0.62 seconds
[0m09:57:17.842572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F12EE84A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F13105910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F130B6000>]}
[0m09:57:17.842572 [debug] [MainThread]: Flushing usage events
[0m10:11:42.221353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242754750D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024275475430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024275474E90>]}


============================== 10:11:42.221353 | 62ee8bbc-028c-49ac-8a83-4f702184ef75 ==============================
[0m10:11:42.221353 [info ] [MainThread]: Running with dbt=1.7.19
[0m10:11:42.221353 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\DasariUday\\venv\\.venv\\mini_project\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\DasariUday\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m tag:raw', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:11:42.866889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62ee8bbc-028c-49ac-8a83-4f702184ef75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024274506BA0>]}
[0m10:11:42.912262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '62ee8bbc-028c-49ac-8a83-4f702184ef75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242761CE960>]}
[0m10:11:42.912262 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m10:11:42.933973 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m10:11:43.004632 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:11:43.004632 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:11:43.010632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '62ee8bbc-028c-49ac-8a83-4f702184ef75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242773942C0>]}
[0m10:11:43.066112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62ee8bbc-028c-49ac-8a83-4f702184ef75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002427740BF50>]}
[0m10:11:43.078727 [info ] [MainThread]: Found 8 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m10:11:43.078727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62ee8bbc-028c-49ac-8a83-4f702184ef75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024274E51DC0>]}
[0m10:11:43.083380 [info ] [MainThread]: 
[0m10:11:43.084380 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:11:43.086380 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL'
[0m10:11:43.102821 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL"
[0m10:11:43.102821 [debug] [ThreadPool]: On list_JOB_PORTAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL"} */
show terse schemas in database JOB_PORTAL
    limit 10000
[0m10:11:43.102821 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:11:45.449877 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.0 seconds
[0m10:11:45.450815 [debug] [ThreadPool]: On list_JOB_PORTAL: Close
[0m10:11:46.092419 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JOB_PORTAL, now create_JOB_PORTAL_RAW)
[0m10:11:46.092419 [debug] [ThreadPool]: Creating schema "database: "JOB_PORTAL"
schema: "RAW"
"
[0m10:11:46.106498 [debug] [ThreadPool]: Using snowflake connection "create_JOB_PORTAL_RAW"
[0m10:11:46.106498 [debug] [ThreadPool]: On create_JOB_PORTAL_RAW: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "create_JOB_PORTAL_RAW"} */
create schema if not exists JOB_PORTAL.RAW
[0m10:11:46.106498 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:11:47.899719 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 2.0 seconds
[0m10:11:47.902044 [debug] [ThreadPool]: On create_JOB_PORTAL_RAW: Close
[0m10:11:48.543830 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL_RAW'
[0m10:11:48.551659 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_RAW"
[0m10:11:48.552662 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m10:11:48.552662 [debug] [ThreadPool]: On list_JOB_PORTAL_RAW: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_RAW"} */
show terse objects in JOB_PORTAL.RAW limit 10000
[0m10:11:48.555685 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m10:11:48.556420 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:11:48.556420 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show terse objects in MINI_PROJECT.RAW limit 10000
[0m10:11:48.558557 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:11:50.356045 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 2.0 seconds
[0m10:11:50.356045 [debug] [ThreadPool]: On list_JOB_PORTAL_RAW: Close
[0m10:11:50.386891 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m10:11:50.395923 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: Close
[0m10:11:51.013249 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JOB_PORTAL_RAW, now list_JOB_PORTAL_MART)
[0m10:11:51.015249 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_MART"
[0m10:11:51.015249 [debug] [ThreadPool]: On list_JOB_PORTAL_MART: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_MART"} */
show terse objects in JOB_PORTAL.MART limit 10000
[0m10:11:51.016248 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:11:51.038163 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_RAW, now list_JOB_PORTAL_PREP)
[0m10:11:51.038163 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_PREP"
[0m10:11:51.038163 [debug] [ThreadPool]: On list_JOB_PORTAL_PREP: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_PREP"} */
show terse objects in JOB_PORTAL.PREP limit 10000
[0m10:11:51.038163 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:11:53.157370 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafeb9-0004-bded-0005-d15300016722
[0m10:11:53.157370 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafeb9-0004-c0bd-0005-d15300018062
[0m10:11:53.157370 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m10:11:53.157370 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m10:11:53.157370 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m10:11:53.157370 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m10:11:53.157370 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m10:11:53.157370 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m10:11:53.157370 [debug] [ThreadPool]: On list_JOB_PORTAL_PREP: Close
[0m10:11:53.157370 [debug] [ThreadPool]: On list_JOB_PORTAL_MART: Close
[0m10:11:53.803791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62ee8bbc-028c-49ac-8a83-4f702184ef75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242776A3AD0>]}
[0m10:11:53.803791 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m10:11:53.803791 [info ] [MainThread]: 
[0m10:11:53.842552 [debug] [Thread-2 (]: Began running node model.mini_project.raw_products
[0m10:11:53.827802 [debug] [Thread-1 (]: Began running node model.mini_project.raw_customers
[0m10:11:53.843574 [info ] [Thread-2 (]: 2 of 3 START sql table model JOB_PORTAL.RAW.raw_products ....................... [RUN]
[0m10:11:53.844558 [info ] [Thread-1 (]: 1 of 3 START sql table model JOB_PORTAL.RAW.raw_customers ...................... [RUN]
[0m10:11:53.846558 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.mini_project.raw_products'
[0m10:11:53.846558 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project.raw_customers'
[0m10:11:53.847557 [debug] [Thread-2 (]: Began compiling node model.mini_project.raw_products
[0m10:11:53.848576 [debug] [Thread-1 (]: Began compiling node model.mini_project.raw_customers
[0m10:11:53.849424 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.raw_products"
[0m10:11:53.864048 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.raw_customers"
[0m10:11:53.867806 [debug] [Thread-1 (]: Timing info for model.mini_project.raw_customers (compile): 10:11:53.859211 => 10:11:53.866798
[0m10:11:53.867806 [debug] [Thread-1 (]: Began executing node model.mini_project.raw_customers
[0m10:11:53.897479 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.raw_customers"
[0m10:11:53.897479 [debug] [Thread-2 (]: Timing info for model.mini_project.raw_products (compile): 10:11:53.848576 => 10:11:53.897479
[0m10:11:53.897479 [debug] [Thread-2 (]: Began executing node model.mini_project.raw_products
[0m10:11:53.897479 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.raw_products"
[0m10:11:53.909241 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.raw_customers"
[0m10:11:53.911218 [debug] [Thread-1 (]: On model.mini_project.raw_customers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.raw_customers"} */
create or replace transient table JOB_PORTAL.RAW.raw_customers
         as
        (
SELECT 
    * 
FROM 
    MINI_PROJECT.RAW.Customers 
    WHERE CUSTOMER_ID 
          IS NOT NULL
        );
[0m10:11:53.911218 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.raw_products"
[0m10:11:53.911218 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:11:53.911218 [debug] [Thread-2 (]: On model.mini_project.raw_products: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.raw_products"} */
create or replace transient table JOB_PORTAL.RAW.raw_products
         as
        (
SELECT 
     *
FROM 
     MINI_PROJECT.RAW.Products 
     WHERE PRODUCT_ID 
           IS NOT NULL
        );
[0m10:11:53.911218 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:11:57.104378 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m10:11:57.126162 [debug] [Thread-2 (]: Timing info for model.mini_project.raw_products (execute): 10:11:53.897479 => 10:11:57.126162
[0m10:11:57.126162 [debug] [Thread-2 (]: On model.mini_project.raw_products: Close
[0m10:11:57.128167 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m10:11:57.128167 [debug] [Thread-1 (]: Timing info for model.mini_project.raw_customers (execute): 10:11:53.867806 => 10:11:57.128167
[0m10:11:57.128167 [debug] [Thread-1 (]: On model.mini_project.raw_customers: Close
[0m10:11:57.782824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62ee8bbc-028c-49ac-8a83-4f702184ef75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002427781E2A0>]}
[0m10:11:57.783824 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62ee8bbc-028c-49ac-8a83-4f702184ef75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002427781E1B0>]}
[0m10:11:57.784825 [info ] [Thread-1 (]: 1 of 3 OK created sql table model JOB_PORTAL.RAW.raw_customers ................. [[32mSUCCESS 1[0m in 3.94s]
[0m10:11:57.785825 [debug] [Thread-1 (]: Finished running node model.mini_project.raw_customers
[0m10:11:57.786825 [debug] [Thread-1 (]: Began running node model.mini_project.raw_transaction
[0m10:11:57.785825 [info ] [Thread-2 (]: 2 of 3 OK created sql table model JOB_PORTAL.RAW.raw_products .................. [[32mSUCCESS 1[0m in 3.94s]
[0m10:11:57.788825 [debug] [Thread-2 (]: Finished running node model.mini_project.raw_products
[0m10:11:57.786825 [info ] [Thread-1 (]: 3 of 3 START sql table model JOB_PORTAL.RAW.raw_transaction .................... [RUN]
[0m10:11:57.789830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.raw_customers, now model.mini_project.raw_transaction)
[0m10:11:57.789830 [debug] [Thread-1 (]: Began compiling node model.mini_project.raw_transaction
[0m10:11:57.792824 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.raw_transaction"
[0m10:11:57.794825 [debug] [Thread-1 (]: Timing info for model.mini_project.raw_transaction (compile): 10:11:57.789830 => 10:11:57.794825
[0m10:11:57.795829 [debug] [Thread-1 (]: Began executing node model.mini_project.raw_transaction
[0m10:11:57.799340 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.raw_transaction"
[0m10:11:57.801340 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.raw_transaction"
[0m10:11:57.802137 [debug] [Thread-1 (]: On model.mini_project.raw_transaction: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.raw_transaction"} */
create or replace transient table JOB_PORTAL.RAW.raw_transaction
         as
        (
SELECT 
     *
FROM 
    MINI_PROJECT.RAW.Transaction 
    WHERE CUSTOMER_ID 
          IS NOT NULL
        );
[0m10:11:57.803219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:12:01.052851 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m10:12:01.054859 [debug] [Thread-1 (]: Timing info for model.mini_project.raw_transaction (execute): 10:11:57.796448 => 10:12:01.054859
[0m10:12:01.054859 [debug] [Thread-1 (]: On model.mini_project.raw_transaction: Close
[0m10:12:01.679893 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62ee8bbc-028c-49ac-8a83-4f702184ef75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024277750080>]}
[0m10:12:01.679893 [info ] [Thread-1 (]: 3 of 3 OK created sql table model JOB_PORTAL.RAW.raw_transaction ............... [[32mSUCCESS 1[0m in 3.89s]
[0m10:12:01.679893 [debug] [Thread-1 (]: Finished running node model.mini_project.raw_transaction
[0m10:12:01.679893 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:12:01.679893 [debug] [MainThread]: Connection 'create_JOB_PORTAL_RAW' was properly closed.
[0m10:12:01.679893 [debug] [MainThread]: Connection 'list_JOB_PORTAL_MART' was properly closed.
[0m10:12:01.679893 [debug] [MainThread]: Connection 'list_JOB_PORTAL_PREP' was properly closed.
[0m10:12:01.679893 [debug] [MainThread]: Connection 'model.mini_project.raw_products' was properly closed.
[0m10:12:01.679893 [debug] [MainThread]: Connection 'model.mini_project.raw_transaction' was properly closed.
[0m10:12:01.679893 [info ] [MainThread]: 
[0m10:12:01.679893 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 18.60 seconds (18.60s).
[0m10:12:01.688348 [debug] [MainThread]: Command end result
[0m10:12:01.702248 [info ] [MainThread]: 
[0m10:12:01.704582 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:12:01.705603 [info ] [MainThread]: 
[0m10:12:01.705935 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m10:12:01.706943 [debug] [MainThread]: Command `dbt run` succeeded at 10:12:01.706943 after 19.88 seconds
[0m10:12:01.706943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002427533EC30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024275F3BB30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024270BA6930>]}
[0m10:12:01.707980 [debug] [MainThread]: Flushing usage events
[0m10:13:09.529007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001946F56CF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001946F56E1E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001946F56C9B0>]}


============================== 10:13:09.529007 | 7e769de0-6a3e-41b7-b4e4-75e5a618ad71 ==============================
[0m10:13:09.529007 [info ] [MainThread]: Running with dbt=1.7.19
[0m10:13:09.529007 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\DasariUday\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\DasariUday\\venv\\.venv\\mini_project\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed -m mapping', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:13:09.901651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e769de0-6a3e-41b7-b4e4-75e5a618ad71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001946FFDA1E0>]}
[0m10:13:09.961824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e769de0-6a3e-41b7-b4e4-75e5a618ad71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001946F179BB0>]}
[0m10:13:09.962824 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m10:13:09.968453 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m10:13:10.043407 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:13:10.043407 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:13:10.049443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e769de0-6a3e-41b7-b4e4-75e5a618ad71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001947135CD70>]}
[0m10:13:10.052409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e769de0-6a3e-41b7-b4e4-75e5a618ad71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194713ABFB0>]}
[0m10:13:10.052409 [info ] [MainThread]: Found 8 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m10:13:10.052409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e769de0-6a3e-41b7-b4e4-75e5a618ad71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001946F59DF10>]}
[0m10:13:10.064913 [info ] [MainThread]: 
[0m10:13:10.064913 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:13:10.064913 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m10:13:10.074966 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m10:13:10.074966 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m10:13:10.074966 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:13:12.295179 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m10:13:12.295179 [debug] [ThreadPool]: On list_MINI_PROJECT: Close
[0m10:13:12.925105 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL_MART'
[0m10:13:12.925105 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_MART"
[0m10:13:12.925105 [debug] [ThreadPool]: On list_JOB_PORTAL_MART: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_MART"} */
show terse objects in JOB_PORTAL.MART limit 10000
[0m10:13:12.925105 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m10:13:12.925105 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:13:12.925105 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m10:13:12.941102 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show terse objects in MINI_PROJECT.RAW limit 10000
[0m10:13:12.941102 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:13:14.755256 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m10:13:14.755256 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: Close
[0m10:13:14.755256 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafebb-0004-c0bd-0005-d15300018096
[0m10:13:14.755256 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m10:13:14.755256 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m10:13:14.755256 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m10:13:14.755256 [debug] [ThreadPool]: On list_JOB_PORTAL_MART: Close
[0m10:13:15.410284 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_RAW, now list_JOB_PORTAL_PREP)
[0m10:13:15.412288 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_PREP"
[0m10:13:15.414292 [debug] [ThreadPool]: On list_JOB_PORTAL_PREP: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_PREP"} */
show terse objects in JOB_PORTAL.PREP limit 10000
[0m10:13:15.414292 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:13:15.419925 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JOB_PORTAL_MART, now list_JOB_PORTAL_RAW)
[0m10:13:15.423938 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_RAW"
[0m10:13:15.423938 [debug] [ThreadPool]: On list_JOB_PORTAL_RAW: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_RAW"} */
show terse objects in JOB_PORTAL.RAW limit 10000
[0m10:13:15.423938 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:13:17.290311 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafebb-0004-bde4-0005-d15300015696
[0m10:13:17.290311 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m10:13:17.290311 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m10:13:17.290311 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m10:13:17.290311 [debug] [ThreadPool]: On list_JOB_PORTAL_PREP: Close
[0m10:13:17.335260 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m10:13:17.335260 [debug] [ThreadPool]: On list_JOB_PORTAL_RAW: Close
[0m10:13:17.973447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e769de0-6a3e-41b7-b4e4-75e5a618ad71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194714EE180>]}
[0m10:13:17.973447 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m10:13:17.973447 [info ] [MainThread]: 
[0m10:13:17.988764 [debug] [Thread-1 (]: Began running node seed.mini_project.mapping
[0m10:13:17.988764 [info ] [Thread-1 (]: 1 of 1 START seed file RAW.mapping ............................................. [RUN]
[0m10:13:17.988764 [debug] [Thread-1 (]: Acquiring new snowflake connection 'seed.mini_project.mapping'
[0m10:13:17.994666 [debug] [Thread-1 (]: Began compiling node seed.mini_project.mapping
[0m10:13:17.994666 [debug] [Thread-1 (]: Timing info for seed.mini_project.mapping (compile): 10:13:17.994666 => 10:13:17.994666
[0m10:13:17.995602 [debug] [Thread-1 (]: Began executing node seed.mini_project.mapping
[0m10:13:18.073907 [debug] [Thread-1 (]: Using snowflake connection "seed.mini_project.mapping"
[0m10:13:18.074906 [debug] [Thread-1 (]: On seed.mini_project.mapping: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "seed.mini_project.mapping"} */
create table MINI_PROJECT.RAW.mapping ("customer_id;country;region" text)
[0m10:13:18.074906 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:13:19.955778 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m10:13:19.987340 [debug] [Thread-1 (]: Using snowflake connection "seed.mini_project.mapping"
[0m10:13:19.987340 [debug] [Thread-1 (]: On seed.mini_project.mapping: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "seed.mini_project.mapping"} */
BEGIN
[0m10:13:20.358731 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m10:13:20.390832 [debug] [Thread-1 (]: Using snowflake connection "seed.mini_project.mapping"
[0m10:13:20.390832 [debug] [Thread-1 (]: On seed.mini_project.mapping: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "seed.mini_project.mapping"} */
insert into MINI_PROJECT.RAW.mapping ("customer_id;country;region") values
            (%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),...
[0m10:13:21.238683 [debug] [Thread-1 (]: SQL status: SUCCESS 1760 in 1.0 seconds
[0m10:13:21.238683 [debug] [Thread-1 (]: Using snowflake connection "seed.mini_project.mapping"
[0m10:13:21.238683 [debug] [Thread-1 (]: On seed.mini_project.mapping: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "seed.mini_project.mapping"} */
COMMIT
[0m10:13:21.781982 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:13:21.787895 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.mini_project.mapping"
[0m10:13:21.813275 [debug] [Thread-1 (]: Timing info for seed.mini_project.mapping (execute): 10:13:17.996102 => 10:13:21.803208
[0m10:13:21.813275 [debug] [Thread-1 (]: On seed.mini_project.mapping: Close
[0m10:13:22.451489 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e769de0-6a3e-41b7-b4e4-75e5a618ad71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019471608D10>]}
[0m10:13:22.452490 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file RAW.mapping ......................................... [[32mINSERT 1760[0m in 4.46s]
[0m10:13:22.453491 [debug] [Thread-1 (]: Finished running node seed.mini_project.mapping
[0m10:13:22.455490 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:13:22.455490 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was properly closed.
[0m10:13:22.455490 [debug] [MainThread]: Connection 'list_JOB_PORTAL_RAW' was properly closed.
[0m10:13:22.456489 [debug] [MainThread]: Connection 'list_JOB_PORTAL_PREP' was properly closed.
[0m10:13:22.456489 [debug] [MainThread]: Connection 'seed.mini_project.mapping' was properly closed.
[0m10:13:22.456489 [info ] [MainThread]: 
[0m10:13:22.457489 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 12.39 seconds (12.39s).
[0m10:13:22.458491 [debug] [MainThread]: Command end result
[0m10:13:22.470705 [info ] [MainThread]: 
[0m10:13:22.470705 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:13:22.470705 [info ] [MainThread]: 
[0m10:13:22.470705 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:13:22.470705 [debug] [MainThread]: Command `dbt seed` succeeded at 10:13:22.470705 after 13.09 seconds
[0m10:13:22.470705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001946F545280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194702200B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001946F59DF10>]}
[0m10:13:22.470705 [debug] [MainThread]: Flushing usage events
[0m10:15:53.727804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192E20E5190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192E20E5160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192E20E4F50>]}


============================== 10:15:53.732383 | abea5090-27fe-4a65-9c35-de46b203471d ==============================
[0m10:15:53.732383 [info ] [MainThread]: Running with dbt=1.7.19
[0m10:15:53.732383 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\DasariUday\\venv\\.venv\\mini_project\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\DasariUday\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt seed -m mapping', 'send_anonymous_usage_stats': 'True'}
[0m10:15:54.113842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'abea5090-27fe-4a65-9c35-de46b203471d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192E2DCEB10>]}
[0m10:15:54.177581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'abea5090-27fe-4a65-9c35-de46b203471d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192E210EAE0>]}
[0m10:15:54.177581 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m10:15:54.177581 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m10:15:54.249319 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:15:54.249319 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:15:54.249319 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.mapping
[0m10:15:54.264468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'abea5090-27fe-4a65-9c35-de46b203471d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192E2E63C80>]}
[0m10:15:54.278407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'abea5090-27fe-4a65-9c35-de46b203471d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192E400B140>]}
[0m10:15:54.279407 [info ] [MainThread]: Found 8 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m10:15:54.279407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abea5090-27fe-4a65-9c35-de46b203471d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192E2DF7170>]}
[0m10:15:54.281406 [info ] [MainThread]: 
[0m10:15:54.283223 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:15:54.284224 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m10:15:54.298741 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m10:15:54.298741 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m10:15:54.301124 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:15:56.705909 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m10:15:56.705909 [debug] [ThreadPool]: On list_MINI_PROJECT: Close
[0m10:15:57.361838 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL_MART'
[0m10:15:57.373575 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_MART"
[0m10:15:57.373575 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL_PREP'
[0m10:15:57.373575 [debug] [ThreadPool]: On list_JOB_PORTAL_MART: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_MART"} */
show terse objects in JOB_PORTAL.MART limit 10000
[0m10:15:57.373575 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_PREP"
[0m10:15:57.373575 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:15:57.379558 [debug] [ThreadPool]: On list_JOB_PORTAL_PREP: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_PREP"} */
show terse objects in JOB_PORTAL.PREP limit 10000
[0m10:15:57.381565 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:15:59.151342 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafebd-0004-bde4-0005-d153000156be
[0m10:15:59.151342 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m10:15:59.151342 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m10:15:59.151342 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m10:15:59.151342 [debug] [ThreadPool]: On list_JOB_PORTAL_MART: Close
[0m10:15:59.214890 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafebd-0004-bded-0005-d1530001677e
[0m10:15:59.214890 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m10:15:59.225738 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m10:15:59.225738 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m10:15:59.225738 [debug] [ThreadPool]: On list_JOB_PORTAL_PREP: Close
[0m10:15:59.903095 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JOB_PORTAL_MART, now list_MINI_PROJECT_RAW)
[0m10:15:59.906848 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m10:15:59.906848 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show terse objects in MINI_PROJECT.RAW limit 10000
[0m10:15:59.906848 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:15:59.964421 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JOB_PORTAL_PREP, now list_JOB_PORTAL_RAW)
[0m10:15:59.968027 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_RAW"
[0m10:15:59.968027 [debug] [ThreadPool]: On list_JOB_PORTAL_RAW: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_RAW"} */
show terse objects in JOB_PORTAL.RAW limit 10000
[0m10:15:59.968027 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:16:01.788496 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m10:16:01.788496 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: Close
[0m10:16:01.808107 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m10:16:01.814212 [debug] [ThreadPool]: On list_JOB_PORTAL_RAW: Close
[0m10:16:02.433883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abea5090-27fe-4a65-9c35-de46b203471d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192E3F2FD10>]}
[0m10:16:02.433883 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m10:16:02.433883 [info ] [MainThread]: 
[0m10:16:02.449588 [debug] [Thread-1 (]: Began running node seed.mini_project.mapping
[0m10:16:02.449588 [info ] [Thread-1 (]: 1 of 1 START seed file RAW.mapping ............................................. [RUN]
[0m10:16:02.449588 [debug] [Thread-1 (]: Acquiring new snowflake connection 'seed.mini_project.mapping'
[0m10:16:02.453990 [debug] [Thread-1 (]: Began compiling node seed.mini_project.mapping
[0m10:16:02.453990 [debug] [Thread-1 (]: Timing info for seed.mini_project.mapping (compile): 10:16:02.453990 => 10:16:02.453990
[0m10:16:02.455031 [debug] [Thread-1 (]: Began executing node seed.mini_project.mapping
[0m10:16:02.492310 [debug] [Thread-1 (]: Using snowflake connection "seed.mini_project.mapping"
[0m10:16:02.492310 [debug] [Thread-1 (]: On seed.mini_project.mapping: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "seed.mini_project.mapping"} */
create table MINI_PROJECT.RAW.mapping ("customer_id;country;region" text)
[0m10:16:02.492310 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:16:04.532156 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m10:16:04.562901 [debug] [Thread-1 (]: Using snowflake connection "seed.mini_project.mapping"
[0m10:16:04.562901 [debug] [Thread-1 (]: On seed.mini_project.mapping: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "seed.mini_project.mapping"} */
BEGIN
[0m10:16:05.069588 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:16:05.085316 [debug] [Thread-1 (]: Using snowflake connection "seed.mini_project.mapping"
[0m10:16:05.085316 [debug] [Thread-1 (]: On seed.mini_project.mapping: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "seed.mini_project.mapping"} */
insert into MINI_PROJECT.RAW.mapping ("customer_id;country;region") values
            (%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),...
[0m10:16:06.156700 [debug] [Thread-1 (]: SQL status: SUCCESS 1760 in 1.0 seconds
[0m10:16:06.156700 [debug] [Thread-1 (]: Using snowflake connection "seed.mini_project.mapping"
[0m10:16:06.156700 [debug] [Thread-1 (]: On seed.mini_project.mapping: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "seed.mini_project.mapping"} */
COMMIT
[0m10:16:06.755779 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:16:06.755779 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.mini_project.mapping"
[0m10:16:06.770549 [debug] [Thread-1 (]: Timing info for seed.mini_project.mapping (execute): 10:16:02.455566 => 10:16:06.770549
[0m10:16:06.770549 [debug] [Thread-1 (]: On seed.mini_project.mapping: Close
[0m10:16:07.417201 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abea5090-27fe-4a65-9c35-de46b203471d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192E2E63F80>]}
[0m10:16:07.417201 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file RAW.mapping ......................................... [[32mINSERT 1760[0m in 4.97s]
[0m10:16:07.417201 [debug] [Thread-1 (]: Finished running node seed.mini_project.mapping
[0m10:16:07.432998 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:16:07.432998 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was properly closed.
[0m10:16:07.432998 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was properly closed.
[0m10:16:07.432998 [debug] [MainThread]: Connection 'list_JOB_PORTAL_RAW' was properly closed.
[0m10:16:07.432998 [debug] [MainThread]: Connection 'seed.mini_project.mapping' was properly closed.
[0m10:16:07.432998 [info ] [MainThread]: 
[0m10:16:07.432998 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 13.15 seconds (13.15s).
[0m10:16:07.436449 [debug] [MainThread]: Command end result
[0m10:16:07.447056 [info ] [MainThread]: 
[0m10:16:07.448302 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:16:07.449311 [info ] [MainThread]: 
[0m10:16:07.450366 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:16:07.451399 [debug] [MainThread]: Command `dbt seed` succeeded at 10:16:07.451399 after 13.87 seconds
[0m10:16:07.451399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192E15776E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192E1B66AB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192E430E420>]}
[0m10:16:07.452405 [debug] [MainThread]: Flushing usage events
[0m10:17:38.603492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A869655400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8696553A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8696551F0>]}


============================== 10:17:38.635601 | c84a17ff-aec0-4c0c-b858-2574e0890ec5 ==============================
[0m10:17:38.635601 [info ] [MainThread]: Running with dbt=1.7.19
[0m10:17:38.636989 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\DasariUday\\venv\\.venv\\mini_project\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\DasariUday\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt seed -m mapping', 'send_anonymous_usage_stats': 'True'}
[0m10:17:45.162741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c84a17ff-aec0-4c0c-b858-2574e0890ec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A869656DE0>]}
[0m10:17:45.235841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c84a17ff-aec0-4c0c-b858-2574e0890ec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A86A245B20>]}
[0m10:17:45.237853 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m10:17:45.255701 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m10:17:45.385936 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:17:45.385936 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:17:45.395972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c84a17ff-aec0-4c0c-b858-2574e0890ec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A86A363920>]}
[0m10:17:45.445404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c84a17ff-aec0-4c0c-b858-2574e0890ec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A86B57BFE0>]}
[0m10:17:45.447157 [info ] [MainThread]: Found 8 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m10:17:45.449168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c84a17ff-aec0-4c0c-b858-2574e0890ec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8696ADF10>]}
[0m10:17:45.453187 [info ] [MainThread]: 
[0m10:17:45.455197 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:17:45.457204 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m10:17:45.488827 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m10:17:45.490831 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m10:17:45.490831 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:17:48.144673 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 3.0 seconds
[0m10:17:48.156572 [debug] [ThreadPool]: On list_MINI_PROJECT: Close
[0m10:17:48.811088 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m10:17:48.813095 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL_RAW'
[0m10:17:48.824507 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_RAW"
[0m10:17:48.826748 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m10:17:48.826748 [debug] [ThreadPool]: On list_JOB_PORTAL_RAW: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_RAW"} */
show terse objects in JOB_PORTAL.RAW limit 10000
[0m10:17:48.826748 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show terse objects in MINI_PROJECT.RAW limit 10000
[0m10:17:48.826748 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:17:48.826748 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:17:50.620606 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m10:17:50.620606 [debug] [ThreadPool]: On list_JOB_PORTAL_RAW: Close
[0m10:17:50.620606 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m10:17:50.633902 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: Close
[0m10:17:51.267825 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JOB_PORTAL_RAW, now list_JOB_PORTAL_MART)
[0m10:17:51.267825 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_MART"
[0m10:17:51.267825 [debug] [ThreadPool]: On list_JOB_PORTAL_MART: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_MART"} */
show terse objects in JOB_PORTAL.MART limit 10000
[0m10:17:51.267825 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:17:51.267825 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_RAW, now list_JOB_PORTAL_PREP)
[0m10:17:51.267825 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_PREP"
[0m10:17:51.267825 [debug] [ThreadPool]: On list_JOB_PORTAL_PREP: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_PREP"} */
show terse objects in JOB_PORTAL.PREP limit 10000
[0m10:17:51.281768 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:17:53.495884 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafebf-0004-bde4-0005-d15300015722
[0m10:17:53.495884 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m10:17:53.495884 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m10:17:53.495884 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m10:17:53.495884 [debug] [ThreadPool]: On list_JOB_PORTAL_PREP: Close
[0m10:17:53.495884 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafebf-0004-c0bd-0005-d15300018156
[0m10:17:53.495884 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m10:17:53.495884 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m10:17:53.495884 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m10:17:53.495884 [debug] [ThreadPool]: On list_JOB_PORTAL_MART: Close
[0m10:17:54.134534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c84a17ff-aec0-4c0c-b858-2574e0890ec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A86B7FAC30>]}
[0m10:17:54.134534 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m10:17:54.134534 [info ] [MainThread]: 
[0m10:17:54.171415 [debug] [Thread-1 (]: Began running node seed.mini_project.mapping
[0m10:17:54.171415 [info ] [Thread-1 (]: 1 of 1 START seed file RAW.mapping ............................................. [RUN]
[0m10:17:54.171415 [debug] [Thread-1 (]: Acquiring new snowflake connection 'seed.mini_project.mapping'
[0m10:17:54.184864 [debug] [Thread-1 (]: Began compiling node seed.mini_project.mapping
[0m10:17:54.185599 [debug] [Thread-1 (]: Timing info for seed.mini_project.mapping (compile): 10:17:54.185599 => 10:17:54.185599
[0m10:17:54.185599 [debug] [Thread-1 (]: Began executing node seed.mini_project.mapping
[0m10:17:54.274070 [debug] [Thread-1 (]: Using snowflake connection "seed.mini_project.mapping"
[0m10:17:54.274070 [debug] [Thread-1 (]: On seed.mini_project.mapping: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "seed.mini_project.mapping"} */
create table MINI_PROJECT.RAW.mapping ("customer_id" integer,"country" text,"region" text)
[0m10:17:54.274070 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:17:56.162410 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m10:17:56.210741 [debug] [Thread-1 (]: Using snowflake connection "seed.mini_project.mapping"
[0m10:17:56.210741 [debug] [Thread-1 (]: On seed.mini_project.mapping: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "seed.mini_project.mapping"} */
BEGIN
[0m10:17:56.583223 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m10:17:56.630850 [debug] [Thread-1 (]: Using snowflake connection "seed.mini_project.mapping"
[0m10:17:56.630850 [debug] [Thread-1 (]: On seed.mini_project.mapping: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "seed.mini_project.mapping"} */
insert into MINI_PROJECT.RAW.mapping ("customer_id", "country", "region") values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,...
[0m10:17:57.703066 [debug] [Thread-1 (]: SQL status: SUCCESS 1760 in 1.0 seconds
[0m10:17:57.703066 [debug] [Thread-1 (]: Using snowflake connection "seed.mini_project.mapping"
[0m10:17:57.703066 [debug] [Thread-1 (]: On seed.mini_project.mapping: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "seed.mini_project.mapping"} */
COMMIT
[0m10:17:58.294108 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:17:58.309260 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.mini_project.mapping"
[0m10:17:58.484840 [debug] [Thread-1 (]: Timing info for seed.mini_project.mapping (execute): 10:17:54.185599 => 10:17:58.484840
[0m10:17:58.484840 [debug] [Thread-1 (]: On seed.mini_project.mapping: Close
[0m10:17:59.113411 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c84a17ff-aec0-4c0c-b858-2574e0890ec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A86BA62C90>]}
[0m10:17:59.257388 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file RAW.mapping ......................................... [[32mINSERT 1760[0m in 4.94s]
[0m10:17:59.259401 [debug] [Thread-1 (]: Finished running node seed.mini_project.mapping
[0m10:17:59.261410 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:17:59.261410 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was properly closed.
[0m10:17:59.261410 [debug] [MainThread]: Connection 'list_JOB_PORTAL_PREP' was properly closed.
[0m10:17:59.261410 [debug] [MainThread]: Connection 'list_JOB_PORTAL_MART' was properly closed.
[0m10:17:59.261410 [debug] [MainThread]: Connection 'seed.mini_project.mapping' was properly closed.
[0m10:17:59.261410 [info ] [MainThread]: 
[0m10:17:59.261410 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 13.81 seconds (13.81s).
[0m10:17:59.261410 [debug] [MainThread]: Command end result
[0m10:17:59.273233 [info ] [MainThread]: 
[0m10:17:59.277506 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:17:59.277506 [info ] [MainThread]: 
[0m10:17:59.278680 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:17:59.281190 [debug] [MainThread]: Command `dbt seed` succeeded at 10:17:59.280572 after 21.13 seconds
[0m10:17:59.281769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A869655AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A869655190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A86951F020>]}
[0m10:17:59.281769 [debug] [MainThread]: Flushing usage events
[0m10:19:40.739008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1C3DA5100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1C3C98E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1C3DA6150>]}


============================== 10:19:40.754862 | c3fa0514-c9fb-461d-8331-6476ce3abe26 ==============================
[0m10:19:40.754862 [info ] [MainThread]: Running with dbt=1.7.19
[0m10:19:40.754862 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\DasariUday\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\DasariUday\\venv\\.venv\\mini_project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:19:41.806126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3fa0514-c9fb-461d-8331-6476ce3abe26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1C4B03B00>]}
[0m10:19:41.871647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3fa0514-c9fb-461d-8331-6476ce3abe26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1C3C573B0>]}
[0m10:19:41.871647 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m10:19:41.871647 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m10:19:42.006266 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:19:42.006266 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:19:42.022185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3fa0514-c9fb-461d-8331-6476ce3abe26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1C4B036E0>]}
[0m10:19:42.038076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3fa0514-c9fb-461d-8331-6476ce3abe26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1C5CA82F0>]}
[0m10:19:42.038076 [info ] [MainThread]: Found 8 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m10:19:42.038076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3fa0514-c9fb-461d-8331-6476ce3abe26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1C5CA8110>]}
[0m10:19:42.038076 [info ] [MainThread]: 
[0m10:19:42.038076 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:19:42.038076 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL'
[0m10:19:42.062313 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL'
[0m10:19:42.063354 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL"
[0m10:19:42.065320 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL"
[0m10:19:42.065320 [debug] [ThreadPool]: On list_JOB_PORTAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL"} */
show terse schemas in database JOB_PORTAL
    limit 10000
[0m10:19:42.066320 [debug] [ThreadPool]: On list_JOB_PORTAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL"} */
show terse schemas in database JOB_PORTAL
    limit 10000
[0m10:19:42.066320 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:19:42.067352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:19:44.428243 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m10:19:44.428243 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m10:19:44.428243 [debug] [ThreadPool]: On list_JOB_PORTAL: Close
[0m10:19:44.428243 [debug] [ThreadPool]: On list_JOB_PORTAL: Close
[0m10:19:45.072817 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL"
[0m10:19:45.072817 [debug] [ThreadPool]: On list_JOB_PORTAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL"} */
show terse schemas in database JOB_PORTAL
    limit 10000
[0m10:19:45.072817 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:19:46.848608 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m10:19:46.848608 [debug] [ThreadPool]: On list_JOB_PORTAL: Close
[0m10:19:47.523357 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JOB_PORTAL, now create_JOB_PORTAL_PREP)
[0m10:19:47.523357 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JOB_PORTAL, now create_JOB_PORTAL_MART)
[0m10:19:47.523357 [debug] [ThreadPool]: Creating schema "database: "JOB_PORTAL"
schema: "PREP"
"
[0m10:19:47.523357 [debug] [ThreadPool]: Creating schema "database: "JOB_PORTAL"
schema: "MART"
"
[0m10:19:47.539159 [debug] [ThreadPool]: Using snowflake connection "create_JOB_PORTAL_PREP"
[0m10:19:47.542209 [debug] [ThreadPool]: Using snowflake connection "create_JOB_PORTAL_MART"
[0m10:19:47.542209 [debug] [ThreadPool]: On create_JOB_PORTAL_PREP: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "create_JOB_PORTAL_PREP"} */
create schema if not exists JOB_PORTAL.PREP
[0m10:19:47.542209 [debug] [ThreadPool]: On create_JOB_PORTAL_MART: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "create_JOB_PORTAL_MART"} */
create schema if not exists JOB_PORTAL.MART
[0m10:19:47.542209 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:19:47.542209 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:19:49.301106 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 2.0 seconds
[0m10:19:49.301106 [debug] [ThreadPool]: On create_JOB_PORTAL_MART: Close
[0m10:19:49.372288 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 2.0 seconds
[0m10:19:49.372288 [debug] [ThreadPool]: On create_JOB_PORTAL_PREP: Close
[0m10:19:50.018363 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL_RAW'
[0m10:19:50.034469 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m10:19:50.040481 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_RAW"
[0m10:19:50.042484 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m10:19:50.042484 [debug] [ThreadPool]: On list_JOB_PORTAL_RAW: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_RAW"} */
show terse objects in JOB_PORTAL.RAW limit 10000
[0m10:19:50.042484 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show terse objects in MINI_PROJECT.RAW limit 10000
[0m10:19:50.042484 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:19:50.042484 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:19:51.852140 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m10:19:51.852140 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m10:19:51.852140 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: Close
[0m10:19:51.852140 [debug] [ThreadPool]: On list_JOB_PORTAL_RAW: Close
[0m10:19:52.514978 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JOB_PORTAL_RAW, now list_JOB_PORTAL_PREP)
[0m10:19:52.514978 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_PREP"
[0m10:19:52.529821 [debug] [ThreadPool]: On list_JOB_PORTAL_PREP: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_PREP"} */
show terse objects in JOB_PORTAL.PREP limit 10000
[0m10:19:52.529821 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:19:52.529821 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_RAW, now list_JOB_PORTAL_MART)
[0m10:19:52.529821 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_MART"
[0m10:19:52.529821 [debug] [ThreadPool]: On list_JOB_PORTAL_MART: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_MART"} */
show terse objects in JOB_PORTAL.MART limit 10000
[0m10:19:52.529821 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:19:54.305686 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 2.0 seconds
[0m10:19:54.305686 [debug] [ThreadPool]: On list_JOB_PORTAL_PREP: Close
[0m10:19:54.351910 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 2.0 seconds
[0m10:19:54.351910 [debug] [ThreadPool]: On list_JOB_PORTAL_MART: Close
[0m10:19:54.985290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3fa0514-c9fb-461d-8331-6476ce3abe26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1C487FE00>]}
[0m10:19:54.985290 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m10:19:54.985290 [info ] [MainThread]: 
[0m10:19:55.096231 [debug] [Thread-1 (]: Began running node model.mini_project.raw_customers
[0m10:19:55.098277 [debug] [Thread-2 (]: Began running node model.mini_project.raw_products
[0m10:19:55.099235 [info ] [Thread-1 (]: 1 of 8 START sql table model JOB_PORTAL.RAW.raw_customers ...................... [RUN]
[0m10:19:55.101225 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project.raw_customers'
[0m10:19:55.101225 [debug] [Thread-1 (]: Began compiling node model.mini_project.raw_customers
[0m10:19:55.110481 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.raw_customers"
[0m10:19:55.100260 [info ] [Thread-2 (]: 2 of 8 START sql table model JOB_PORTAL.RAW.raw_products ....................... [RUN]
[0m10:19:55.111480 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.mini_project.raw_products'
[0m10:19:55.112447 [debug] [Thread-2 (]: Began compiling node model.mini_project.raw_products
[0m10:19:55.115447 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.raw_products"
[0m10:19:55.208443 [debug] [Thread-1 (]: Timing info for model.mini_project.raw_customers (compile): 10:19:55.102222 => 10:19:55.207424
[0m10:19:55.209438 [debug] [Thread-2 (]: Timing info for model.mini_project.raw_products (compile): 10:19:55.112447 => 10:19:55.208443
[0m10:19:55.209438 [debug] [Thread-1 (]: Began executing node model.mini_project.raw_customers
[0m10:19:55.210473 [debug] [Thread-2 (]: Began executing node model.mini_project.raw_products
[0m10:19:55.239489 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.raw_products"
[0m10:19:55.255239 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.raw_customers"
[0m10:19:55.303694 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.raw_customers"
[0m10:19:55.303694 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.raw_products"
[0m10:19:55.303694 [debug] [Thread-1 (]: On model.mini_project.raw_customers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.raw_customers"} */
create or replace transient table JOB_PORTAL.RAW.raw_customers
         as
        (
SELECT 
    * 
FROM 
    MINI_PROJECT.RAW.Customers 
    WHERE CUSTOMER_ID 
          IS NOT NULL
        );
[0m10:19:55.303694 [debug] [Thread-2 (]: On model.mini_project.raw_products: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.raw_products"} */
create or replace transient table JOB_PORTAL.RAW.raw_products
         as
        (
SELECT 
     *
FROM 
     MINI_PROJECT.RAW.Products 
     WHERE PRODUCT_ID 
           IS NOT NULL
        );
[0m10:19:55.303694 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:19:55.303694 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:19:57.770266 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m10:19:57.801803 [debug] [Thread-2 (]: Timing info for model.mini_project.raw_products (execute): 10:19:55.239489 => 10:19:57.801803
[0m10:19:57.801803 [debug] [Thread-2 (]: On model.mini_project.raw_products: Close
[0m10:19:57.880648 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m10:19:57.880648 [debug] [Thread-1 (]: Timing info for model.mini_project.raw_customers (execute): 10:19:55.211440 => 10:19:57.880648
[0m10:19:57.880648 [debug] [Thread-1 (]: On model.mini_project.raw_customers: Close
[0m10:19:58.447957 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3fa0514-c9fb-461d-8331-6476ce3abe26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1C5DFD520>]}
[0m10:19:58.447957 [info ] [Thread-2 (]: 2 of 8 OK created sql table model JOB_PORTAL.RAW.raw_products .................. [[32mSUCCESS 1[0m in 3.34s]
[0m10:19:58.447957 [debug] [Thread-2 (]: Finished running node model.mini_project.raw_products
[0m10:19:58.447957 [debug] [Thread-2 (]: Began running node model.mini_project.raw_transaction
[0m10:19:58.447957 [info ] [Thread-2 (]: 3 of 8 START sql table model JOB_PORTAL.RAW.raw_transaction .................... [RUN]
[0m10:19:58.447957 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mini_project.raw_products, now model.mini_project.raw_transaction)
[0m10:19:58.447957 [debug] [Thread-2 (]: Began compiling node model.mini_project.raw_transaction
[0m10:19:58.460728 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.raw_transaction"
[0m10:19:58.509903 [debug] [Thread-2 (]: Timing info for model.mini_project.raw_transaction (compile): 10:19:58.447957 => 10:19:58.508695
[0m10:19:58.509903 [debug] [Thread-2 (]: Began executing node model.mini_project.raw_transaction
[0m10:19:58.513174 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.raw_transaction"
[0m10:19:58.514169 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.raw_transaction"
[0m10:19:58.515172 [debug] [Thread-2 (]: On model.mini_project.raw_transaction: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.raw_transaction"} */
create or replace transient table JOB_PORTAL.RAW.raw_transaction
         as
        (
SELECT 
     *
FROM 
    MINI_PROJECT.RAW.Transaction 
    WHERE CUSTOMER_ID 
          IS NOT NULL
        );
[0m10:19:58.515172 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:19:58.527205 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3fa0514-c9fb-461d-8331-6476ce3abe26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1C6037860>]}
[0m10:19:58.527205 [info ] [Thread-1 (]: 1 of 8 OK created sql table model JOB_PORTAL.RAW.raw_customers ................. [[32mSUCCESS 1[0m in 3.43s]
[0m10:19:58.527205 [debug] [Thread-1 (]: Finished running node model.mini_project.raw_customers
[0m10:19:58.527205 [debug] [Thread-1 (]: Began running node model.mini_project.prep_products
[0m10:19:58.527205 [info ] [Thread-1 (]: 4 of 8 START sql table model JOB_PORTAL.PREP.prep_products ..................... [RUN]
[0m10:19:58.527205 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.raw_customers, now model.mini_project.prep_products)
[0m10:19:58.527205 [debug] [Thread-1 (]: Began compiling node model.mini_project.prep_products
[0m10:19:58.527205 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.prep_products"
[0m10:19:58.527205 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_products (compile): 10:19:58.527205 => 10:19:58.527205
[0m10:19:58.527205 [debug] [Thread-1 (]: Began executing node model.mini_project.prep_products
[0m10:19:58.543088 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.prep_products"
[0m10:19:58.545814 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.prep_products"
[0m10:19:58.545814 [debug] [Thread-1 (]: On model.mini_project.prep_products: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.prep_products"} */
create or replace transient table JOB_PORTAL.PREP.prep_products
         as
        (
SELECT 
    PRODUCT_ID::VARCHAR AS PRODUCT_ID,
    LOWER(TRIM(PRODUCT_FAMILY)) AS PRODUCT_FAMILY,
    LOWER(TRIM(PRODUCT_SUB_FAMILY)) AS PRODUCT_SUB_FAMILY
FROM JOB_PORTAL.RAW.raw_products
        );
[0m10:19:58.546835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:20:01.324847 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m10:20:01.326853 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_products (execute): 10:19:58.527205 => 10:20:01.326853
[0m10:20:01.326853 [debug] [Thread-1 (]: On model.mini_project.prep_products: Close
[0m10:20:01.551920 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m10:20:01.553937 [debug] [Thread-2 (]: Timing info for model.mini_project.raw_transaction (execute): 10:19:58.509903 => 10:20:01.553937
[0m10:20:01.553937 [debug] [Thread-2 (]: On model.mini_project.raw_transaction: Close
[0m10:20:01.944944 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3fa0514-c9fb-461d-8331-6476ce3abe26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1C60376B0>]}
[0m10:20:01.944944 [info ] [Thread-1 (]: 4 of 8 OK created sql table model JOB_PORTAL.PREP.prep_products ................ [[32mSUCCESS 1[0m in 3.42s]
[0m10:20:01.944944 [debug] [Thread-1 (]: Finished running node model.mini_project.prep_products
[0m10:20:01.944944 [debug] [Thread-1 (]: Began running node model.mini_project.prep_customers
[0m10:20:01.944944 [info ] [Thread-1 (]: 5 of 8 START sql table model JOB_PORTAL.PREP.prep_customers .................... [RUN]
[0m10:20:01.944944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.prep_products, now model.mini_project.prep_customers)
[0m10:20:01.944944 [debug] [Thread-1 (]: Began compiling node model.mini_project.prep_customers
[0m10:20:01.958579 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.prep_customers"
[0m10:20:01.958579 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_customers (compile): 10:20:01.944944 => 10:20:01.958579
[0m10:20:01.958579 [debug] [Thread-1 (]: Began executing node model.mini_project.prep_customers
[0m10:20:01.958579 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.prep_customers"
[0m10:20:01.958579 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.prep_customers"
[0m10:20:01.958579 [debug] [Thread-1 (]: On model.mini_project.prep_customers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.prep_customers"} */
create or replace transient table JOB_PORTAL.PREP.prep_customers
         as
        (
SELECT DISTINCT
    LOWER(TRIM(COMPANY)) AS COMPANY,
    CUSTOMER_ID::NUMBER AS CUSTOMER_ID,
    LOWER(
        REGEXP_REPLACE(
            TRIM(REGEXP_SUBSTR(CUSTOMERNAME, '^[^(]+')), 
            ',', 
            ''
        )
    ) AS CUSTOMERNAME,  --  name without commas
    
FROM JOB_PORTAL.RAW.raw_customers
        );
[0m10:20:01.958579 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:20:02.173706 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3fa0514-c9fb-461d-8331-6476ce3abe26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1C5DFD520>]}
[0m10:20:02.173706 [info ] [Thread-2 (]: 3 of 8 OK created sql table model JOB_PORTAL.RAW.raw_transaction ............... [[32mSUCCESS 1[0m in 3.73s]
[0m10:20:02.173706 [debug] [Thread-2 (]: Finished running node model.mini_project.raw_transaction
[0m10:20:02.173706 [debug] [Thread-2 (]: Began running node model.mini_project.prep_transaction
[0m10:20:02.173706 [info ] [Thread-2 (]: 6 of 8 START sql table model JOB_PORTAL.PREP.prep_transaction .................. [RUN]
[0m10:20:02.173706 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mini_project.raw_transaction, now model.mini_project.prep_transaction)
[0m10:20:02.173706 [debug] [Thread-2 (]: Began compiling node model.mini_project.prep_transaction
[0m10:20:02.189741 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.prep_transaction"
[0m10:20:02.197772 [debug] [Thread-2 (]: Timing info for model.mini_project.prep_transaction (compile): 10:20:02.173706 => 10:20:02.197772
[0m10:20:02.197772 [debug] [Thread-2 (]: Began executing node model.mini_project.prep_transaction
[0m10:20:02.197772 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.prep_transaction"
[0m10:20:02.197772 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.prep_transaction"
[0m10:20:02.212497 [debug] [Thread-2 (]: On model.mini_project.prep_transaction: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.prep_transaction"} */
create or replace transient table JOB_PORTAL.PREP.prep_transaction
         as
        (
SELECT 
    CUSTOMER_ID::NUMBER AS CUSTOMER_ID,
    PRODUCT_ID::VARCHAR AS PRODUCT_ID,
    PAYMENT_MONTH::DATE AS PAYMENT_MONTH,
    REVENUE_TYPE::NUMBER AS REVENUE_TYPE,
    REVENUE::NUMBER(38,2) AS REVENUE,
    QUANTITY::NUMBER AS QUANTITY,
    LOWER(TRIM(DIMENSION_1)) AS DIMENSION_1,
    LOWER(TRIM(DIMENSION_2)) AS DIMENSION_2,
    LOWER(TRIM(DIMENSION_3)) AS DIMENSION_3,
    LOWER(TRIM(DIMENSION_4)) AS DIMENSION_4,
    LOWER(TRIM(DIMENSION_5)) AS DIMENSION_5,
    DIMENSION_6::BOOLEAN AS DIMENSION_6,
    LOWER(TRIM(DIMENSION_7)) AS DIMENSION_7,
    LOWER(TRIM(DIMENSION_8)) AS DIMENSION_8,
    LOWER(TRIM(DIMENSION_9)) AS DIMENSION_9,
    LOWER(TRIM(DIMENSION_10)) AS DIMENSION_10,
    LOWER(TRIM(COMPANIES)) AS COMPANIES
FROM JOB_PORTAL.RAW.raw_transaction
        );
[0m10:20:02.213511 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:20:04.363697 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m10:20:04.365705 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_customers (execute): 10:20:01.958579 => 10:20:04.365705
[0m10:20:04.367713 [debug] [Thread-1 (]: On model.mini_project.prep_customers: Close
[0m10:20:04.913580 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m10:20:04.918579 [debug] [Thread-2 (]: Timing info for model.mini_project.prep_transaction (execute): 10:20:02.197772 => 10:20:04.916572
[0m10:20:04.918579 [debug] [Thread-2 (]: On model.mini_project.prep_transaction: Close
[0m10:20:04.992900 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3fa0514-c9fb-461d-8331-6476ce3abe26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1C5FCA930>]}
[0m10:20:04.992900 [info ] [Thread-1 (]: 5 of 8 OK created sql table model JOB_PORTAL.PREP.prep_customers ............... [[32mSUCCESS 1[0m in 3.05s]
[0m10:20:04.992900 [debug] [Thread-1 (]: Finished running node model.mini_project.prep_customers
[0m10:20:05.575690 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3fa0514-c9fb-461d-8331-6476ce3abe26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1C5DFD970>]}
[0m10:20:05.575690 [info ] [Thread-2 (]: 6 of 8 OK created sql table model JOB_PORTAL.PREP.prep_transaction ............. [[32mSUCCESS 1[0m in 3.40s]
[0m10:20:05.575690 [debug] [Thread-2 (]: Finished running node model.mini_project.prep_transaction
[0m10:20:05.575690 [debug] [Thread-1 (]: Began running node model.mini_project.mart_job_portal
[0m10:20:05.575690 [info ] [Thread-1 (]: 7 of 8 START sql table model JOB_PORTAL.MART.mart_job_portal ................... [RUN]
[0m10:20:05.575690 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.prep_customers, now model.mini_project.mart_job_portal)
[0m10:20:05.575690 [debug] [Thread-1 (]: Began compiling node model.mini_project.mart_job_portal
[0m10:20:05.591942 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.mart_job_portal"
[0m10:20:05.594620 [debug] [Thread-1 (]: Timing info for model.mini_project.mart_job_portal (compile): 10:20:05.575690 => 10:20:05.593619
[0m10:20:05.594620 [debug] [Thread-1 (]: Began executing node model.mini_project.mart_job_portal
[0m10:20:05.599157 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.mart_job_portal"
[0m10:20:05.603241 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.mart_job_portal"
[0m10:20:05.603241 [debug] [Thread-1 (]: On model.mini_project.mart_job_portal: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.mart_job_portal"} */
create or replace transient table JOB_PORTAL.MART.mart_job_portal
         as
        (SELECT DISTINCT
    ST.CUSTOMER_ID,
    ST.PRODUCT_ID,
    ST.PAYMENT_MONTH,
    ST.REVENUE,
    ST.QUANTITY,
    CUST.COMPANY AS CUSTOMER_COMPANY,
    CUST.CUSTOMERNAME AS CUSTOMER_NAME,
    PROD.PRODUCT_FAMILY,
    PROD.PRODUCT_SUB_FAMILY
FROM JOB_PORTAL.PREP.prep_transaction ST
LEFT JOIN JOB_PORTAL.PREP.prep_customers CUST ON ST.CUSTOMER_ID = CUST.CUSTOMER_ID
LEFT JOIN JOB_PORTAL.PREP.prep_products PROD ON ST.PRODUCT_ID = PROD.PRODUCT_ID
        );
[0m10:20:05.604237 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:20:08.793706 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m10:20:08.796720 [debug] [Thread-1 (]: Timing info for model.mini_project.mart_job_portal (execute): 10:20:05.594620 => 10:20:08.796720
[0m10:20:08.797694 [debug] [Thread-1 (]: On model.mini_project.mart_job_portal: Close
[0m10:20:09.451378 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3fa0514-c9fb-461d-8331-6476ce3abe26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1C6134E00>]}
[0m10:20:09.467503 [info ] [Thread-1 (]: 7 of 8 OK created sql table model JOB_PORTAL.MART.mart_job_portal .............. [[32mSUCCESS 1[0m in 3.88s]
[0m10:20:09.467503 [debug] [Thread-1 (]: Finished running node model.mini_project.mart_job_portal
[0m10:20:09.467503 [debug] [Thread-2 (]: Began running node model.mini_project.lm_crb
[0m10:20:09.467503 [info ] [Thread-2 (]: 8 of 8 START sql table model JOB_PORTAL.RAW.lm_crb ............................. [RUN]
[0m10:20:09.467503 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mini_project.prep_transaction, now model.mini_project.lm_crb)
[0m10:20:09.478682 [debug] [Thread-2 (]: Began compiling node model.mini_project.lm_crb
[0m10:20:09.488188 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.lm_crb"
[0m10:20:09.617755 [debug] [Thread-2 (]: Timing info for model.mini_project.lm_crb (compile): 10:20:09.479831 => 10:20:09.617755
[0m10:20:09.617755 [debug] [Thread-2 (]: Began executing node model.mini_project.lm_crb
[0m10:20:09.633506 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.lm_crb"
[0m10:20:09.749928 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.lm_crb"
[0m10:20:09.749928 [debug] [Thread-2 (]: On model.mini_project.lm_crb: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.lm_crb"} */
create or replace transient table JOB_PORTAL.RAW.lm_crb
         as
        (-- -- CRB Layer: KPIs for Last Month (LM)

-- WITH period_filters AS (
--     SELECT 
--         (SELECT MAX(PAYMENT_MONTH) - INTERVAL '1 MONTH' FROM JOB_PORTAL.MART.mart_job_portal) AS START_DATE,
--         (SELECT MAX(PAYMENT_MONTH) FROM JOB_PORTAL.MART.mart_job_portal) AS TODAY
-- )
-- ,
-- customer_activity AS (
--     SELECT 
--         CUSTOMER_ID, 
--         MIN(PAYMENT_MONTH) AS FIRST_PURCHASE, 
--         MAX(PAYMENT_MONTH) AS LAST_PURCHASE
--     FROM JOB_PORTAL.MART.mart_job_portal
--     GROUP BY CUSTOMER_ID
-- ),
-- revenue_changes AS (
--     SELECT 
--         CUSTOMER_ID, 
--         PAYMENT_MONTH, 
--         SUM(REVENUE) AS MONTHLY_REVENUE
--     FROM JOB_PORTAL.MART.mart_job_portal
--     WHERE PAYMENT_MONTH BETWEEN (SELECT START_DATE FROM period_filters) AND (SELECT TODAY FROM period_filters)
--     GROUP BY CUSTOMER_ID, PAYMENT_MONTH
-- ),
-- nrr_calculation AS (
--     SELECT 
--         CUSTOMER_ID, 
--         PAYMENT_MONTH,
--         MONTHLY_REVENUE,
--         LAG(MONTHLY_REVENUE) OVER (PARTITION BY CUSTOMER_ID ORDER BY PAYMENT_MONTH) AS PREV_MONTHLY_REVENUE
--     FROM revenue_changes
-- ),
-- revenue_contraction AS (
--     SELECT 
--         CUSTOMER_ID, 
--         PAYMENT_MONTH, 
--         MONTHLY_REVENUE AS CURRENT_REVENUE,
--         PREV_MONTHLY_REVENUE
--     FROM nrr_calculation
-- ),
-- product_ranking AS (
--     SELECT 
--         PRODUCT_ID,
--         SUM(REVENUE) AS TOTAL_REVENUE,
--         RANK() OVER (ORDER BY SUM(REVENUE) DESC) AS PRODUCT_RANK
--     FROM JOB_PORTAL.MART.mart_job_portal
--     WHERE PAYMENT_MONTH BETWEEN (SELECT START_DATE FROM period_filters) AND (SELECT TODAY FROM period_filters)
--     GROUP BY PRODUCT_ID
-- ),
-- customer_ranking AS (
--     SELECT 
--         CUSTOMER_ID,
--         SUM(REVENUE) AS TOTAL_REVENUE,
--         RANK() OVER (ORDER BY SUM(REVENUE) DESC) AS CUSTOMER_RANK
--     FROM JOB_PORTAL.MART.mart_job_portal
--     WHERE PAYMENT_MONTH BETWEEN (SELECT START_DATE FROM period_filters) AND (SELECT TODAY FROM period_filters)
--     GROUP BY CUSTOMER_ID
-- ),
-- grr_calculation AS (
--     SELECT 
--         CUSTOMER_ID,
--         PAYMENT_MONTH,
--         MONTHLY_REVENUE,
--         LAG(MONTHLY_REVENUE) OVER (PARTITION BY CUSTOMER_ID ORDER BY PAYMENT_MONTH) AS PREV_MONTHLY_REVENUE
--     FROM revenue_changes
-- )
-- SELECT 
--     'LM' AS PERIOD_TYPE,
--     COUNT(DISTINCT CASE WHEN customer_activity.FIRST_PURCHASE BETWEEN (SELECT START_DATE FROM period_filters) AND (SELECT TODAY FROM period_filters) THEN customer_activity.CUSTOMER_ID END) AS NEW_CUSTOMERS,
--     COUNT(DISTINCT CASE WHEN customer_activity.LAST_PURCHASE BETWEEN (SELECT START_DATE FROM period_filters) AND (SELECT TODAY FROM period_filters) THEN customer_activity.CUSTOMER_ID END) AS CHURNED_CUSTOMERS,
--     SUM(CASE WHEN revenue_contraction.CURRENT_REVENUE < revenue_contraction.PREV_MONTHLY_REVENUE THEN revenue_contraction.PREV_MONTHLY_REVENUE - revenue_contraction.CURRENT_REVENUE ELSE 0 END) AS REVENUE_LOST,
--     SUM(MONTHLY_REVENUE) / NULLIF(SUM(PREV_MONTHLY_REVENUE), 0) AS NRR,
--     SUM(grr_calculation.MONTHLY_REVENUE) / NULLIF(SUM(grr_calculation.PREV_MONTHLY_REVENUE), 0) AS GRR,
--     (SELECT COUNT(DISTINCT CUSTOMER_ID) FROM JOB_PORTAL.MART.mart_job_portal WHERE PAYMENT_MONTH BETWEEN (SELECT START_DATE FROM period_filters) AND (SELECT TODAY FROM period_filters)) AS NEW_LOGOS,
--     (SELECT PRODUCT_ID FROM product_ranking WHERE PRODUCT_RANK = 1) AS TOP_PRODUCT,
--     (SELECT CUSTOMER_ID FROM customer_ranking WHERE CUSTOMER_RANK = 1) AS TOP_CUSTOMER
-- FROM customer_activity
-- JOIN revenue_changes USING (CUSTOMER_ID)
-- JOIN revenue_contraction USING (CUSTOMER_ID)
-- JOIN nrr_calculation USING (CUSTOMER_ID)
-- JOIN grr_calculation USING (CUSTOMER_ID)

WITH base_data AS (
    SELECT
        PRODUCT_ID,
        PAYMENT_MONTH,
        REVENUE,
        QUANTITY,
        CUSTOMER_COMPANY,
        CUSTOMER_NAME,
        PRODUCT_FAMILY,
        PRODUCT_SUB_FAMILY
    FROM JOB_PORTAL.MART.mart_job_portal  -- Reference to your source table
),

-- Get the last month available in the dataset
last_month AS (
    SELECT
        MAX(PAYMENT_MONTH) AS max_payment_month
    FROM base_data
),

-- Filter data for the last month
last_month_data AS (
    SELECT *
    FROM base_data
    WHERE PAYMENT_MONTH = (SELECT max_payment_month FROM last_month)
),

-- Calculate total revenue for the last month
monthly_revenue AS (
    SELECT
        PAYMENT_MONTH,
        SUM(REVENUE) AS total_revenue
    FROM last_month_data
    GROUP BY PAYMENT_MONTH
),

-- Identify new customers in the last month
new_customers AS (
    SELECT
        PAYMENT_MONTH,
        COUNT(DISTINCT CUSTOMER_NAME) AS new_customers
    FROM (
        SELECT
            CUSTOMER_NAME,
            PAYMENT_MONTH,
            ROW_NUMBER() OVER (PARTITION BY CUSTOMER_NAME ORDER BY PAYMENT_MONTH) AS rn
        FROM base_data
    ) AS ranked_customers
    WHERE rn = 1 AND PAYMENT_MONTH = (SELECT max_payment_month FROM last_month)
    GROUP BY PAYMENT_MONTH
),

-- Identify churned customers (assuming churn means no purchases in the last month)
churned_customers AS (
    SELECT
        b1.PAYMENT_MONTH,
        COUNT(DISTINCT b1.CUSTOMER_NAME) AS churned_customers
    FROM base_data b1
    LEFT JOIN base_data b2
        ON b1.CUSTOMER_NAME = b2.CUSTOMER_NAME
        AND b2.PAYMENT_MONTH > b1.PAYMENT_MONTH
    WHERE b1.PAYMENT_MONTH = (SELECT max_payment_month FROM last_month)
    AND b2.CUSTOMER_NAME IS NULL  -- No purchases in the following month
    GROUP BY b1.PAYMENT_MONTH
),

-- Calculate revenue lost due to contraction (assuming contraction means a decrease in revenue)
revenue_lost AS (
    SELECT
        b1.PAYMENT_MONTH,
        SUM(b1.REVENUE) - COALESCE(SUM(b2.REVENUE), 0) AS revenue_lost
    FROM base_data b1
    LEFT JOIN base_data b2
        ON b1.CUSTOMER_NAME = b2.CUSTOMER_NAME
        AND b2.PAYMENT_MONTH = DATEADD(month, 1, b1.PAYMENT_MONTH)  -- Compare with the next month
    WHERE b1.PAYMENT_MONTH = (SELECT max_payment_month FROM last_month)
    GROUP BY b1.PAYMENT_MONTH
),

-- Identify new logos (new customers in the last month)
new_logos AS (
    SELECT
        PAYMENT_MONTH,
        COUNT(DISTINCT CUSTOMER_NAME) AS new_logos
    FROM base_data
    WHERE PAYMENT_MONTH = (SELECT max_payment_month FROM last_month)
    GROUP BY PAYMENT_MONTH
),

-- Revenue by product
revenue_by_product AS (
    SELECT
        PRODUCT_ID,
        PAYMENT_MONTH,
        SUM(REVENUE) AS total_revenue
    FROM base_data
    WHERE PAYMENT_MONTH = (SELECT max_payment_month FROM last_month)
    GROUP BY PRODUCT_ID, PAYMENT_MONTH
),

-- Revenue by customer
revenue_by_customer AS (
    SELECT
        CUSTOMER_NAME,
        PAYMENT_MONTH,
        SUM(REVENUE) AS total_revenue
    FROM base_data
    WHERE PAYMENT_MONTH = (SELECT max_payment_month FROM last_month)
    GROUP BY CUSTOMER_NAME, PAYMENT_MONTH
)

-- Final output combining all metrics
SELECT
    lm.max_payment_month AS payment_month,
    COALESCE(m.total_revenue, 0) AS total_revenue,
    COALESCE(n.new_customers, 0) AS new_customers,
    COALESCE(c.churned_customers, 0) AS churned_customers,
    COALESCE(r.revenue_lost, 0) AS revenue_lost,
    COALESCE(l.new_logos, 0) AS new_logos,
    p.PRODUCT_ID,
    p.total_revenue AS product_revenue,
    c2.CUSTOMER_NAME,
    c2.total_revenue AS customer_revenue
FROM last_month lm
LEFT JOIN monthly_revenue m ON lm.max_payment_month = m.PAYMENT_MONTH
LEFT JOIN new_customers n ON lm.max_payment_month = n.PAYMENT_MONTH
LEFT JOIN churned_customers c ON lm.max_payment_month = c.PAYMENT_MONTH
LEFT JOIN revenue_lost r ON lm.max_payment_month = r.PAYMENT_MONTH
LEFT JOIN new_logos l ON lm.max_payment_month = l.PAYMENT_MONTH
LEFT JOIN revenue_by_product p ON lm.max_payment_month = p.PAYMENT_MONTH
LEFT JOIN revenue_by_customer c2 ON lm.max_payment_month = c2.PAYMENT_MONTH
ORDER BY lm.max_payment_month, p.PRODUCT_ID, c2.CUSTOMER_NAME;
[0m10:20:09.749928 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:20:11.888437 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01bafec2-0004-c0bd-0005-d1530001818a
[0m10:20:11.888437 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 217 at position 61 unexpected ';'.
[0m10:20:11.888437 [debug] [Thread-2 (]: Timing info for model.mini_project.lm_crb (execute): 10:20:09.617755 => 10:20:11.888437
[0m10:20:11.888437 [debug] [Thread-2 (]: On model.mini_project.lm_crb: Close
[0m10:20:12.578814 [debug] [Thread-2 (]: Database Error in model lm_crb (models\crb\lm_crb.sql)
  001003 (42000): SQL compilation error:
  syntax error line 217 at position 61 unexpected ';'.
  compiled Code at target\run\mini_project\models\crb\lm_crb.sql
[0m10:20:12.578814 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3fa0514-c9fb-461d-8331-6476ce3abe26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1C4AD2450>]}
[0m10:20:12.578814 [error] [Thread-2 (]: 8 of 8 ERROR creating sql table model JOB_PORTAL.RAW.lm_crb .................... [[31mERROR[0m in 3.11s]
[0m10:20:12.578814 [debug] [Thread-2 (]: Finished running node model.mini_project.lm_crb
[0m10:20:12.584839 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:20:12.584839 [debug] [MainThread]: Connection 'create_JOB_PORTAL_PREP' was properly closed.
[0m10:20:12.584839 [debug] [MainThread]: Connection 'create_JOB_PORTAL_MART' was properly closed.
[0m10:20:12.584839 [debug] [MainThread]: Connection 'list_JOB_PORTAL_PREP' was properly closed.
[0m10:20:12.584839 [debug] [MainThread]: Connection 'list_JOB_PORTAL_MART' was properly closed.
[0m10:20:12.584839 [debug] [MainThread]: Connection 'model.mini_project.mart_job_portal' was properly closed.
[0m10:20:12.584839 [debug] [MainThread]: Connection 'model.mini_project.lm_crb' was properly closed.
[0m10:20:12.584839 [info ] [MainThread]: 
[0m10:20:12.584839 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 30.55 seconds (30.55s).
[0m10:20:12.618434 [debug] [MainThread]: Command end result
[0m10:20:12.637069 [info ] [MainThread]: 
[0m10:20:12.639491 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:20:12.640500 [info ] [MainThread]: 
[0m10:20:12.641404 [error] [MainThread]:   Database Error in model lm_crb (models\crb\lm_crb.sql)
  001003 (42000): SQL compilation error:
  syntax error line 217 at position 61 unexpected ';'.
  compiled Code at target\run\mini_project\models\crb\lm_crb.sql
[0m10:20:12.643427 [info ] [MainThread]: 
[0m10:20:12.643427 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m10:20:12.646012 [debug] [MainThread]: Command `dbt run` failed at 10:20:12.646012 after 32.11 seconds
[0m10:20:12.646012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1C3C98E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1C4976630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1C3BFF110>]}
[0m10:20:12.647012 [debug] [MainThread]: Flushing usage events
[0m10:21:04.968702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022771E94D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022771BB9820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227718738F0>]}


============================== 10:21:04.968702 | 53fcf70d-b073-402e-be26-42aacb7fd3a3 ==============================
[0m10:21:04.968702 [info ] [MainThread]: Running with dbt=1.7.19
[0m10:21:04.968702 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\DasariUday\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\DasariUday\\venv\\.venv\\mini_project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:21:05.540945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53fcf70d-b073-402e-be26-42aacb7fd3a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022771E962D0>]}
[0m10:21:05.614013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53fcf70d-b073-402e-be26-42aacb7fd3a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022770D74EC0>]}
[0m10:21:05.616020 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m10:21:05.634081 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m10:21:05.752604 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:21:05.752604 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:21:05.758372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53fcf70d-b073-402e-be26-42aacb7fd3a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022773CA4260>]}
[0m10:21:05.868118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53fcf70d-b073-402e-be26-42aacb7fd3a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022773D1AE40>]}
[0m10:21:05.868118 [info ] [MainThread]: Found 8 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m10:21:05.870126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53fcf70d-b073-402e-be26-42aacb7fd3a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022772B06FF0>]}
[0m10:21:05.872132 [info ] [MainThread]: 
[0m10:21:05.874138 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:21:05.876146 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL'
[0m10:21:05.882094 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL'
[0m10:21:05.893545 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL"
[0m10:21:05.896863 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL"
[0m10:21:05.896863 [debug] [ThreadPool]: On list_JOB_PORTAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL"} */
show terse schemas in database JOB_PORTAL
    limit 10000
[0m10:21:05.897861 [debug] [ThreadPool]: On list_JOB_PORTAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL"} */
show terse schemas in database JOB_PORTAL
    limit 10000
[0m10:21:05.897861 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:21:05.898863 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:21:08.182620 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m10:21:08.186394 [debug] [ThreadPool]: On list_JOB_PORTAL: Close
[0m10:21:08.190424 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m10:21:08.194448 [debug] [ThreadPool]: On list_JOB_PORTAL: Close
[0m10:21:08.860325 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL"
[0m10:21:08.860325 [debug] [ThreadPool]: On list_JOB_PORTAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL"} */
show terse schemas in database JOB_PORTAL
    limit 10000
[0m10:21:08.862346 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:21:10.672108 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m10:21:10.674110 [debug] [ThreadPool]: On list_JOB_PORTAL: Close
[0m10:21:11.374928 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m10:21:11.374928 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m10:21:11.374928 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show terse objects in MINI_PROJECT.RAW limit 10000
[0m10:21:11.374928 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:21:11.374928 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL_RAW'
[0m10:21:11.390739 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_RAW"
[0m10:21:11.390739 [debug] [ThreadPool]: On list_JOB_PORTAL_RAW: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_RAW"} */
show terse objects in JOB_PORTAL.RAW limit 10000
[0m10:21:11.390739 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:21:13.170370 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m10:21:13.170370 [debug] [ThreadPool]: On list_JOB_PORTAL_RAW: Close
[0m10:21:13.170370 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m10:21:13.170370 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: Close
[0m10:21:13.813488 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_RAW, now list_JOB_PORTAL_MART)
[0m10:21:13.813488 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_MART"
[0m10:21:13.813488 [debug] [ThreadPool]: On list_JOB_PORTAL_MART: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_MART"} */
show terse objects in JOB_PORTAL.MART limit 10000
[0m10:21:13.813488 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:21:13.821531 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JOB_PORTAL_RAW, now list_JOB_PORTAL_PREP)
[0m10:21:13.825556 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_PREP"
[0m10:21:13.825556 [debug] [ThreadPool]: On list_JOB_PORTAL_PREP: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_PREP"} */
show terse objects in JOB_PORTAL.PREP limit 10000
[0m10:21:13.825556 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:21:15.610779 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m10:21:15.610779 [debug] [ThreadPool]: On list_JOB_PORTAL_PREP: Close
[0m10:21:15.721581 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 2.0 seconds
[0m10:21:15.721581 [debug] [ThreadPool]: On list_JOB_PORTAL_MART: Close
[0m10:21:16.370793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53fcf70d-b073-402e-be26-42aacb7fd3a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022773C6D2E0>]}
[0m10:21:16.370793 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m10:21:16.370793 [info ] [MainThread]: 
[0m10:21:16.403306 [debug] [Thread-1 (]: Began running node model.mini_project.raw_customers
[0m10:21:16.403306 [debug] [Thread-2 (]: Began running node model.mini_project.raw_products
[0m10:21:16.404315 [info ] [Thread-1 (]: 1 of 8 START sql table model JOB_PORTAL.RAW.raw_customers ...................... [RUN]
[0m10:21:16.406274 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project.raw_customers'
[0m10:21:16.405045 [info ] [Thread-2 (]: 2 of 8 START sql table model JOB_PORTAL.RAW.raw_products ....................... [RUN]
[0m10:21:16.407396 [debug] [Thread-1 (]: Began compiling node model.mini_project.raw_customers
[0m10:21:16.408359 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.mini_project.raw_products'
[0m10:21:16.408359 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.raw_customers"
[0m10:21:16.408359 [debug] [Thread-2 (]: Began compiling node model.mini_project.raw_products
[0m10:21:16.426302 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.raw_products"
[0m10:21:16.427304 [debug] [Thread-1 (]: Timing info for model.mini_project.raw_customers (compile): 10:21:16.408359 => 10:21:16.426302
[0m10:21:16.427304 [debug] [Thread-1 (]: Began executing node model.mini_project.raw_customers
[0m10:21:16.454826 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.raw_customers"
[0m10:21:16.454826 [debug] [Thread-2 (]: Timing info for model.mini_project.raw_products (compile): 10:21:16.408359 => 10:21:16.454826
[0m10:21:16.454826 [debug] [Thread-2 (]: Began executing node model.mini_project.raw_products
[0m10:21:16.461369 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.raw_products"
[0m10:21:16.463375 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.raw_customers"
[0m10:21:16.463375 [debug] [Thread-1 (]: On model.mini_project.raw_customers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.raw_customers"} */
create or replace transient table JOB_PORTAL.RAW.raw_customers
         as
        (
SELECT 
    * 
FROM 
    MINI_PROJECT.RAW.Customers 
    WHERE CUSTOMER_ID 
          IS NOT NULL
        );
[0m10:21:16.463375 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:21:16.463375 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.raw_products"
[0m10:21:16.463375 [debug] [Thread-2 (]: On model.mini_project.raw_products: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.raw_products"} */
create or replace transient table JOB_PORTAL.RAW.raw_products
         as
        (
SELECT 
     *
FROM 
     MINI_PROJECT.RAW.Products 
     WHERE PRODUCT_ID 
           IS NOT NULL
        );
[0m10:21:16.463375 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:21:18.782270 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m10:21:18.812869 [debug] [Thread-1 (]: Timing info for model.mini_project.raw_customers (execute): 10:21:16.428341 => 10:21:18.796807
[0m10:21:18.812869 [debug] [Thread-1 (]: On model.mini_project.raw_customers: Close
[0m10:21:18.812869 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m10:21:18.816687 [debug] [Thread-2 (]: Timing info for model.mini_project.raw_products (execute): 10:21:16.454826 => 10:21:18.816687
[0m10:21:18.816687 [debug] [Thread-2 (]: On model.mini_project.raw_products: Close
[0m10:21:19.461733 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53fcf70d-b073-402e-be26-42aacb7fd3a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022772C0B500>]}
[0m10:21:19.461733 [info ] [Thread-2 (]: 2 of 8 OK created sql table model JOB_PORTAL.RAW.raw_products .................. [[32mSUCCESS 1[0m in 3.05s]
[0m10:21:19.461733 [debug] [Thread-2 (]: Finished running node model.mini_project.raw_products
[0m10:21:19.461733 [debug] [Thread-2 (]: Began running node model.mini_project.raw_transaction
[0m10:21:19.461733 [info ] [Thread-2 (]: 3 of 8 START sql table model JOB_PORTAL.RAW.raw_transaction .................... [RUN]
[0m10:21:19.461733 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mini_project.raw_products, now model.mini_project.raw_transaction)
[0m10:21:19.461733 [debug] [Thread-2 (]: Began compiling node model.mini_project.raw_transaction
[0m10:21:19.461733 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.raw_transaction"
[0m10:21:19.461733 [debug] [Thread-2 (]: Timing info for model.mini_project.raw_transaction (compile): 10:21:19.461733 => 10:21:19.461733
[0m10:21:19.461733 [debug] [Thread-2 (]: Began executing node model.mini_project.raw_transaction
[0m10:21:19.461733 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.raw_transaction"
[0m10:21:19.477002 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.raw_transaction"
[0m10:21:19.478273 [debug] [Thread-2 (]: On model.mini_project.raw_transaction: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.raw_transaction"} */
create or replace transient table JOB_PORTAL.RAW.raw_transaction
         as
        (
SELECT 
     *
FROM 
    MINI_PROJECT.RAW.Transaction 
    WHERE CUSTOMER_ID 
          IS NOT NULL
        );
[0m10:21:19.479281 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:21:19.621447 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53fcf70d-b073-402e-be26-42aacb7fd3a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227740CBEC0>]}
[0m10:21:19.637278 [info ] [Thread-1 (]: 1 of 8 OK created sql table model JOB_PORTAL.RAW.raw_customers ................. [[32mSUCCESS 1[0m in 3.22s]
[0m10:21:19.637278 [debug] [Thread-1 (]: Finished running node model.mini_project.raw_customers
[0m10:21:19.637278 [debug] [Thread-1 (]: Began running node model.mini_project.prep_products
[0m10:21:19.637278 [info ] [Thread-1 (]: 4 of 8 START sql table model JOB_PORTAL.PREP.prep_products ..................... [RUN]
[0m10:21:19.637278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.raw_customers, now model.mini_project.prep_products)
[0m10:21:19.637278 [debug] [Thread-1 (]: Began compiling node model.mini_project.prep_products
[0m10:21:19.637278 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.prep_products"
[0m10:21:19.637278 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_products (compile): 10:21:19.637278 => 10:21:19.637278
[0m10:21:19.637278 [debug] [Thread-1 (]: Began executing node model.mini_project.prep_products
[0m10:21:19.637278 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.prep_products"
[0m10:21:19.637278 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.prep_products"
[0m10:21:19.637278 [debug] [Thread-1 (]: On model.mini_project.prep_products: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.prep_products"} */
create or replace transient table JOB_PORTAL.PREP.prep_products
         as
        (
SELECT 
    PRODUCT_ID::VARCHAR AS PRODUCT_ID,
    LOWER(TRIM(PRODUCT_FAMILY)) AS PRODUCT_FAMILY,
    LOWER(TRIM(PRODUCT_SUB_FAMILY)) AS PRODUCT_SUB_FAMILY
FROM JOB_PORTAL.RAW.raw_products
        );
[0m10:21:19.637278 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:21:21.937651 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m10:21:21.937651 [debug] [Thread-2 (]: Timing info for model.mini_project.raw_transaction (execute): 10:21:19.461733 => 10:21:21.937651
[0m10:21:21.937651 [debug] [Thread-2 (]: On model.mini_project.raw_transaction: Close
[0m10:21:22.127709 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m10:21:22.127709 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_products (execute): 10:21:19.637278 => 10:21:22.127709
[0m10:21:22.127709 [debug] [Thread-1 (]: On model.mini_project.prep_products: Close
[0m10:21:22.588401 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53fcf70d-b073-402e-be26-42aacb7fd3a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002277406C5C0>]}
[0m10:21:22.588401 [info ] [Thread-2 (]: 3 of 8 OK created sql table model JOB_PORTAL.RAW.raw_transaction ............... [[32mSUCCESS 1[0m in 3.13s]
[0m10:21:22.588401 [debug] [Thread-2 (]: Finished running node model.mini_project.raw_transaction
[0m10:21:22.588401 [debug] [Thread-2 (]: Began running node model.mini_project.prep_customers
[0m10:21:22.588401 [info ] [Thread-2 (]: 5 of 8 START sql table model JOB_PORTAL.PREP.prep_customers .................... [RUN]
[0m10:21:22.642315 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mini_project.raw_transaction, now model.mini_project.prep_customers)
[0m10:21:22.643348 [debug] [Thread-2 (]: Began compiling node model.mini_project.prep_customers
[0m10:21:22.646680 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.prep_customers"
[0m10:21:22.647647 [debug] [Thread-2 (]: Timing info for model.mini_project.prep_customers (compile): 10:21:22.643348 => 10:21:22.646680
[0m10:21:22.647647 [debug] [Thread-2 (]: Began executing node model.mini_project.prep_customers
[0m10:21:22.650677 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.prep_customers"
[0m10:21:22.651648 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.prep_customers"
[0m10:21:22.652678 [debug] [Thread-2 (]: On model.mini_project.prep_customers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.prep_customers"} */
create or replace transient table JOB_PORTAL.PREP.prep_customers
         as
        (
SELECT DISTINCT
    LOWER(TRIM(COMPANY)) AS COMPANY,
    CUSTOMER_ID::NUMBER AS CUSTOMER_ID,
    LOWER(
        REGEXP_REPLACE(
            TRIM(REGEXP_SUBSTR(CUSTOMERNAME, '^[^(]+')), 
            ',', 
            ''
        )
    ) AS CUSTOMERNAME,  --  name without commas
    
FROM JOB_PORTAL.RAW.raw_customers
        );
[0m10:21:22.652678 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:21:22.758785 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53fcf70d-b073-402e-be26-42aacb7fd3a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022772A1A5A0>]}
[0m10:21:22.758785 [info ] [Thread-1 (]: 4 of 8 OK created sql table model JOB_PORTAL.PREP.prep_products ................ [[32mSUCCESS 1[0m in 3.12s]
[0m10:21:22.758785 [debug] [Thread-1 (]: Finished running node model.mini_project.prep_products
[0m10:21:22.758785 [debug] [Thread-1 (]: Began running node model.mini_project.prep_transaction
[0m10:21:22.758785 [info ] [Thread-1 (]: 6 of 8 START sql table model JOB_PORTAL.PREP.prep_transaction .................. [RUN]
[0m10:21:22.758785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.prep_products, now model.mini_project.prep_transaction)
[0m10:21:22.772580 [debug] [Thread-1 (]: Began compiling node model.mini_project.prep_transaction
[0m10:21:22.775546 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.prep_transaction"
[0m10:21:22.776555 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_transaction (compile): 10:21:22.772580 => 10:21:22.776555
[0m10:21:22.777555 [debug] [Thread-1 (]: Began executing node model.mini_project.prep_transaction
[0m10:21:22.780584 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.prep_transaction"
[0m10:21:22.781551 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.prep_transaction"
[0m10:21:22.781551 [debug] [Thread-1 (]: On model.mini_project.prep_transaction: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.prep_transaction"} */
create or replace transient table JOB_PORTAL.PREP.prep_transaction
         as
        (
SELECT 
    CUSTOMER_ID::NUMBER AS CUSTOMER_ID,
    PRODUCT_ID::VARCHAR AS PRODUCT_ID,
    PAYMENT_MONTH::DATE AS PAYMENT_MONTH,
    REVENUE_TYPE::NUMBER AS REVENUE_TYPE,
    REVENUE::NUMBER(38,2) AS REVENUE,
    QUANTITY::NUMBER AS QUANTITY,
    LOWER(TRIM(COMPANIES)) AS COMPANIES
FROM JOB_PORTAL.RAW.raw_transaction
        );
[0m10:21:22.782584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:21:25.392264 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m10:21:25.392264 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_transaction (execute): 10:21:22.777555 => 10:21:25.392264
[0m10:21:25.392264 [debug] [Thread-1 (]: On model.mini_project.prep_transaction: Close
[0m10:21:25.392264 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m10:21:25.407995 [debug] [Thread-2 (]: Timing info for model.mini_project.prep_customers (execute): 10:21:22.647647 => 10:21:25.407995
[0m10:21:25.407995 [debug] [Thread-2 (]: On model.mini_project.prep_customers: Close
[0m10:21:26.021965 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53fcf70d-b073-402e-be26-42aacb7fd3a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022774085190>]}
[0m10:21:26.021965 [info ] [Thread-1 (]: 6 of 8 OK created sql table model JOB_PORTAL.PREP.prep_transaction ............. [[32mSUCCESS 1[0m in 3.26s]
[0m10:21:26.021965 [debug] [Thread-1 (]: Finished running node model.mini_project.prep_transaction
[0m10:21:26.038730 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53fcf70d-b073-402e-be26-42aacb7fd3a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227741B3740>]}
[0m10:21:26.038730 [info ] [Thread-2 (]: 5 of 8 OK created sql table model JOB_PORTAL.PREP.prep_customers ............... [[32mSUCCESS 1[0m in 3.40s]
[0m10:21:26.046151 [debug] [Thread-2 (]: Finished running node model.mini_project.prep_customers
[0m10:21:26.047160 [debug] [Thread-1 (]: Began running node model.mini_project.mart_job_portal
[0m10:21:26.048443 [info ] [Thread-1 (]: 7 of 8 START sql table model JOB_PORTAL.MART.mart_job_portal ................... [RUN]
[0m10:21:26.049141 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.prep_transaction, now model.mini_project.mart_job_portal)
[0m10:21:26.050228 [debug] [Thread-1 (]: Began compiling node model.mini_project.mart_job_portal
[0m10:21:26.054311 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.mart_job_portal"
[0m10:21:26.056318 [debug] [Thread-1 (]: Timing info for model.mini_project.mart_job_portal (compile): 10:21:26.050228 => 10:21:26.055355
[0m10:21:26.056318 [debug] [Thread-1 (]: Began executing node model.mini_project.mart_job_portal
[0m10:21:26.059350 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.mart_job_portal"
[0m10:21:26.059350 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.mart_job_portal"
[0m10:21:26.059350 [debug] [Thread-1 (]: On model.mini_project.mart_job_portal: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.mart_job_portal"} */
create or replace transient table JOB_PORTAL.MART.mart_job_portal
         as
        (SELECT DISTINCT
    ST.CUSTOMER_ID,
    ST.PRODUCT_ID,
    ST.PAYMENT_MONTH,
    ST.REVENUE,
    ST.QUANTITY,
    CUST.COMPANY AS CUSTOMER_COMPANY,
    CUST.CUSTOMERNAME AS CUSTOMER_NAME,
    PROD.PRODUCT_FAMILY,
    PROD.PRODUCT_SUB_FAMILY
FROM JOB_PORTAL.PREP.prep_transaction ST
LEFT JOIN JOB_PORTAL.PREP.prep_customers CUST ON ST.CUSTOMER_ID = CUST.CUSTOMER_ID
LEFT JOIN JOB_PORTAL.PREP.prep_products PROD ON ST.PRODUCT_ID = PROD.PRODUCT_ID
        );
[0m10:21:26.062680 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:21:29.223490 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m10:21:29.223490 [debug] [Thread-1 (]: Timing info for model.mini_project.mart_job_portal (execute): 10:21:26.056318 => 10:21:29.223490
[0m10:21:29.223490 [debug] [Thread-1 (]: On model.mini_project.mart_job_portal: Close
[0m10:21:29.861046 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53fcf70d-b073-402e-be26-42aacb7fd3a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227741BF260>]}
[0m10:21:29.861046 [info ] [Thread-1 (]: 7 of 8 OK created sql table model JOB_PORTAL.MART.mart_job_portal .............. [[32mSUCCESS 1[0m in 3.81s]
[0m10:21:29.861046 [debug] [Thread-1 (]: Finished running node model.mini_project.mart_job_portal
[0m10:21:29.861046 [debug] [Thread-2 (]: Began running node model.mini_project.lm_crb
[0m10:21:29.861046 [info ] [Thread-2 (]: 8 of 8 START sql table model JOB_PORTAL.RAW.lm_crb ............................. [RUN]
[0m10:21:29.861046 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mini_project.prep_customers, now model.mini_project.lm_crb)
[0m10:21:29.861046 [debug] [Thread-2 (]: Began compiling node model.mini_project.lm_crb
[0m10:21:29.877083 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.lm_crb"
[0m10:21:29.879282 [debug] [Thread-2 (]: Timing info for model.mini_project.lm_crb (compile): 10:21:29.861046 => 10:21:29.879282
[0m10:21:29.880766 [debug] [Thread-2 (]: Began executing node model.mini_project.lm_crb
[0m10:21:29.884934 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.lm_crb"
[0m10:21:29.890886 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.lm_crb"
[0m10:21:29.890886 [debug] [Thread-2 (]: On model.mini_project.lm_crb: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.lm_crb"} */
create or replace transient table JOB_PORTAL.RAW.lm_crb
         as
        (-- -- CRB Layer: KPIs for Last Month (LM)

-- WITH period_filters AS (
--     SELECT 
--         (SELECT MAX(PAYMENT_MONTH) - INTERVAL '1 MONTH' FROM JOB_PORTAL.MART.mart_job_portal) AS START_DATE,
--         (SELECT MAX(PAYMENT_MONTH) FROM JOB_PORTAL.MART.mart_job_portal) AS TODAY
-- )
-- ,
-- customer_activity AS (
--     SELECT 
--         CUSTOMER_ID, 
--         MIN(PAYMENT_MONTH) AS FIRST_PURCHASE, 
--         MAX(PAYMENT_MONTH) AS LAST_PURCHASE
--     FROM JOB_PORTAL.MART.mart_job_portal
--     GROUP BY CUSTOMER_ID
-- ),
-- revenue_changes AS (
--     SELECT 
--         CUSTOMER_ID, 
--         PAYMENT_MONTH, 
--         SUM(REVENUE) AS MONTHLY_REVENUE
--     FROM JOB_PORTAL.MART.mart_job_portal
--     WHERE PAYMENT_MONTH BETWEEN (SELECT START_DATE FROM period_filters) AND (SELECT TODAY FROM period_filters)
--     GROUP BY CUSTOMER_ID, PAYMENT_MONTH
-- ),
-- nrr_calculation AS (
--     SELECT 
--         CUSTOMER_ID, 
--         PAYMENT_MONTH,
--         MONTHLY_REVENUE,
--         LAG(MONTHLY_REVENUE) OVER (PARTITION BY CUSTOMER_ID ORDER BY PAYMENT_MONTH) AS PREV_MONTHLY_REVENUE
--     FROM revenue_changes
-- ),
-- revenue_contraction AS (
--     SELECT 
--         CUSTOMER_ID, 
--         PAYMENT_MONTH, 
--         MONTHLY_REVENUE AS CURRENT_REVENUE,
--         PREV_MONTHLY_REVENUE
--     FROM nrr_calculation
-- ),
-- product_ranking AS (
--     SELECT 
--         PRODUCT_ID,
--         SUM(REVENUE) AS TOTAL_REVENUE,
--         RANK() OVER (ORDER BY SUM(REVENUE) DESC) AS PRODUCT_RANK
--     FROM JOB_PORTAL.MART.mart_job_portal
--     WHERE PAYMENT_MONTH BETWEEN (SELECT START_DATE FROM period_filters) AND (SELECT TODAY FROM period_filters)
--     GROUP BY PRODUCT_ID
-- ),
-- customer_ranking AS (
--     SELECT 
--         CUSTOMER_ID,
--         SUM(REVENUE) AS TOTAL_REVENUE,
--         RANK() OVER (ORDER BY SUM(REVENUE) DESC) AS CUSTOMER_RANK
--     FROM JOB_PORTAL.MART.mart_job_portal
--     WHERE PAYMENT_MONTH BETWEEN (SELECT START_DATE FROM period_filters) AND (SELECT TODAY FROM period_filters)
--     GROUP BY CUSTOMER_ID
-- ),
-- grr_calculation AS (
--     SELECT 
--         CUSTOMER_ID,
--         PAYMENT_MONTH,
--         MONTHLY_REVENUE,
--         LAG(MONTHLY_REVENUE) OVER (PARTITION BY CUSTOMER_ID ORDER BY PAYMENT_MONTH) AS PREV_MONTHLY_REVENUE
--     FROM revenue_changes
-- )
-- SELECT 
--     'LM' AS PERIOD_TYPE,
--     COUNT(DISTINCT CASE WHEN customer_activity.FIRST_PURCHASE BETWEEN (SELECT START_DATE FROM period_filters) AND (SELECT TODAY FROM period_filters) THEN customer_activity.CUSTOMER_ID END) AS NEW_CUSTOMERS,
--     COUNT(DISTINCT CASE WHEN customer_activity.LAST_PURCHASE BETWEEN (SELECT START_DATE FROM period_filters) AND (SELECT TODAY FROM period_filters) THEN customer_activity.CUSTOMER_ID END) AS CHURNED_CUSTOMERS,
--     SUM(CASE WHEN revenue_contraction.CURRENT_REVENUE < revenue_contraction.PREV_MONTHLY_REVENUE THEN revenue_contraction.PREV_MONTHLY_REVENUE - revenue_contraction.CURRENT_REVENUE ELSE 0 END) AS REVENUE_LOST,
--     SUM(MONTHLY_REVENUE) / NULLIF(SUM(PREV_MONTHLY_REVENUE), 0) AS NRR,
--     SUM(grr_calculation.MONTHLY_REVENUE) / NULLIF(SUM(grr_calculation.PREV_MONTHLY_REVENUE), 0) AS GRR,
--     (SELECT COUNT(DISTINCT CUSTOMER_ID) FROM JOB_PORTAL.MART.mart_job_portal WHERE PAYMENT_MONTH BETWEEN (SELECT START_DATE FROM period_filters) AND (SELECT TODAY FROM period_filters)) AS NEW_LOGOS,
--     (SELECT PRODUCT_ID FROM product_ranking WHERE PRODUCT_RANK = 1) AS TOP_PRODUCT,
--     (SELECT CUSTOMER_ID FROM customer_ranking WHERE CUSTOMER_RANK = 1) AS TOP_CUSTOMER
-- FROM customer_activity
-- JOIN revenue_changes USING (CUSTOMER_ID)
-- JOIN revenue_contraction USING (CUSTOMER_ID)
-- JOIN nrr_calculation USING (CUSTOMER_ID)
-- JOIN grr_calculation USING (CUSTOMER_ID)

WITH base_data AS (
    SELECT
        PRODUCT_ID,
        PAYMENT_MONTH,
        REVENUE,
        QUANTITY,
        CUSTOMER_COMPANY,
        CUSTOMER_NAME,
        PRODUCT_FAMILY,
        PRODUCT_SUB_FAMILY
    FROM JOB_PORTAL.MART.mart_job_portal  -- Reference to your source table
),

-- Get the last month available in the dataset
last_month AS (
    SELECT
        MAX(PAYMENT_MONTH) AS max_payment_month
    FROM base_data
),

-- Filter data for the last month
last_month_data AS (
    SELECT *
    FROM base_data
    WHERE PAYMENT_MONTH = (SELECT max_payment_month FROM last_month)
),

-- Calculate total revenue for the last month
monthly_revenue AS (
    SELECT
        PAYMENT_MONTH,
        SUM(REVENUE) AS total_revenue
    FROM last_month_data
    GROUP BY PAYMENT_MONTH
),

-- Identify new customers in the last month
new_customers AS (
    SELECT
        PAYMENT_MONTH,
        COUNT(DISTINCT CUSTOMER_NAME) AS new_customers
    FROM (
        SELECT
            CUSTOMER_NAME,
            PAYMENT_MONTH,
            ROW_NUMBER() OVER (PARTITION BY CUSTOMER_NAME ORDER BY PAYMENT_MONTH) AS rn
        FROM base_data
    ) AS ranked_customers
    WHERE rn = 1 AND PAYMENT_MONTH = (SELECT max_payment_month FROM last_month)
    GROUP BY PAYMENT_MONTH
),

-- Identify churned customers (assuming churn means no purchases in the last month)
churned_customers AS (
    SELECT
        b1.PAYMENT_MONTH,
        COUNT(DISTINCT b1.CUSTOMER_NAME) AS churned_customers
    FROM base_data b1
    LEFT JOIN base_data b2
        ON b1.CUSTOMER_NAME = b2.CUSTOMER_NAME
        AND b2.PAYMENT_MONTH > b1.PAYMENT_MONTH
    WHERE b1.PAYMENT_MONTH = (SELECT max_payment_month FROM last_month)
    AND b2.CUSTOMER_NAME IS NULL  -- No purchases in the following month
    GROUP BY b1.PAYMENT_MONTH
),

-- Calculate revenue lost due to contraction (assuming contraction means a decrease in revenue)
revenue_lost AS (
    SELECT
        b1.PAYMENT_MONTH,
        SUM(b1.REVENUE) - COALESCE(SUM(b2.REVENUE), 0) AS revenue_lost
    FROM base_data b1
    LEFT JOIN base_data b2
        ON b1.CUSTOMER_NAME = b2.CUSTOMER_NAME
        AND b2.PAYMENT_MONTH = DATEADD(month, 1, b1.PAYMENT_MONTH)  -- Compare with the next month
    WHERE b1.PAYMENT_MONTH = (SELECT max_payment_month FROM last_month)
    GROUP BY b1.PAYMENT_MONTH
),

-- Identify new logos (new customers in the last month)
new_logos AS (
    SELECT
        PAYMENT_MONTH,
        COUNT(DISTINCT CUSTOMER_NAME) AS new_logos
    FROM base_data
    WHERE PAYMENT_MONTH = (SELECT max_payment_month FROM last_month)
    GROUP BY PAYMENT_MONTH
),

-- Revenue by product
revenue_by_product AS (
    SELECT
        PRODUCT_ID,
        PAYMENT_MONTH,
        SUM(REVENUE) AS total_revenue
    FROM base_data
    WHERE PAYMENT_MONTH = (SELECT max_payment_month FROM last_month)
    GROUP BY PRODUCT_ID, PAYMENT_MONTH
),

-- Revenue by customer
revenue_by_customer AS (
    SELECT
        CUSTOMER_NAME,
        PAYMENT_MONTH,
        SUM(REVENUE) AS total_revenue
    FROM base_data
    WHERE PAYMENT_MONTH = (SELECT max_payment_month FROM last_month)
    GROUP BY CUSTOMER_NAME, PAYMENT_MONTH
)

-- Final output combining all metrics
SELECT
    lm.max_payment_month AS payment_month,
    COALESCE(m.total_revenue, 0) AS total_revenue,
    COALESCE(n.new_customers, 0) AS new_customers,
    COALESCE(c.churned_customers, 0) AS churned_customers,
    COALESCE(r.revenue_lost, 0) AS revenue_lost,
    COALESCE(l.new_logos, 0) AS new_logos,
    p.PRODUCT_ID,
    p.total_revenue AS product_revenue,
    c2.CUSTOMER_NAME,
    c2.total_revenue AS customer_revenue
FROM last_month lm
LEFT JOIN monthly_revenue m ON lm.max_payment_month = m.PAYMENT_MONTH
LEFT JOIN new_customers n ON lm.max_payment_month = n.PAYMENT_MONTH
LEFT JOIN churned_customers c ON lm.max_payment_month = c.PAYMENT_MONTH
LEFT JOIN revenue_lost r ON lm.max_payment_month = r.PAYMENT_MONTH
LEFT JOIN new_logos l ON lm.max_payment_month = l.PAYMENT_MONTH
LEFT JOIN revenue_by_product p ON lm.max_payment_month = p.PAYMENT_MONTH
LEFT JOIN revenue_by_customer c2 ON lm.max_payment_month = c2.PAYMENT_MONTH
ORDER BY lm.max_payment_month, p.PRODUCT_ID, c2.CUSTOMER_NAME
        );
[0m10:21:29.890886 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:21:33.096398 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m10:21:33.096398 [debug] [Thread-2 (]: Timing info for model.mini_project.lm_crb (execute): 10:21:29.880766 => 10:21:33.096398
[0m10:21:33.096398 [debug] [Thread-2 (]: On model.mini_project.lm_crb: Close
[0m10:21:33.740686 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53fcf70d-b073-402e-be26-42aacb7fd3a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227741B81A0>]}
[0m10:21:33.740686 [info ] [Thread-2 (]: 8 of 8 OK created sql table model JOB_PORTAL.RAW.lm_crb ........................ [[32mSUCCESS 1[0m in 3.88s]
[0m10:21:33.740686 [debug] [Thread-2 (]: Finished running node model.mini_project.lm_crb
[0m10:21:33.740686 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:21:33.740686 [debug] [MainThread]: Connection 'list_JOB_PORTAL' was properly closed.
[0m10:21:33.740686 [debug] [MainThread]: Connection 'list_JOB_PORTAL' was properly closed.
[0m10:21:33.740686 [debug] [MainThread]: Connection 'list_JOB_PORTAL_MART' was properly closed.
[0m10:21:33.740686 [debug] [MainThread]: Connection 'list_JOB_PORTAL_PREP' was properly closed.
[0m10:21:33.740686 [debug] [MainThread]: Connection 'model.mini_project.mart_job_portal' was properly closed.
[0m10:21:33.740686 [debug] [MainThread]: Connection 'model.mini_project.lm_crb' was properly closed.
[0m10:21:33.740686 [info ] [MainThread]: 
[0m10:21:33.740686 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 27.87 seconds (27.87s).
[0m10:21:33.753159 [debug] [MainThread]: Command end result
[0m10:21:33.765297 [info ] [MainThread]: 
[0m10:21:33.766298 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:21:33.766298 [info ] [MainThread]: 
[0m10:21:33.767332 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m10:21:33.768296 [debug] [MainThread]: Command `dbt run` succeeded at 10:21:33.768296 after 29.07 seconds
[0m10:21:33.768296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022771BB9820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022772B73AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227714F2FF0>]}
[0m10:21:33.769297 [debug] [MainThread]: Flushing usage events
[0m10:21:39.324714 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m10:23:32.741100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291793C5280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291793C4920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291793C5E80>]}


============================== 10:23:32.741100 | 99a7f514-2371-4ad7-894a-bae764a9b995 ==============================
[0m10:23:32.741100 [info ] [MainThread]: Running with dbt=1.7.19
[0m10:23:32.741100 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\DasariUday\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\DasariUday\\venv\\.venv\\mini_project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m tag:PREP', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:23:33.226419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99a7f514-2371-4ad7-894a-bae764a9b995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002917941DD90>]}
[0m10:23:33.291749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99a7f514-2371-4ad7-894a-bae764a9b995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029179D4F3B0>]}
[0m10:23:33.293755 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m10:23:33.301781 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m10:23:33.391390 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:23:33.391390 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:23:33.391390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99a7f514-2371-4ad7-894a-bae764a9b995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002917A0D3AA0>]}
[0m10:23:33.405160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99a7f514-2371-4ad7-894a-bae764a9b995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002917B22BB60>]}
[0m10:23:33.405160 [info ] [MainThread]: Found 8 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m10:23:33.411899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99a7f514-2371-4ad7-894a-bae764a9b995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002917941DF10>]}
[0m10:23:33.411899 [info ] [MainThread]: 
[0m10:23:33.411899 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:23:33.411899 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL'
[0m10:23:33.429281 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL"
[0m10:23:33.430282 [debug] [ThreadPool]: On list_JOB_PORTAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL"} */
show terse schemas in database JOB_PORTAL
    limit 10000
[0m10:23:33.430282 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:23:35.714762 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m10:23:35.714762 [debug] [ThreadPool]: On list_JOB_PORTAL: Close
[0m10:23:36.350417 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m10:23:36.350417 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m10:23:36.350417 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show terse objects in MINI_PROJECT.RAW limit 10000
[0m10:23:36.350417 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:23:36.366187 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL_PREP'
[0m10:23:36.368195 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_PREP"
[0m10:23:36.368195 [debug] [ThreadPool]: On list_JOB_PORTAL_PREP: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_PREP"} */
show terse objects in JOB_PORTAL.PREP limit 10000
[0m10:23:36.368195 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:23:38.188503 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m10:23:38.188503 [debug] [ThreadPool]: On list_JOB_PORTAL_PREP: Close
[0m10:23:38.204320 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m10:23:38.206329 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: Close
[0m10:23:38.843537 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JOB_PORTAL_PREP, now list_JOB_PORTAL_RAW)
[0m10:23:38.843537 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_RAW, now list_JOB_PORTAL_MART)
[0m10:23:38.843537 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_RAW"
[0m10:23:38.859537 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_MART"
[0m10:23:38.859537 [debug] [ThreadPool]: On list_JOB_PORTAL_RAW: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_RAW"} */
show terse objects in JOB_PORTAL.RAW limit 10000
[0m10:23:38.859537 [debug] [ThreadPool]: On list_JOB_PORTAL_MART: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_MART"} */
show terse objects in JOB_PORTAL.MART limit 10000
[0m10:23:38.859537 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:23:38.859537 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:23:40.586531 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.0 seconds
[0m10:23:40.586531 [debug] [ThreadPool]: On list_JOB_PORTAL_RAW: Close
[0m10:23:40.625027 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 2.0 seconds
[0m10:23:40.625027 [debug] [ThreadPool]: On list_JOB_PORTAL_MART: Close
[0m10:23:41.290361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99a7f514-2371-4ad7-894a-bae764a9b995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291793C6F90>]}
[0m10:23:41.290361 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m10:23:41.295385 [info ] [MainThread]: 
[0m10:23:41.300362 [debug] [Thread-1 (]: Began running node model.mini_project.prep_customers
[0m10:23:41.300362 [debug] [Thread-2 (]: Began running node model.mini_project.prep_products
[0m10:23:41.300362 [info ] [Thread-1 (]: 1 of 3 START sql table model JOB_PORTAL.PREP.prep_customers .................... [RUN]
[0m10:23:41.302990 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project.prep_customers'
[0m10:23:41.300362 [info ] [Thread-2 (]: 2 of 3 START sql table model JOB_PORTAL.PREP.prep_products ..................... [RUN]
[0m10:23:41.303906 [debug] [Thread-1 (]: Began compiling node model.mini_project.prep_customers
[0m10:23:41.305279 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.mini_project.prep_products'
[0m10:23:41.314074 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.prep_customers"
[0m10:23:41.315765 [debug] [Thread-2 (]: Began compiling node model.mini_project.prep_products
[0m10:23:41.319941 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.prep_products"
[0m10:23:41.320943 [debug] [Thread-2 (]: Timing info for model.mini_project.prep_products (compile): 10:23:41.315765 => 10:23:41.320943
[0m10:23:41.321943 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_customers (compile): 10:23:41.305662 => 10:23:41.320943
[0m10:23:41.321943 [debug] [Thread-2 (]: Began executing node model.mini_project.prep_products
[0m10:23:41.321943 [debug] [Thread-1 (]: Began executing node model.mini_project.prep_customers
[0m10:23:41.362589 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.prep_customers"
[0m10:23:41.370122 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.prep_products"
[0m10:23:41.372125 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.prep_customers"
[0m10:23:41.372125 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.prep_products"
[0m10:23:41.373124 [debug] [Thread-1 (]: On model.mini_project.prep_customers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.prep_customers"} */
create or replace transient table JOB_PORTAL.PREP.prep_customers
         as
        (
SELECT DISTINCT
    LOWER(TRIM(COMPANY)) AS COMPANY,
    CUSTOMER_ID::NUMBER AS CUSTOMER_ID,
    LOWER(
        REGEXP_REPLACE(
            TRIM(REGEXP_SUBSTR(CUSTOMERNAME, '^[^(]+')), 
            ',', 
            ''
        )
    ) AS CUSTOMERNAME,  --  name without commas
    
FROM JOB_PORTAL.RAW.raw_customers
        );
[0m10:23:41.373124 [debug] [Thread-2 (]: On model.mini_project.prep_products: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.prep_products"} */
create or replace transient table JOB_PORTAL.PREP.prep_products
         as
        (
SELECT 
    PRODUCT_ID::VARCHAR AS PRODUCT_ID,
    LOWER(TRIM(PRODUCT_FAMILY)) AS PRODUCT_FAMILY,
    LOWER(TRIM(PRODUCT_SUB_FAMILY)) AS PRODUCT_SUB_FAMILY
FROM JOB_PORTAL.RAW.raw_products
        );
[0m10:23:41.374123 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:23:41.374123 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:23:43.711086 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m10:23:43.734890 [debug] [Thread-2 (]: Timing info for model.mini_project.prep_products (execute): 10:23:41.321943 => 10:23:43.732885
[0m10:23:43.734890 [debug] [Thread-2 (]: On model.mini_project.prep_products: Close
[0m10:23:43.867638 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m10:23:43.899449 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_customers (execute): 10:23:41.348817 => 10:23:43.899449
[0m10:23:43.899449 [debug] [Thread-1 (]: On model.mini_project.prep_customers: Close
[0m10:23:44.370524 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99a7f514-2371-4ad7-894a-bae764a9b995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002917B5A7FB0>]}
[0m10:23:44.370524 [info ] [Thread-2 (]: 2 of 3 OK created sql table model JOB_PORTAL.PREP.prep_products ................ [[32mSUCCESS 1[0m in 3.07s]
[0m10:23:44.370524 [debug] [Thread-2 (]: Finished running node model.mini_project.prep_products
[0m10:23:44.370524 [debug] [Thread-2 (]: Began running node model.mini_project.prep_transaction
[0m10:23:44.370524 [info ] [Thread-2 (]: 3 of 3 START sql table model JOB_PORTAL.PREP.prep_transaction .................. [RUN]
[0m10:23:44.370524 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mini_project.prep_products, now model.mini_project.prep_transaction)
[0m10:23:44.370524 [debug] [Thread-2 (]: Began compiling node model.mini_project.prep_transaction
[0m10:23:44.383120 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.prep_transaction"
[0m10:23:44.405848 [debug] [Thread-2 (]: Timing info for model.mini_project.prep_transaction (compile): 10:23:44.370524 => 10:23:44.404846
[0m10:23:44.405848 [debug] [Thread-2 (]: Began executing node model.mini_project.prep_transaction
[0m10:23:44.407849 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.prep_transaction"
[0m10:23:44.407849 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.prep_transaction"
[0m10:23:44.407849 [debug] [Thread-2 (]: On model.mini_project.prep_transaction: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.prep_transaction"} */
create or replace transient table JOB_PORTAL.PREP.prep_transaction
         as
        (
SELECT DISTINCT
    CUSTOMER_ID::NUMBER AS CUSTOMER_ID,
    PRODUCT_ID::VARCHAR AS PRODUCT_ID,
    PAYMENT_MONTH::DATE AS PAYMENT_MONTH,
    REVENUE_TYPE::NUMBER AS REVENUE_TYPE,
    REVENUE::NUMBER(38,2) AS REVENUE,
    QUANTITY::NUMBER AS QUANTITY,
    LOWER(TRIM(COMPANIES)) AS COMPANIES
FROM JOB_PORTAL.RAW.raw_transaction
        );
[0m10:23:44.407849 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:23:44.560726 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99a7f514-2371-4ad7-894a-bae764a9b995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002917B681190>]}
[0m10:23:44.562731 [info ] [Thread-1 (]: 1 of 3 OK created sql table model JOB_PORTAL.PREP.prep_customers ............... [[32mSUCCESS 1[0m in 3.26s]
[0m10:23:44.562731 [debug] [Thread-1 (]: Finished running node model.mini_project.prep_customers
[0m10:23:47.031076 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m10:23:47.033080 [debug] [Thread-2 (]: Timing info for model.mini_project.prep_transaction (execute): 10:23:44.406848 => 10:23:47.033080
[0m10:23:47.033080 [debug] [Thread-2 (]: On model.mini_project.prep_transaction: Close
[0m10:23:47.683566 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99a7f514-2371-4ad7-894a-bae764a9b995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002917B570F20>]}
[0m10:23:47.683566 [info ] [Thread-2 (]: 3 of 3 OK created sql table model JOB_PORTAL.PREP.prep_transaction ............. [[32mSUCCESS 1[0m in 3.31s]
[0m10:23:47.684566 [debug] [Thread-2 (]: Finished running node model.mini_project.prep_transaction
[0m10:23:47.687169 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:23:47.687636 [debug] [MainThread]: Connection 'list_JOB_PORTAL' was properly closed.
[0m10:23:47.687636 [debug] [MainThread]: Connection 'list_JOB_PORTAL_MART' was properly closed.
[0m10:23:47.688237 [debug] [MainThread]: Connection 'list_JOB_PORTAL_RAW' was properly closed.
[0m10:23:47.688237 [debug] [MainThread]: Connection 'model.mini_project.prep_customers' was properly closed.
[0m10:23:47.688237 [debug] [MainThread]: Connection 'model.mini_project.prep_transaction' was properly closed.
[0m10:23:47.689373 [info ] [MainThread]: 
[0m10:23:47.689759 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 14.28 seconds (14.28s).
[0m10:23:47.691879 [debug] [MainThread]: Command end result
[0m10:23:47.702510 [info ] [MainThread]: 
[0m10:23:47.703512 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:23:47.704512 [info ] [MainThread]: 
[0m10:23:47.706336 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m10:23:47.707396 [debug] [MainThread]: Command `dbt run` succeeded at 10:23:47.707396 after 15.12 seconds
[0m10:23:47.708400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002917919C620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291796D6660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029179FBBE00>]}
[0m10:23:47.708400 [debug] [MainThread]: Flushing usage events
[0m10:27:31.048065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029FBA9C4EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029FBA9C55E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029FBA9C4DA0>]}


============================== 10:27:31.054386 | cebe9c67-2abe-442e-b453-be6b625c6745 ==============================
[0m10:27:31.054386 [info ] [MainThread]: Running with dbt=1.7.19
[0m10:27:31.054386 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\DasariUday\\.dbt', 'log_path': 'C:\\Users\\DasariUday\\venv\\.venv\\mini_project\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m tag:PREP', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:27:31.531165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cebe9c67-2abe-442e-b453-be6b625c6745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029FBB6925D0>]}
[0m10:27:31.588592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cebe9c67-2abe-442e-b453-be6b625c6745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029FBA5F8170>]}
[0m10:27:31.588592 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m10:27:31.588592 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m10:27:31.693209 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:27:31.694497 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:27:31.699497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cebe9c67-2abe-442e-b453-be6b625c6745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029FBACF1BB0>]}
[0m10:27:31.712674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cebe9c67-2abe-442e-b453-be6b625c6745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029FBC86BE90>]}
[0m10:27:31.712674 [info ] [MainThread]: Found 8 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m10:27:31.713674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cebe9c67-2abe-442e-b453-be6b625c6745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029FBA651EB0>]}
[0m10:27:31.715670 [info ] [MainThread]: 
[0m10:27:31.716638 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:27:31.718665 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL'
[0m10:27:31.735007 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL"
[0m10:27:31.735007 [debug] [ThreadPool]: On list_JOB_PORTAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL"} */
show terse schemas in database JOB_PORTAL
    limit 10000
[0m10:27:31.736004 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:27:33.861383 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m10:27:33.877142 [debug] [ThreadPool]: On list_JOB_PORTAL: Close
[0m10:27:34.521365 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL_RAW'
[0m10:27:34.521365 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_RAW"
[0m10:27:34.521365 [debug] [ThreadPool]: On list_JOB_PORTAL_RAW: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_RAW"} */
show terse objects in JOB_PORTAL.RAW limit 10000
[0m10:27:34.521365 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:27:34.521365 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m10:27:34.537085 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m10:27:34.537085 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show terse objects in MINI_PROJECT.RAW limit 10000
[0m10:27:34.537085 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:27:36.376012 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.0 seconds
[0m10:27:36.376012 [debug] [ThreadPool]: On list_JOB_PORTAL_RAW: Close
[0m10:27:36.962217 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m10:27:36.972897 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: Close
[0m10:27:37.031280 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JOB_PORTAL_RAW, now list_JOB_PORTAL_PREP)
[0m10:27:37.031280 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_PREP"
[0m10:27:37.031280 [debug] [ThreadPool]: On list_JOB_PORTAL_PREP: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_PREP"} */
show terse objects in JOB_PORTAL.PREP limit 10000
[0m10:27:37.031280 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:27:37.612719 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_RAW, now list_JOB_PORTAL_MART)
[0m10:27:37.628539 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_MART"
[0m10:27:37.628539 [debug] [ThreadPool]: On list_JOB_PORTAL_MART: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_MART"} */
show terse objects in JOB_PORTAL.MART limit 10000
[0m10:27:37.628539 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:27:38.837436 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m10:27:38.837436 [debug] [ThreadPool]: On list_JOB_PORTAL_PREP: Close
[0m10:27:39.434195 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 2.0 seconds
[0m10:27:39.434195 [debug] [ThreadPool]: On list_JOB_PORTAL_MART: Close
[0m10:27:40.086014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cebe9c67-2abe-442e-b453-be6b625c6745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029FBCA17FE0>]}
[0m10:27:40.086014 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m10:27:40.086014 [info ] [MainThread]: 
[0m10:27:40.096011 [debug] [Thread-1 (]: Began running node model.mini_project.prep_customers
[0m10:27:40.096011 [debug] [Thread-2 (]: Began running node model.mini_project.prep_products
[0m10:27:40.096011 [info ] [Thread-1 (]: 1 of 3 START sql table model JOB_PORTAL.PREP.prep_customers .................... [RUN]
[0m10:27:40.096011 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project.prep_customers'
[0m10:27:40.096011 [debug] [Thread-1 (]: Began compiling node model.mini_project.prep_customers
[0m10:27:40.112784 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.prep_customers"
[0m10:27:40.096011 [info ] [Thread-2 (]: 2 of 3 START sql table model JOB_PORTAL.PREP.prep_products ..................... [RUN]
[0m10:27:40.114375 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.mini_project.prep_products'
[0m10:27:40.115377 [debug] [Thread-2 (]: Began compiling node model.mini_project.prep_products
[0m10:27:40.118680 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.prep_products"
[0m10:27:40.120627 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_customers (compile): 10:27:40.096011 => 10:27:40.120627
[0m10:27:40.121830 [debug] [Thread-1 (]: Began executing node model.mini_project.prep_customers
[0m10:27:40.137367 [debug] [Thread-2 (]: Timing info for model.mini_project.prep_products (compile): 10:27:40.115377 => 10:27:40.136366
[0m10:27:40.154743 [debug] [Thread-2 (]: Began executing node model.mini_project.prep_products
[0m10:27:40.154743 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.prep_customers"
[0m10:27:40.154743 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.prep_products"
[0m10:27:40.154743 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.prep_customers"
[0m10:27:40.154743 [debug] [Thread-1 (]: On model.mini_project.prep_customers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.prep_customers"} */
create or replace transient table JOB_PORTAL.PREP.prep_customers
         as
        (
SELECT DISTINCT
    LOWER(TRIM(COMPANY)) AS COMPANY,
    CUSTOMER_ID::NUMBER AS CUSTOMER_ID,
    LOWER(
        REGEXP_REPLACE(
            TRIM(REGEXP_SUBSTR(CUSTOMERNAME, '^[^(]+')), 
            ',', 
            ''
        )
    ) AS CUSTOMERNAME,  --  name without commas
    
FROM JOB_PORTAL.RAW.raw_customers
        );
[0m10:27:40.154743 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:27:40.154743 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.prep_products"
[0m10:27:40.154743 [debug] [Thread-2 (]: On model.mini_project.prep_products: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.prep_products"} */
create or replace transient table JOB_PORTAL.PREP.prep_products
         as
        (
SELECT 
    PRODUCT_ID::VARCHAR AS PRODUCT_ID,
    LOWER(TRIM(PRODUCT_FAMILY)) AS PRODUCT_FAMILY,
    LOWER(TRIM(PRODUCT_SUB_FAMILY)) AS PRODUCT_SUB_FAMILY
FROM JOB_PORTAL.RAW.raw_products
        );
[0m10:27:40.154743 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:27:42.581681 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m10:27:42.604990 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m10:27:42.620990 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_customers (execute): 10:27:40.122840 => 10:27:42.620990
[0m10:27:42.620990 [debug] [Thread-2 (]: Timing info for model.mini_project.prep_products (execute): 10:27:40.154743 => 10:27:42.620990
[0m10:27:42.620990 [debug] [Thread-1 (]: On model.mini_project.prep_customers: Close
[0m10:27:42.620990 [debug] [Thread-2 (]: On model.mini_project.prep_products: Close
[0m10:27:43.268274 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cebe9c67-2abe-442e-b453-be6b625c6745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029FBCBBC650>]}
[0m10:27:43.268274 [info ] [Thread-2 (]: 2 of 3 OK created sql table model JOB_PORTAL.PREP.prep_products ................ [[32mSUCCESS 1[0m in 3.15s]
[0m10:27:43.268274 [debug] [Thread-2 (]: Finished running node model.mini_project.prep_products
[0m10:27:43.268274 [debug] [Thread-2 (]: Began running node model.mini_project.prep_transaction
[0m10:27:43.268274 [info ] [Thread-2 (]: 3 of 3 START sql table model JOB_PORTAL.PREP.prep_transaction .................. [RUN]
[0m10:27:43.268274 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mini_project.prep_products, now model.mini_project.prep_transaction)
[0m10:27:43.268274 [debug] [Thread-2 (]: Began compiling node model.mini_project.prep_transaction
[0m10:27:43.268274 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.prep_transaction"
[0m10:27:43.268274 [debug] [Thread-2 (]: Timing info for model.mini_project.prep_transaction (compile): 10:27:43.268274 => 10:27:43.268274
[0m10:27:43.282717 [debug] [Thread-2 (]: Began executing node model.mini_project.prep_transaction
[0m10:27:43.284051 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cebe9c67-2abe-442e-b453-be6b625c6745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029FBCC5CE60>]}
[0m10:27:43.287966 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.prep_transaction"
[0m10:27:43.288953 [info ] [Thread-1 (]: 1 of 3 OK created sql table model JOB_PORTAL.PREP.prep_customers ............... [[32mSUCCESS 1[0m in 3.19s]
[0m10:27:43.290328 [debug] [Thread-1 (]: Finished running node model.mini_project.prep_customers
[0m10:27:43.292591 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.prep_transaction"
[0m10:27:43.292591 [debug] [Thread-2 (]: On model.mini_project.prep_transaction: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.prep_transaction"} */
create or replace transient table JOB_PORTAL.PREP.prep_transaction
         as
        (
SELECT DISTINCT
    CUSTOMER_ID::NUMBER AS CUSTOMER_ID,
    PRODUCT_ID::VARCHAR AS PRODUCT_ID,
    TO_DATE(PAYMENT_MONTH, 'DD MM YYYY') AS PAYMENT_MONTH,
    REVENUE_TYPE::NUMBER AS REVENUE_TYPE,
    REVENUE::NUMBER(38,2) AS REVENUE,
    QUANTITY::NUMBER AS QUANTITY,
    LOWER(TRIM(COMPANIES)) AS COMPANIES
FROM JOB_PORTAL.RAW.raw_transaction
        );
[0m10:27:43.293626 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:27:45.038519 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01bafec9-0004-c0bd-0005-d15300018252
[0m10:27:45.038519 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000939 (22023): SQL compilation error: error line 7 at position 4
too many arguments for function [TO_DATE(RAW_TRANSACTION.PAYMENT_MONTH, 'DD MM YYYY')] expected 1, got 2
[0m10:27:45.038519 [debug] [Thread-2 (]: Timing info for model.mini_project.prep_transaction (execute): 10:27:43.284051 => 10:27:45.038519
[0m10:27:45.038519 [debug] [Thread-2 (]: On model.mini_project.prep_transaction: Close
[0m10:27:45.714935 [debug] [Thread-2 (]: Database Error in model prep_transaction (models\prep\prep_transaction.sql)
  000939 (22023): SQL compilation error: error line 7 at position 4
  too many arguments for function [TO_DATE(RAW_TRANSACTION.PAYMENT_MONTH, 'DD MM YYYY')] expected 1, got 2
  compiled Code at target\run\mini_project\models\prep\prep_transaction.sql
[0m10:27:45.714935 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cebe9c67-2abe-442e-b453-be6b625c6745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029FBCAEAD80>]}
[0m10:27:45.714935 [error] [Thread-2 (]: 3 of 3 ERROR creating sql table model JOB_PORTAL.PREP.prep_transaction ......... [[31mERROR[0m in 2.45s]
[0m10:27:45.714935 [debug] [Thread-2 (]: Finished running node model.mini_project.prep_transaction
[0m10:27:45.714935 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:27:45.714935 [debug] [MainThread]: Connection 'list_JOB_PORTAL' was properly closed.
[0m10:27:45.714935 [debug] [MainThread]: Connection 'list_JOB_PORTAL_PREP' was properly closed.
[0m10:27:45.714935 [debug] [MainThread]: Connection 'list_JOB_PORTAL_MART' was properly closed.
[0m10:27:45.714935 [debug] [MainThread]: Connection 'model.mini_project.prep_customers' was properly closed.
[0m10:27:45.714935 [debug] [MainThread]: Connection 'model.mini_project.prep_transaction' was properly closed.
[0m10:27:45.714935 [info ] [MainThread]: 
[0m10:27:45.714935 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 14.00 seconds (14.00s).
[0m10:27:45.723940 [debug] [MainThread]: Command end result
[0m10:27:45.734947 [info ] [MainThread]: 
[0m10:27:45.735959 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:27:45.736947 [info ] [MainThread]: 
[0m10:27:45.737958 [error] [MainThread]:   Database Error in model prep_transaction (models\prep\prep_transaction.sql)
  000939 (22023): SQL compilation error: error line 7 at position 4
  too many arguments for function [TO_DATE(RAW_TRANSACTION.PAYMENT_MONTH, 'DD MM YYYY')] expected 1, got 2
  compiled Code at target\run\mini_project\models\prep\prep_transaction.sql
[0m10:27:45.738949 [info ] [MainThread]: 
[0m10:27:45.738949 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m10:27:45.740981 [debug] [MainThread]: Command `dbt run` failed at 10:27:45.740981 after 14.90 seconds
[0m10:27:45.740981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029FBA9C5EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029FBA9C4DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029FBA9C60F0>]}
[0m10:27:45.741979 [debug] [MainThread]: Flushing usage events
[0m10:30:33.943278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A5DF54EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A5DF551C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A5DF55070>]}


============================== 10:30:33.948277 | 161ac411-ad73-4468-87b0-7600d84d4107 ==============================
[0m10:30:33.948277 [info ] [MainThread]: Running with dbt=1.7.19
[0m10:30:33.949191 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\DasariUday\\.dbt', 'log_path': 'C:\\Users\\DasariUday\\venv\\.venv\\mini_project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m tag:PREP', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:30:34.405898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '161ac411-ad73-4468-87b0-7600d84d4107', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A5DBE3890>]}
[0m10:30:34.465124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '161ac411-ad73-4468-87b0-7600d84d4107', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A5DFAE360>]}
[0m10:30:34.467088 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m10:30:34.475835 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m10:30:34.559665 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:30:34.559665 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:30:34.559665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '161ac411-ad73-4468-87b0-7600d84d4107', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A5DF7D5B0>]}
[0m10:30:34.575500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '161ac411-ad73-4468-87b0-7600d84d4107', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A5FE4BC50>]}
[0m10:30:34.575500 [info ] [MainThread]: Found 8 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m10:30:34.575500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '161ac411-ad73-4468-87b0-7600d84d4107', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A5ECD2A80>]}
[0m10:30:34.575500 [info ] [MainThread]: 
[0m10:30:34.575500 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:30:34.575500 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL'
[0m10:30:34.598009 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL"
[0m10:30:34.598009 [debug] [ThreadPool]: On list_JOB_PORTAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL"} */
show terse schemas in database JOB_PORTAL
    limit 10000
[0m10:30:34.598009 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:30:37.005701 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m10:30:37.005701 [debug] [ThreadPool]: On list_JOB_PORTAL: Close
[0m10:30:37.662454 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL_RAW'
[0m10:30:37.677579 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m10:30:37.677579 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m10:30:37.677579 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show terse objects in MINI_PROJECT.RAW limit 10000
[0m10:30:37.677579 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:30:37.677579 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_RAW"
[0m10:30:37.677579 [debug] [ThreadPool]: On list_JOB_PORTAL_RAW: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_RAW"} */
show terse objects in JOB_PORTAL.RAW limit 10000
[0m10:30:37.677579 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:30:39.437992 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.0 seconds
[0m10:30:39.437992 [debug] [ThreadPool]: On list_JOB_PORTAL_RAW: Close
[0m10:30:39.517045 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m10:30:39.517045 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: Close
[0m10:30:40.116082 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JOB_PORTAL_RAW, now list_JOB_PORTAL_PREP)
[0m10:30:40.116082 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_PREP"
[0m10:30:40.116082 [debug] [ThreadPool]: On list_JOB_PORTAL_PREP: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_PREP"} */
show terse objects in JOB_PORTAL.PREP limit 10000
[0m10:30:40.116082 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:30:40.177464 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_RAW, now list_JOB_PORTAL_MART)
[0m10:30:40.180485 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_MART"
[0m10:30:40.180485 [debug] [ThreadPool]: On list_JOB_PORTAL_MART: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_MART"} */
show terse objects in JOB_PORTAL.MART limit 10000
[0m10:30:40.180485 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:30:41.947288 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m10:30:41.947288 [debug] [ThreadPool]: On list_JOB_PORTAL_PREP: Close
[0m10:30:42.028061 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 2.0 seconds
[0m10:30:42.028061 [debug] [ThreadPool]: On list_JOB_PORTAL_MART: Close
[0m10:30:42.672313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '161ac411-ad73-4468-87b0-7600d84d4107', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A5FDD94F0>]}
[0m10:30:42.672313 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m10:30:42.672313 [info ] [MainThread]: 
[0m10:30:42.688103 [debug] [Thread-1 (]: Began running node model.mini_project.prep_customers
[0m10:30:42.688103 [debug] [Thread-2 (]: Began running node model.mini_project.prep_products
[0m10:30:42.688103 [info ] [Thread-1 (]: 1 of 3 START sql table model JOB_PORTAL.PREP.prep_customers .................... [RUN]
[0m10:30:42.692513 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project.prep_customers'
[0m10:30:42.688103 [info ] [Thread-2 (]: 2 of 3 START sql table model JOB_PORTAL.PREP.prep_products ..................... [RUN]
[0m10:30:42.693363 [debug] [Thread-1 (]: Began compiling node model.mini_project.prep_customers
[0m10:30:42.694351 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.mini_project.prep_products'
[0m10:30:42.703555 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.prep_customers"
[0m10:30:42.704588 [debug] [Thread-2 (]: Began compiling node model.mini_project.prep_products
[0m10:30:42.707588 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.prep_products"
[0m10:30:42.708560 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_customers (compile): 10:30:42.694901 => 10:30:42.708560
[0m10:30:42.708560 [debug] [Thread-2 (]: Timing info for model.mini_project.prep_products (compile): 10:30:42.704588 => 10:30:42.708560
[0m10:30:42.708560 [debug] [Thread-1 (]: Began executing node model.mini_project.prep_customers
[0m10:30:42.708560 [debug] [Thread-2 (]: Began executing node model.mini_project.prep_products
[0m10:30:42.763687 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.prep_products"
[0m10:30:42.767575 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.prep_customers"
[0m10:30:42.769827 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.prep_products"
[0m10:30:42.769827 [debug] [Thread-2 (]: On model.mini_project.prep_products: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.prep_products"} */
create or replace transient table JOB_PORTAL.PREP.prep_products
         as
        (
SELECT 
    PRODUCT_ID::VARCHAR AS PRODUCT_ID,
    LOWER(TRIM(PRODUCT_FAMILY)) AS PRODUCT_FAMILY,
    LOWER(TRIM(PRODUCT_SUB_FAMILY)) AS PRODUCT_SUB_FAMILY
FROM JOB_PORTAL.RAW.raw_products
        );
[0m10:30:42.769827 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:30:42.772825 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.prep_customers"
[0m10:30:42.773826 [debug] [Thread-1 (]: On model.mini_project.prep_customers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.prep_customers"} */
create or replace transient table JOB_PORTAL.PREP.prep_customers
         as
        (
SELECT DISTINCT
    LOWER(TRIM(COMPANY)) AS COMPANY,
    CUSTOMER_ID::NUMBER AS CUSTOMER_ID,
    LOWER(
        REGEXP_REPLACE(
            TRIM(REGEXP_SUBSTR(CUSTOMERNAME, '^[^(]+')), 
            ',', 
            ''
        )
    ) AS CUSTOMERNAME,  --  name without commas
    
FROM JOB_PORTAL.RAW.raw_customers
        );
[0m10:30:42.773826 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:30:45.451785 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m10:30:45.477774 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_customers (execute): 10:30:42.708560 => 10:30:45.475767
[0m10:30:45.477774 [debug] [Thread-1 (]: On model.mini_project.prep_customers: Close
[0m10:30:45.795021 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m10:30:45.812612 [debug] [Thread-2 (]: Timing info for model.mini_project.prep_products (execute): 10:30:42.718284 => 10:30:45.812612
[0m10:30:45.812612 [debug] [Thread-2 (]: On model.mini_project.prep_products: Close
[0m10:30:46.114617 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '161ac411-ad73-4468-87b0-7600d84d4107', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A6023D310>]}
[0m10:30:46.120814 [info ] [Thread-1 (]: 1 of 3 OK created sql table model JOB_PORTAL.PREP.prep_customers ............... [[32mSUCCESS 1[0m in 3.42s]
[0m10:30:46.121862 [debug] [Thread-1 (]: Finished running node model.mini_project.prep_customers
[0m10:30:46.122822 [debug] [Thread-1 (]: Began running node model.mini_project.prep_transaction
[0m10:30:46.123821 [info ] [Thread-1 (]: 3 of 3 START sql table model JOB_PORTAL.PREP.prep_transaction .................. [RUN]
[0m10:30:46.124822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.prep_customers, now model.mini_project.prep_transaction)
[0m10:30:46.124822 [debug] [Thread-1 (]: Began compiling node model.mini_project.prep_transaction
[0m10:30:46.127822 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.prep_transaction"
[0m10:30:46.131294 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_transaction (compile): 10:30:46.125823 => 10:30:46.130763
[0m10:30:46.132382 [debug] [Thread-1 (]: Began executing node model.mini_project.prep_transaction
[0m10:30:46.135464 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.prep_transaction"
[0m10:30:46.135464 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.prep_transaction"
[0m10:30:46.137328 [debug] [Thread-1 (]: On model.mini_project.prep_transaction: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.prep_transaction"} */
create or replace transient table JOB_PORTAL.PREP.prep_transaction
         as
        (
SELECT DISTINCT
    CUSTOMER_ID::NUMBER AS CUSTOMER_ID,
    PRODUCT_ID::VARCHAR AS PRODUCT_ID,
    TO_DATE(PAYMENT_MONTH, 'MM/DD/YYYY') AS PAYMENT_MONTH,
    REVENUE_TYPE::NUMBER AS REVENUE_TYPE,
    REVENUE::NUMBER(38,2) AS REVENUE,
    QUANTITY::NUMBER AS QUANTITY,
    LOWER(TRIM(COMPANIES)) AS COMPANIES
FROM JOB_PORTAL.RAW.raw_transaction
        );
[0m10:30:46.138385 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:30:46.444900 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '161ac411-ad73-4468-87b0-7600d84d4107', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A6018ED20>]}
[0m10:30:46.444900 [info ] [Thread-2 (]: 2 of 3 OK created sql table model JOB_PORTAL.PREP.prep_products ................ [[32mSUCCESS 1[0m in 3.75s]
[0m10:30:46.444900 [debug] [Thread-2 (]: Finished running node model.mini_project.prep_products
[0m10:30:47.977002 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafecc-0004-bded-0005-d15300016902
[0m10:30:47.977002 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000939 (22023): SQL compilation error: error line 7 at position 4
too many arguments for function [TO_DATE(RAW_TRANSACTION.PAYMENT_MONTH, 'MM/DD/YYYY')] expected 1, got 2
[0m10:30:47.977002 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_transaction (execute): 10:30:46.132382 => 10:30:47.977002
[0m10:30:47.977002 [debug] [Thread-1 (]: On model.mini_project.prep_transaction: Close
[0m10:30:48.621534 [debug] [Thread-1 (]: Database Error in model prep_transaction (models\prep\prep_transaction.sql)
  000939 (22023): SQL compilation error: error line 7 at position 4
  too many arguments for function [TO_DATE(RAW_TRANSACTION.PAYMENT_MONTH, 'MM/DD/YYYY')] expected 1, got 2
  compiled Code at target\run\mini_project\models\prep\prep_transaction.sql
[0m10:30:48.621534 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '161ac411-ad73-4468-87b0-7600d84d4107', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A5FEAC620>]}
[0m10:30:48.621534 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model JOB_PORTAL.PREP.prep_transaction ......... [[31mERROR[0m in 2.50s]
[0m10:30:48.621534 [debug] [Thread-1 (]: Finished running node model.mini_project.prep_transaction
[0m10:30:48.621534 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:30:48.621534 [debug] [MainThread]: Connection 'list_JOB_PORTAL' was properly closed.
[0m10:30:48.621534 [debug] [MainThread]: Connection 'list_JOB_PORTAL_PREP' was properly closed.
[0m10:30:48.621534 [debug] [MainThread]: Connection 'list_JOB_PORTAL_MART' was properly closed.
[0m10:30:48.621534 [debug] [MainThread]: Connection 'model.mini_project.prep_transaction' was properly closed.
[0m10:30:48.621534 [debug] [MainThread]: Connection 'model.mini_project.prep_products' was properly closed.
[0m10:30:48.621534 [info ] [MainThread]: 
[0m10:30:48.621534 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 14.05 seconds (14.05s).
[0m10:30:48.635217 [debug] [MainThread]: Command end result
[0m10:30:48.646986 [info ] [MainThread]: 
[0m10:30:48.648019 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:30:48.648019 [info ] [MainThread]: 
[0m10:30:48.648019 [error] [MainThread]:   Database Error in model prep_transaction (models\prep\prep_transaction.sql)
  000939 (22023): SQL compilation error: error line 7 at position 4
  too many arguments for function [TO_DATE(RAW_TRANSACTION.PAYMENT_MONTH, 'MM/DD/YYYY')] expected 1, got 2
  compiled Code at target\run\mini_project\models\prep\prep_transaction.sql
[0m10:30:48.648019 [info ] [MainThread]: 
[0m10:30:48.648019 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m10:30:48.648019 [debug] [MainThread]: Command `dbt run` failed at 10:30:48.648019 after 14.90 seconds
[0m10:30:48.648019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A5DDAC620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A5D278BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A5DF55220>]}
[0m10:30:48.648019 [debug] [MainThread]: Flushing usage events
[0m10:39:07.806624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002449BF94C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002449BF95070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002449BF95610>]}


============================== 10:39:07.822550 | b17eff13-8b7c-4559-871d-bffa2a4de132 ==============================
[0m10:39:07.822550 [info ] [MainThread]: Running with dbt=1.7.19
[0m10:39:07.822550 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\DasariUday\\.dbt', 'log_path': 'C:\\Users\\DasariUday\\venv\\.venv\\mini_project\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m PREP_TRANSACTION', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:39:08.810620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b17eff13-8b7c-4559-871d-bffa2a4de132', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002449DD8A4B0>]}
[0m10:39:08.877693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b17eff13-8b7c-4559-871d-bffa2a4de132', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002449BFEDE20>]}
[0m10:39:08.877693 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m10:39:08.890663 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m10:39:08.981546 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:39:08.981546 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:39:08.981546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b17eff13-8b7c-4559-871d-bffa2a4de132', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002449CA46A20>]}
[0m10:39:09.013153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b17eff13-8b7c-4559-871d-bffa2a4de132', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002449DE8BAA0>]}
[0m10:39:09.013153 [info ] [MainThread]: Found 8 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m10:39:09.013153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b17eff13-8b7c-4559-871d-bffa2a4de132', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002449CC77110>]}
[0m10:39:09.013153 [warn ] [MainThread]: The selection criterion 'PREP_TRANSACTION' does not match any nodes
[0m10:39:09.013153 [info ] [MainThread]: 
[0m10:39:09.013153 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:39:09.020271 [debug] [MainThread]: Command end result
[0m10:39:09.029204 [debug] [MainThread]: Command `dbt run` succeeded at 10:39:09.029204 after 1.44 seconds
[0m10:39:09.030129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002449BD45670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002449CA5F920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002449BCB8B00>]}
[0m10:39:09.030129 [debug] [MainThread]: Flushing usage events
[0m10:39:23.102739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1D5964920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1D5964BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1D5965340>]}


============================== 10:39:23.106772 | f0592acc-d96f-46b1-bf94-9f8157b571a7 ==============================
[0m10:39:23.106772 [info ] [MainThread]: Running with dbt=1.7.19
[0m10:39:23.107771 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\DasariUday\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\DasariUday\\venv\\.venv\\mini_project\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m prep_transaction', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:39:23.583864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0592acc-d96f-46b1-bf94-9f8157b571a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1D49F6C00>]}
[0m10:39:23.646579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f0592acc-d96f-46b1-bf94-9f8157b571a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1D559BCE0>]}
[0m10:39:23.646579 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m10:39:23.662665 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m10:39:23.754068 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:39:23.755104 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:39:23.761103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0592acc-d96f-46b1-bf94-9f8157b571a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1D6663230>]}
[0m10:39:23.769003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0592acc-d96f-46b1-bf94-9f8157b571a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1D77BAC90>]}
[0m10:39:23.769003 [info ] [MainThread]: Found 8 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m10:39:23.769003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0592acc-d96f-46b1-bf94-9f8157b571a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1D6597110>]}
[0m10:39:23.769003 [info ] [MainThread]: 
[0m10:39:23.769003 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:39:23.769003 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL'
[0m10:39:23.786799 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL"
[0m10:39:23.786799 [debug] [ThreadPool]: On list_JOB_PORTAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL"} */
show terse schemas in database JOB_PORTAL
    limit 10000
[0m10:39:23.786799 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:39:26.202774 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m10:39:26.204778 [debug] [ThreadPool]: On list_JOB_PORTAL: Close
[0m10:39:26.858363 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL_PREP'
[0m10:39:26.874326 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL_MART'
[0m10:39:26.874326 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_PREP"
[0m10:39:26.874326 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_MART"
[0m10:39:26.874326 [debug] [ThreadPool]: On list_JOB_PORTAL_PREP: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_PREP"} */
show terse objects in JOB_PORTAL.PREP limit 10000
[0m10:39:26.874326 [debug] [ThreadPool]: On list_JOB_PORTAL_MART: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_MART"} */
show terse objects in JOB_PORTAL.MART limit 10000
[0m10:39:26.874326 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:39:26.874326 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:39:28.650267 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m10:39:28.650267 [debug] [ThreadPool]: On list_JOB_PORTAL_PREP: Close
[0m10:39:28.691158 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 2.0 seconds
[0m10:39:28.691158 [debug] [ThreadPool]: On list_JOB_PORTAL_MART: Close
[0m10:39:29.283547 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JOB_PORTAL_PREP, now list_MINI_PROJECT_RAW)
[0m10:39:29.287556 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m10:39:29.287556 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show terse objects in MINI_PROJECT.RAW limit 10000
[0m10:39:29.287556 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:39:29.339272 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JOB_PORTAL_MART, now list_JOB_PORTAL_RAW)
[0m10:39:29.339272 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_RAW"
[0m10:39:29.339272 [debug] [ThreadPool]: On list_JOB_PORTAL_RAW: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_RAW"} */
show terse objects in JOB_PORTAL.RAW limit 10000
[0m10:39:29.339272 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:39:31.149197 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.0 seconds
[0m10:39:31.158878 [debug] [ThreadPool]: On list_JOB_PORTAL_RAW: Close
[0m10:39:31.329588 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m10:39:31.331590 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: Close
[0m10:39:31.957717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0592acc-d96f-46b1-bf94-9f8157b571a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1D6662720>]}
[0m10:39:31.957717 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m10:39:31.957717 [info ] [MainThread]: 
[0m10:39:31.957717 [debug] [Thread-1 (]: Began running node model.mini_project.prep_transaction
[0m10:39:31.957717 [info ] [Thread-1 (]: 1 of 1 START sql table model JOB_PORTAL.PREP.prep_transaction .................. [RUN]
[0m10:39:31.957717 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project.prep_transaction'
[0m10:39:31.969382 [debug] [Thread-1 (]: Began compiling node model.mini_project.prep_transaction
[0m10:39:31.979527 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.prep_transaction"
[0m10:39:31.979527 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_transaction (compile): 10:39:31.969382 => 10:39:31.979527
[0m10:39:31.979527 [debug] [Thread-1 (]: Began executing node model.mini_project.prep_transaction
[0m10:39:32.009833 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.prep_transaction"
[0m10:39:32.009833 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.prep_transaction"
[0m10:39:32.009833 [debug] [Thread-1 (]: On model.mini_project.prep_transaction: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.prep_transaction"} */
create or replace transient table JOB_PORTAL.PREP.prep_transaction
         as
        (
SELECT DISTINCT
    CUSTOMER_ID::NUMBER AS CUSTOMER_ID,
    PRODUCT_ID::VARCHAR AS PRODUCT_ID,
    TO_DATE(DATE,PAYMENT_MONTH, 'MM/DD/YYYY') AS PAYMENT_MONTH,
    REVENUE_TYPE::NUMBER AS REVENUE_TYPE,
    REVENUE::NUMBER(38,2) AS REVENUE,
    QUANTITY::NUMBER AS QUANTITY,
    LOWER(TRIM(COMPANIES)) AS COMPANIES
FROM JOB_PORTAL.RAW.raw_transaction
        );
[0m10:39:32.009833 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:39:33.951187 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafed5-0004-bded-0005-d15300016916
[0m10:39:33.951187 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 12
invalid identifier 'DATE'
[0m10:39:33.963688 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_transaction (execute): 10:39:31.979527 => 10:39:33.963688
[0m10:39:33.963688 [debug] [Thread-1 (]: On model.mini_project.prep_transaction: Close
[0m10:39:34.614007 [debug] [Thread-1 (]: Database Error in model prep_transaction (models\prep\prep_transaction.sql)
  000904 (42000): SQL compilation error: error line 7 at position 12
  invalid identifier 'DATE'
  compiled Code at target\run\mini_project\models\prep\prep_transaction.sql
[0m10:39:34.614007 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0592acc-d96f-46b1-bf94-9f8157b571a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1D7BDB290>]}
[0m10:39:34.614007 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model JOB_PORTAL.PREP.prep_transaction ......... [[31mERROR[0m in 2.66s]
[0m10:39:34.614007 [debug] [Thread-1 (]: Finished running node model.mini_project.prep_transaction
[0m10:39:34.614007 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:39:34.614007 [debug] [MainThread]: Connection 'list_JOB_PORTAL' was properly closed.
[0m10:39:34.614007 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was properly closed.
[0m10:39:34.614007 [debug] [MainThread]: Connection 'list_JOB_PORTAL_RAW' was properly closed.
[0m10:39:34.614007 [debug] [MainThread]: Connection 'model.mini_project.prep_transaction' was properly closed.
[0m10:39:34.614007 [info ] [MainThread]: 
[0m10:39:34.614007 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.85 seconds (10.85s).
[0m10:39:34.625094 [debug] [MainThread]: Command end result
[0m10:39:34.630429 [info ] [MainThread]: 
[0m10:39:34.630429 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:39:34.638551 [info ] [MainThread]: 
[0m10:39:34.639377 [error] [MainThread]:   Database Error in model prep_transaction (models\prep\prep_transaction.sql)
  000904 (42000): SQL compilation error: error line 7 at position 12
  invalid identifier 'DATE'
  compiled Code at target\run\mini_project\models\prep\prep_transaction.sql
[0m10:39:34.640385 [info ] [MainThread]: 
[0m10:39:34.643139 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:39:34.644603 [debug] [MainThread]: Command `dbt run` failed at 10:39:34.644603 after 11.67 seconds
[0m10:39:34.645933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1CF235610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1D64DC380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1D7ACCB00>]}
[0m10:39:34.646943 [debug] [MainThread]: Flushing usage events
[0m10:41:53.185107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B748F55490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B748F558B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B748F55010>]}


============================== 10:41:53.185107 | 11b627fd-14d2-4e75-b587-6e2269107b50 ==============================
[0m10:41:53.185107 [info ] [MainThread]: Running with dbt=1.7.19
[0m10:41:53.200935 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\DasariUday\\venv\\.venv\\mini_project\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\DasariUday\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m prep_transaction', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:41:54.141215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11b627fd-14d2-4e75-b587-6e2269107b50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B749C62F00>]}
[0m10:41:54.216351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11b627fd-14d2-4e75-b587-6e2269107b50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B74ACB71A0>]}
[0m10:41:54.218355 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m10:41:54.228223 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m10:41:54.331487 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:41:54.331487 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:41:54.336698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11b627fd-14d2-4e75-b587-6e2269107b50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B748F54FE0>]}
[0m10:41:54.345286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11b627fd-14d2-4e75-b587-6e2269107b50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B74ADBACC0>]}
[0m10:41:54.345286 [info ] [MainThread]: Found 8 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m10:41:54.345286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11b627fd-14d2-4e75-b587-6e2269107b50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B74ADBBF80>]}
[0m10:41:54.353441 [info ] [MainThread]: 
[0m10:41:54.353441 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:41:54.353441 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL'
[0m10:41:54.371666 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL"
[0m10:41:54.371666 [debug] [ThreadPool]: On list_JOB_PORTAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL"} */
show terse schemas in database JOB_PORTAL
    limit 10000
[0m10:41:54.371666 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:41:56.612586 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m10:41:56.612586 [debug] [ThreadPool]: On list_JOB_PORTAL: Close
[0m10:41:57.272396 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL_RAW'
[0m10:41:57.280384 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m10:41:57.282394 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_RAW"
[0m10:41:57.282394 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m10:41:57.288544 [debug] [ThreadPool]: On list_JOB_PORTAL_RAW: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_RAW"} */
show terse objects in JOB_PORTAL.RAW limit 10000
[0m10:41:57.288544 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show terse objects in MINI_PROJECT.RAW limit 10000
[0m10:41:57.288544 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:41:57.288544 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:41:59.071867 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.0 seconds
[0m10:41:59.071867 [debug] [ThreadPool]: On list_JOB_PORTAL_RAW: Close
[0m10:41:59.071867 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m10:41:59.086752 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: Close
[0m10:41:59.776955 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_RAW, now list_JOB_PORTAL_PREP)
[0m10:41:59.779974 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_PREP"
[0m10:41:59.779974 [debug] [ThreadPool]: On list_JOB_PORTAL_PREP: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_PREP"} */
show terse objects in JOB_PORTAL.PREP limit 10000
[0m10:41:59.781981 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:41:59.787549 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JOB_PORTAL_RAW, now list_JOB_PORTAL_MART)
[0m10:41:59.790881 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_MART"
[0m10:41:59.792891 [debug] [ThreadPool]: On list_JOB_PORTAL_MART: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_MART"} */
show terse objects in JOB_PORTAL.MART limit 10000
[0m10:41:59.792891 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:42:01.517900 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m10:42:01.517900 [debug] [ThreadPool]: On list_JOB_PORTAL_PREP: Close
[0m10:42:01.533646 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 2.0 seconds
[0m10:42:01.533646 [debug] [ThreadPool]: On list_JOB_PORTAL_MART: Close
[0m10:42:02.357826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11b627fd-14d2-4e75-b587-6e2269107b50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B747FE6F00>]}
[0m10:42:02.357826 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m10:42:02.358993 [info ] [MainThread]: 
[0m10:42:02.363993 [debug] [Thread-1 (]: Began running node model.mini_project.prep_transaction
[0m10:42:02.364993 [info ] [Thread-1 (]: 1 of 1 START sql table model JOB_PORTAL.PREP.prep_transaction .................. [RUN]
[0m10:42:02.367177 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project.prep_transaction'
[0m10:42:02.368176 [debug] [Thread-1 (]: Began compiling node model.mini_project.prep_transaction
[0m10:42:02.379935 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.prep_transaction"
[0m10:42:02.379935 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_transaction (compile): 10:42:02.369176 => 10:42:02.379935
[0m10:42:02.379935 [debug] [Thread-1 (]: Began executing node model.mini_project.prep_transaction
[0m10:42:02.419041 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.prep_transaction"
[0m10:42:02.424036 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.prep_transaction"
[0m10:42:02.425039 [debug] [Thread-1 (]: On model.mini_project.prep_transaction: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.prep_transaction"} */
create or replace transient table JOB_PORTAL.PREP.prep_transaction
         as
        (
SELECT DISTINCT
    CUSTOMER_ID::NUMBER AS CUSTOMER_ID,
    PRODUCT_ID::VARCHAR AS PRODUCT_ID,
    TO_DATE(PAYMENT_MONTH, 'MM/DD/YYYY') AS PAYMENT_MONTH,
    REVENUE_TYPE::NUMBER AS REVENUE_TYPE,
    REVENUE::NUMBER(38,2) AS REVENUE,
    QUANTITY::NUMBER AS QUANTITY,
    LOWER(TRIM(COMPANIES)) AS COMPANIES
FROM JOB_PORTAL.RAW.raw_transaction
        );
[0m10:42:02.425039 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:42:04.203054 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafed8-0004-bb9d-0005-d15300011a3e
[0m10:42:04.204087 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000939 (22023): SQL compilation error: error line 7 at position 4
too many arguments for function [TO_DATE(RAW_TRANSACTION.PAYMENT_MONTH, 'MM/DD/YYYY')] expected 1, got 2
[0m10:42:04.204087 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_transaction (execute): 10:42:02.379935 => 10:42:04.204087
[0m10:42:04.205054 [debug] [Thread-1 (]: On model.mini_project.prep_transaction: Close
[0m10:42:04.838962 [debug] [Thread-1 (]: Database Error in model prep_transaction (models\prep\prep_transaction.sql)
  000939 (22023): SQL compilation error: error line 7 at position 4
  too many arguments for function [TO_DATE(RAW_TRANSACTION.PAYMENT_MONTH, 'MM/DD/YYYY')] expected 1, got 2
  compiled Code at target\run\mini_project\models\prep\prep_transaction.sql
[0m10:42:04.838962 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11b627fd-14d2-4e75-b587-6e2269107b50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B74B14BF50>]}
[0m10:42:04.839963 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model JOB_PORTAL.PREP.prep_transaction ......... [[31mERROR[0m in 2.47s]
[0m10:42:04.841496 [debug] [Thread-1 (]: Finished running node model.mini_project.prep_transaction
[0m10:42:04.844243 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:42:04.844243 [debug] [MainThread]: Connection 'list_JOB_PORTAL' was properly closed.
[0m10:42:04.844243 [debug] [MainThread]: Connection 'list_JOB_PORTAL_MART' was properly closed.
[0m10:42:04.845243 [debug] [MainThread]: Connection 'list_JOB_PORTAL_PREP' was properly closed.
[0m10:42:04.845243 [debug] [MainThread]: Connection 'model.mini_project.prep_transaction' was properly closed.
[0m10:42:04.845243 [info ] [MainThread]: 
[0m10:42:04.846243 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.49 seconds (10.49s).
[0m10:42:04.847243 [debug] [MainThread]: Command end result
[0m10:42:04.856359 [info ] [MainThread]: 
[0m10:42:04.857748 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:42:04.858903 [info ] [MainThread]: 
[0m10:42:04.859963 [error] [MainThread]:   Database Error in model prep_transaction (models\prep\prep_transaction.sql)
  000939 (22023): SQL compilation error: error line 7 at position 4
  too many arguments for function [TO_DATE(RAW_TRANSACTION.PAYMENT_MONTH, 'MM/DD/YYYY')] expected 1, got 2
  compiled Code at target\run\mini_project\models\prep\prep_transaction.sql
[0m10:42:04.859963 [info ] [MainThread]: 
[0m10:42:04.860965 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:42:04.861963 [debug] [MainThread]: Command `dbt run` failed at 10:42:04.861963 after 11.90 seconds
[0m10:42:04.862996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B748D7CF20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B74ADB2D20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B74982EA20>]}
[0m10:42:04.862996 [debug] [MainThread]: Flushing usage events
[0m10:44:28.602412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE71464F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE714653A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE71466180>]}


============================== 10:44:28.602412 | a4f8338d-bc25-4528-a6fa-5b8c5ddb3564 ==============================
[0m10:44:28.602412 [info ] [MainThread]: Running with dbt=1.7.19
[0m10:44:28.602412 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\DasariUday\\venv\\.venv\\mini_project\\logs', 'profiles_dir': 'C:\\Users\\DasariUday\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m prep_transaction', 'send_anonymous_usage_stats': 'True'}
[0m10:44:29.084036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4f8338d-bc25-4528-a6fa-5b8c5ddb3564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE714650D0>]}
[0m10:44:29.154041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a4f8338d-bc25-4528-a6fa-5b8c5ddb3564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE721AA540>]}
[0m10:44:29.156047 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m10:44:29.163787 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m10:44:29.258249 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:44:29.258249 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:44:29.264232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4f8338d-bc25-4528-a6fa-5b8c5ddb3564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE73244F20>]}
[0m10:44:29.277195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4f8338d-bc25-4528-a6fa-5b8c5ddb3564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE732BBB00>]}
[0m10:44:29.278301 [info ] [MainThread]: Found 8 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m10:44:29.279300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4f8338d-bc25-4528-a6fa-5b8c5ddb3564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE731B5490>]}
[0m10:44:29.280301 [info ] [MainThread]: 
[0m10:44:29.281300 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:44:29.283302 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL'
[0m10:44:29.297336 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL"
[0m10:44:29.298335 [debug] [ThreadPool]: On list_JOB_PORTAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL"} */
show terse schemas in database JOB_PORTAL
    limit 10000
[0m10:44:29.298335 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:44:31.567258 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m10:44:31.580245 [debug] [ThreadPool]: On list_JOB_PORTAL: Close
[0m10:44:32.228570 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL_MART'
[0m10:44:32.241211 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL_RAW'
[0m10:44:32.248658 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_MART"
[0m10:44:32.250662 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_RAW"
[0m10:44:32.250662 [debug] [ThreadPool]: On list_JOB_PORTAL_MART: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_MART"} */
show terse objects in JOB_PORTAL.MART limit 10000
[0m10:44:32.250662 [debug] [ThreadPool]: On list_JOB_PORTAL_RAW: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_RAW"} */
show terse objects in JOB_PORTAL.RAW limit 10000
[0m10:44:32.252666 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:44:32.252666 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:44:34.052076 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 2.0 seconds
[0m10:44:34.059927 [debug] [ThreadPool]: On list_JOB_PORTAL_MART: Close
[0m10:44:34.081740 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.0 seconds
[0m10:44:34.081740 [debug] [ThreadPool]: On list_JOB_PORTAL_RAW: Close
[0m10:44:34.694680 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JOB_PORTAL_MART, now list_MINI_PROJECT_RAW)
[0m10:44:34.696644 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m10:44:34.697643 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show terse objects in MINI_PROJECT.RAW limit 10000
[0m10:44:34.697643 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:44:34.737928 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JOB_PORTAL_RAW, now list_JOB_PORTAL_PREP)
[0m10:44:34.737928 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_PREP"
[0m10:44:34.737928 [debug] [ThreadPool]: On list_JOB_PORTAL_PREP: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_PREP"} */
show terse objects in JOB_PORTAL.PREP limit 10000
[0m10:44:34.737928 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:44:36.517249 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m10:44:36.519253 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: Close
[0m10:44:36.523262 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m10:44:36.523262 [debug] [ThreadPool]: On list_JOB_PORTAL_PREP: Close
[0m10:44:37.517113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4f8338d-bc25-4528-a6fa-5b8c5ddb3564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE734F19D0>]}
[0m10:44:37.517113 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m10:44:37.517113 [info ] [MainThread]: 
[0m10:44:37.517113 [debug] [Thread-1 (]: Began running node model.mini_project.prep_transaction
[0m10:44:37.517113 [info ] [Thread-1 (]: 1 of 1 START sql table model JOB_PORTAL.PREP.prep_transaction .................. [RUN]
[0m10:44:37.532780 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project.prep_transaction'
[0m10:44:37.533511 [debug] [Thread-1 (]: Began compiling node model.mini_project.prep_transaction
[0m10:44:37.538938 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.prep_transaction"
[0m10:44:37.544280 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_transaction (compile): 10:44:37.533511 => 10:44:37.538938
[0m10:44:37.545290 [debug] [Thread-1 (]: Began executing node model.mini_project.prep_transaction
[0m10:44:37.564856 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.prep_transaction"
[0m10:44:37.578556 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.prep_transaction"
[0m10:44:37.578556 [debug] [Thread-1 (]: On model.mini_project.prep_transaction: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.prep_transaction"} */
create or replace transient table JOB_PORTAL.PREP.prep_transaction
         as
        (
SELECT DISTINCT
    CUSTOMER_ID::NUMBER AS CUSTOMER_ID,
    PRODUCT_ID::VARCHAR AS PRODUCT_ID,
    TO_DATE(PAYMENT_MONTH) AS PAYMENT_MONTH,
    TO_DATE(PAYMENT_MONTH, 'MM/DD/YYYY') AS PAYMENT_MONTH,
    REVENUE_TYPE::NUMBER AS REVENUE_TYPE,
    REVENUE::NUMBER(38,2) AS REVENUE,
    QUANTITY::NUMBER AS QUANTITY,
    LOWER(TRIM(COMPANIES)) AS COMPANIES
FROM JOB_PORTAL.RAW.raw_transaction
        );
[0m10:44:37.578556 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:44:39.328817 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafeda-0004-bb9f-0005-d1530001399e
[0m10:44:39.328817 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000939 (22023): SQL compilation error: error line 8 at position 4
too many arguments for function [TO_DATE(RAW_TRANSACTION.PAYMENT_MONTH, 'MM/DD/YYYY')] expected 1, got 2
[0m10:44:39.330822 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_transaction (execute): 10:44:37.545290 => 10:44:39.330822
[0m10:44:39.330822 [debug] [Thread-1 (]: On model.mini_project.prep_transaction: Close
[0m10:44:39.967526 [debug] [Thread-1 (]: Database Error in model prep_transaction (models\prep\prep_transaction.sql)
  000939 (22023): SQL compilation error: error line 8 at position 4
  too many arguments for function [TO_DATE(RAW_TRANSACTION.PAYMENT_MONTH, 'MM/DD/YYYY')] expected 1, got 2
  compiled Code at target\run\mini_project\models\prep\prep_transaction.sql
[0m10:44:39.967526 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4f8338d-bc25-4528-a6fa-5b8c5ddb3564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE735620C0>]}
[0m10:44:39.967526 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model JOB_PORTAL.PREP.prep_transaction ......... [[31mERROR[0m in 2.45s]
[0m10:44:39.967526 [debug] [Thread-1 (]: Finished running node model.mini_project.prep_transaction
[0m10:44:39.967526 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:44:39.967526 [debug] [MainThread]: Connection 'list_JOB_PORTAL' was properly closed.
[0m10:44:39.967526 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was properly closed.
[0m10:44:39.967526 [debug] [MainThread]: Connection 'list_JOB_PORTAL_PREP' was properly closed.
[0m10:44:39.967526 [debug] [MainThread]: Connection 'model.mini_project.prep_transaction' was properly closed.
[0m10:44:39.967526 [info ] [MainThread]: 
[0m10:44:39.967526 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.69 seconds (10.69s).
[0m10:44:39.976983 [debug] [MainThread]: Command end result
[0m10:44:39.982851 [info ] [MainThread]: 
[0m10:44:39.982851 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:44:39.993066 [info ] [MainThread]: 
[0m10:44:39.993066 [error] [MainThread]:   Database Error in model prep_transaction (models\prep\prep_transaction.sql)
  000939 (22023): SQL compilation error: error line 8 at position 4
  too many arguments for function [TO_DATE(RAW_TRANSACTION.PAYMENT_MONTH, 'MM/DD/YYYY')] expected 1, got 2
  compiled Code at target\run\mini_project\models\prep\prep_transaction.sql
[0m10:44:39.994123 [info ] [MainThread]: 
[0m10:44:39.995106 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:44:39.996075 [debug] [MainThread]: Command `dbt run` failed at 10:44:39.996075 after 11.60 seconds
[0m10:44:39.996075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE71028BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE70789670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE713901D0>]}
[0m10:44:39.996075 [debug] [MainThread]: Flushing usage events
[0m10:46:40.004472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002747BD855B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002747BD860F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002747BD84F80>]}


============================== 10:46:40.010227 | 6b435924-c17e-44dd-b856-c27e1e385a78 ==============================
[0m10:46:40.010227 [info ] [MainThread]: Running with dbt=1.7.19
[0m10:46:40.010227 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\DasariUday\\.dbt', 'log_path': 'C:\\Users\\DasariUday\\venv\\.venv\\mini_project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m prep_transaction', 'send_anonymous_usage_stats': 'True'}
[0m10:46:40.513809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b435924-c17e-44dd-b856-c27e1e385a78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002747BD84DD0>]}
[0m10:46:40.577146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b435924-c17e-44dd-b856-c27e1e385a78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002747B6C2630>]}
[0m10:46:40.577146 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m10:46:40.605019 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m10:46:41.942576 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:46:41.942576 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:46:41.942576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b435924-c17e-44dd-b856-c27e1e385a78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002747DB9C620>]}
[0m10:46:42.065902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b435924-c17e-44dd-b856-c27e1e385a78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002747DBEBFE0>]}
[0m10:46:42.065902 [info ] [MainThread]: Found 8 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m10:46:42.065902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b435924-c17e-44dd-b856-c27e1e385a78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002747BDACE60>]}
[0m10:46:42.070881 [info ] [MainThread]: 
[0m10:46:42.072889 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:46:42.072889 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL'
[0m10:46:42.088367 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL"
[0m10:46:42.088367 [debug] [ThreadPool]: On list_JOB_PORTAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL"} */
show terse schemas in database JOB_PORTAL
    limit 10000
[0m10:46:42.088367 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:46:44.222690 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m10:46:44.224694 [debug] [ThreadPool]: On list_JOB_PORTAL: Close
[0m10:46:44.844843 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m10:46:44.860576 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL_PREP'
[0m10:46:44.860576 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m10:46:44.860576 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_PREP"
[0m10:46:44.860576 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show terse objects in MINI_PROJECT.RAW limit 10000
[0m10:46:44.860576 [debug] [ThreadPool]: On list_JOB_PORTAL_PREP: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_PREP"} */
show terse objects in JOB_PORTAL.PREP limit 10000
[0m10:46:44.860576 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:46:44.860576 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:46:46.650183 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m10:46:46.650183 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: Close
[0m10:46:46.702282 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m10:46:46.702282 [debug] [ThreadPool]: On list_JOB_PORTAL_PREP: Close
[0m10:46:47.297123 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_RAW, now list_JOB_PORTAL_MART)
[0m10:46:47.297123 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_MART"
[0m10:46:47.297123 [debug] [ThreadPool]: On list_JOB_PORTAL_MART: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_MART"} */
show terse objects in JOB_PORTAL.MART limit 10000
[0m10:46:47.297123 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:46:47.402890 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JOB_PORTAL_PREP, now list_JOB_PORTAL_RAW)
[0m10:46:47.402890 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_RAW"
[0m10:46:47.402890 [debug] [ThreadPool]: On list_JOB_PORTAL_RAW: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_RAW"} */
show terse objects in JOB_PORTAL.RAW limit 10000
[0m10:46:47.418767 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:46:49.097071 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 2.0 seconds
[0m10:46:49.097071 [debug] [ThreadPool]: On list_JOB_PORTAL_MART: Close
[0m10:46:49.160220 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.0 seconds
[0m10:46:49.160220 [debug] [ThreadPool]: On list_JOB_PORTAL_RAW: Close
[0m10:46:49.827735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b435924-c17e-44dd-b856-c27e1e385a78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002747DEA78C0>]}
[0m10:46:49.829739 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m10:46:49.829739 [info ] [MainThread]: 
[0m10:46:49.829739 [debug] [Thread-1 (]: Began running node model.mini_project.prep_transaction
[0m10:46:49.829739 [info ] [Thread-1 (]: 1 of 1 START sql table model JOB_PORTAL.PREP.prep_transaction .................. [RUN]
[0m10:46:49.829739 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project.prep_transaction'
[0m10:46:49.837863 [debug] [Thread-1 (]: Began compiling node model.mini_project.prep_transaction
[0m10:46:49.843616 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.prep_transaction"
[0m10:46:49.843616 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_transaction (compile): 10:46:49.837863 => 10:46:49.843616
[0m10:46:49.843616 [debug] [Thread-1 (]: Began executing node model.mini_project.prep_transaction
[0m10:46:49.877018 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.prep_transaction"
[0m10:46:49.877018 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.prep_transaction"
[0m10:46:49.877018 [debug] [Thread-1 (]: On model.mini_project.prep_transaction: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.prep_transaction"} */
create or replace transient table JOB_PORTAL.PREP.prep_transaction
         as
        (
    SELECT DISTINCT
        CUSTOMER_ID::NUMBER AS CUSTOMER_ID,
        PRODUCT_ID::VARCHAR AS PRODUCT_ID,
        TO_DATE(PAYMENT_MONTH, 'MM/DD/YYYY') AS PAYMENT_MONTH,
        REVENUE_TYPE::NUMBER AS REVENUE_TYPE,
        REVENUE::NUMBER(38,2) AS REVENUE,
        QUANTITY::NUMBER AS QUANTITY,
        LOWER(TRIM(COMPANIES)) AS COMPANIES
    FROM JOB_PORTAL.RAW.raw_transaction
        );
[0m10:46:49.877018 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:46:51.814689 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafedc-0004-bb9d-0005-d15300011a52
[0m10:46:51.814689 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000939 (22023): SQL compilation error: error line 7 at position 8
too many arguments for function [TO_DATE(RAW_TRANSACTION.PAYMENT_MONTH, 'MM/DD/YYYY')] expected 1, got 2
[0m10:46:51.828773 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_transaction (execute): 10:46:49.843616 => 10:46:51.828773
[0m10:46:51.828773 [debug] [Thread-1 (]: On model.mini_project.prep_transaction: Close
[0m10:46:52.505644 [debug] [Thread-1 (]: Database Error in model prep_transaction (models\prep\prep_transaction.sql)
  000939 (22023): SQL compilation error: error line 7 at position 8
  too many arguments for function [TO_DATE(RAW_TRANSACTION.PAYMENT_MONTH, 'MM/DD/YYYY')] expected 1, got 2
  compiled Code at target\run\mini_project\models\prep\prep_transaction.sql
[0m10:46:52.505644 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b435924-c17e-44dd-b856-c27e1e385a78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002747E00FD70>]}
[0m10:46:52.505644 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model JOB_PORTAL.PREP.prep_transaction ......... [[31mERROR[0m in 2.68s]
[0m10:46:52.505644 [debug] [Thread-1 (]: Finished running node model.mini_project.prep_transaction
[0m10:46:52.505644 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:46:52.505644 [debug] [MainThread]: Connection 'list_JOB_PORTAL' was properly closed.
[0m10:46:52.505644 [debug] [MainThread]: Connection 'list_JOB_PORTAL_MART' was properly closed.
[0m10:46:52.505644 [debug] [MainThread]: Connection 'list_JOB_PORTAL_RAW' was properly closed.
[0m10:46:52.505644 [debug] [MainThread]: Connection 'model.mini_project.prep_transaction' was properly closed.
[0m10:46:52.505644 [info ] [MainThread]: 
[0m10:46:52.505644 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.43 seconds (10.43s).
[0m10:46:52.516632 [debug] [MainThread]: Command end result
[0m10:46:52.527643 [info ] [MainThread]: 
[0m10:46:52.528655 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:46:52.530539 [info ] [MainThread]: 
[0m10:46:52.531560 [error] [MainThread]:   Database Error in model prep_transaction (models\prep\prep_transaction.sql)
  000939 (22023): SQL compilation error: error line 7 at position 8
  too many arguments for function [TO_DATE(RAW_TRANSACTION.PAYMENT_MONTH, 'MM/DD/YYYY')] expected 1, got 2
  compiled Code at target\run\mini_project\models\prep\prep_transaction.sql
[0m10:46:52.532548 [info ] [MainThread]: 
[0m10:46:52.532548 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:46:52.534579 [debug] [MainThread]: Command `dbt run` failed at 10:46:52.533584 after 12.69 seconds
[0m10:46:52.534579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002747CA40620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002747DB40EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002747DBE2D50>]}
[0m10:46:52.534579 [debug] [MainThread]: Flushing usage events
[0m13:53:12.786502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DC0A09370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DC0A096A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DC0A08FE0>]}


============================== 13:53:12.792490 | 01595ce0-cb88-42a6-8a7f-ed29899880aa ==============================
[0m13:53:12.792490 [info ] [MainThread]: Running with dbt=1.7.19
[0m13:53:12.793512 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'c:\\Users\\DasariUday\\venv\\.venv\\mini_project\\logs', 'profiles_dir': 'C:\\Users\\DasariUday\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:53:12.902233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01595ce0-cb88-42a6-8a7f-ed29899880aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DC0A871D0>]}
[0m13:53:12.904140 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:53:12.906147 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:53:12.907146 [debug] [MainThread]: Command `cli deps` succeeded at 13:53:12.907146 after 0.26 seconds
[0m13:53:12.907146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DC0A670E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DC0A871D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DC0A841A0>]}
[0m13:53:12.908179 [debug] [MainThread]: Flushing usage events
[0m14:29:44.771026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022ACDFE4CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022ACDFE59D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022ACDFE5EE0>]}


============================== 14:29:44.771026 | 7eca3526-9201-403e-9ecb-8e1729a2205a ==============================
[0m14:29:44.771026 [info ] [MainThread]: Running with dbt=1.7.19
[0m14:29:44.786892 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\DasariUday\\venv\\.venv\\mini_project\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\DasariUday\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m14:29:44.895491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7eca3526-9201-403e-9ecb-8e1729a2205a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022ACE0871A0>]}
[0m14:29:44.897239 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:29:44.897239 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:29:44.902874 [debug] [MainThread]: Command `cli deps` succeeded at 14:29:44.897239 after 0.26 seconds
[0m14:29:44.902874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022ACE036A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022ACDFE7380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022ACDFE7410>]}
[0m14:29:44.902874 [debug] [MainThread]: Flushing usage events
[0m14:31:43.849837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239324394F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023932439220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239324392B0>]}


============================== 14:31:43.854099 | 145458fa-b8c2-4d67-a673-4bd5a2cdee1d ==============================
[0m14:31:43.854099 [info ] [MainThread]: Running with dbt=1.7.19
[0m14:31:43.855098 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\DasariUday\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'c:\\Users\\DasariUday\\venv\\.venv\\mini_project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m14:31:43.960102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '145458fa-b8c2-4d67-a673-4bd5a2cdee1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023932218680>]}
[0m14:31:43.961103 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:31:43.963078 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:31:43.964070 [debug] [MainThread]: Command `cli deps` succeeded at 14:31:43.964070 after 0.24 seconds
[0m14:31:43.965104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239324392B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239324B6A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023932094E30>]}
[0m14:31:43.965104 [debug] [MainThread]: Flushing usage events
[0m14:35:32.430180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE0FA18F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE0FA19280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE0FA19220>]}


============================== 14:35:32.446222 | 23337ad6-9de6-4f4d-acfa-853fed305018 ==============================
[0m14:35:32.446222 [info ] [MainThread]: Running with dbt=1.7.19
[0m14:35:32.446222 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\DasariUday\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'c:\\Users\\DasariUday\\venv\\.venv\\mini_project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:35:32.557132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23337ad6-9de6-4f4d-acfa-853fed305018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE0FA77770>]}
[0m14:35:32.557132 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:35:32.557132 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:35:32.557132 [debug] [MainThread]: Command `cli deps` succeeded at 14:35:32.557132 after 0.26 seconds
[0m14:35:32.557132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE0FA18C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE0FA18F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE0CADF8F0>]}
[0m14:35:32.557132 [debug] [MainThread]: Flushing usage events
[0m14:38:19.145989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8B7B793D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8B7B792B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8B7B78F80>]}


============================== 14:38:19.151014 | 2442710d-f306-47e7-bef1-806f862dba82 ==============================
[0m14:38:19.151014 [info ] [MainThread]: Running with dbt=1.7.19
[0m14:38:19.151014 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\DasariUday\\.dbt', 'log_path': 'c:\\Users\\DasariUday\\venv\\.venv\\mini_project\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:38:19.262331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2442710d-f306-47e7-bef1-806f862dba82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8B7B79790>]}
[0m14:38:19.264336 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:38:19.266345 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:38:19.266345 [debug] [MainThread]: Command `cli deps` succeeded at 14:38:19.266345 after 0.26 seconds
[0m14:38:19.266345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8B7B79A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8B7B790D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8B7B78D70>]}
[0m14:38:19.266345 [debug] [MainThread]: Flushing usage events
[0m15:48:57.684830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDEF4B4C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDEF4B4F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDEF4B4E30>]}


============================== 15:48:57.700842 | ef30dd32-a283-47e0-9d4c-359def54c30b ==============================
[0m15:48:57.700842 [info ] [MainThread]: Running with dbt=1.7.19
[0m15:48:57.700842 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\DasariUday\\venv\\.venv\\mini_project\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\DasariUday\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:48:58.217906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef30dd32-a283-47e0-9d4c-359def54c30b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDF02A2EA0>]}
[0m15:48:58.281069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef30dd32-a283-47e0-9d4c-359def54c30b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDEE546C30>]}
[0m15:48:58.283544 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m15:48:58.301462 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m15:48:59.585235 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:48:59.585235 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:48:59.585235 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project.mart
[0m15:48:59.595623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef30dd32-a283-47e0-9d4c-359def54c30b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDF02A18E0>]}
[0m15:48:59.637703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef30dd32-a283-47e0-9d4c-359def54c30b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDF13E5130>]}
[0m15:48:59.638703 [info ] [MainThread]: Found 11 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m15:48:59.638703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef30dd32-a283-47e0-9d4c-359def54c30b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDEF4B5820>]}
[0m15:48:59.641702 [info ] [MainThread]: 
[0m15:48:59.642702 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:48:59.644704 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL'
[0m15:48:59.657601 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL"
[0m15:48:59.658602 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL'
[0m15:48:59.659568 [debug] [ThreadPool]: On list_JOB_PORTAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL"} */
show terse schemas in database JOB_PORTAL
    limit 10000
[0m15:48:59.661887 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL"
[0m15:48:59.661887 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:59.663031 [debug] [ThreadPool]: On list_JOB_PORTAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL"} */
show terse schemas in database JOB_PORTAL
    limit 10000
[0m15:48:59.663375 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:01.881641 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m15:49:01.883646 [debug] [ThreadPool]: On list_JOB_PORTAL: Close
[0m15:49:01.931661 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m15:49:01.937752 [debug] [ThreadPool]: On list_JOB_PORTAL: Close
[0m15:49:02.588583 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m15:49:02.598719 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL_PREP'
[0m15:49:02.597413 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m15:49:02.601666 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_PREP"
[0m15:49:02.601666 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show terse objects in MINI_PROJECT.RAW limit 10000
[0m15:49:02.602664 [debug] [ThreadPool]: On list_JOB_PORTAL_PREP: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_PREP"} */
show terse objects in JOB_PORTAL.PREP limit 10000
[0m15:49:02.603286 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:02.603286 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:04.434622 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m15:49:04.434622 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: Close
[0m15:49:04.449003 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m15:49:04.449003 [debug] [ThreadPool]: On list_JOB_PORTAL_PREP: Close
[0m15:49:05.095267 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_RAW, now list_JOB_PORTAL_RAW)
[0m15:49:05.095267 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_RAW"
[0m15:49:05.095267 [debug] [ThreadPool]: On list_JOB_PORTAL_RAW: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_RAW"} */
show terse objects in JOB_PORTAL.RAW limit 10000
[0m15:49:05.095267 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:49:06.885520 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.0 seconds
[0m15:49:06.891370 [debug] [ThreadPool]: On list_JOB_PORTAL_RAW: Close
[0m15:49:07.538127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef30dd32-a283-47e0-9d4c-359def54c30b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDEEBE2120>]}
[0m15:49:07.538127 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:49:07.538127 [info ] [MainThread]: 
[0m15:49:07.553991 [debug] [Thread-2 (]: Began running node model.mini_project.raw_products
[0m15:49:07.538127 [debug] [Thread-1 (]: Began running node model.mini_project.raw_customers
[0m15:49:07.555168 [info ] [Thread-2 (]: 2 of 11 START sql table model JOB_PORTAL.RAW.raw_products ...................... [RUN]
[0m15:49:07.556109 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.mini_project.raw_products'
[0m15:49:07.555168 [info ] [Thread-1 (]: 1 of 11 START sql table model JOB_PORTAL.RAW.raw_customers ..................... [RUN]
[0m15:49:07.557201 [debug] [Thread-2 (]: Began compiling node model.mini_project.raw_products
[0m15:49:07.558700 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project.raw_customers'
[0m15:49:07.568235 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.raw_products"
[0m15:49:07.568235 [debug] [Thread-1 (]: Began compiling node model.mini_project.raw_customers
[0m15:49:07.572315 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.raw_customers"
[0m15:49:07.574315 [debug] [Thread-2 (]: Timing info for model.mini_project.raw_products (compile): 15:49:07.558700 => 15:49:07.574315
[0m15:49:07.575318 [debug] [Thread-2 (]: Began executing node model.mini_project.raw_products
[0m15:49:07.575767 [debug] [Thread-1 (]: Timing info for model.mini_project.raw_customers (compile): 15:49:07.569213 => 15:49:07.575767
[0m15:49:07.604998 [debug] [Thread-1 (]: Began executing node model.mini_project.raw_customers
[0m15:49:07.604998 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.raw_customers"
[0m15:49:07.621687 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.raw_products"
[0m15:49:07.623687 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.raw_products"
[0m15:49:07.623687 [debug] [Thread-2 (]: On model.mini_project.raw_products: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.raw_products"} */
create or replace transient table JOB_PORTAL.RAW.raw_products
         as
        (
SELECT 
     *
FROM 
     MINI_PROJECT.RAW.Products 
     WHERE PRODUCT_ID 
           IS NOT NULL
        );
[0m15:49:07.624723 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:49:07.626686 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.raw_customers"
[0m15:49:07.626686 [debug] [Thread-1 (]: On model.mini_project.raw_customers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.raw_customers"} */
create or replace transient table JOB_PORTAL.RAW.raw_customers
         as
        (
SELECT 
    * 
FROM 
    MINI_PROJECT.RAW.Customers 
    WHERE CUSTOMER_ID 
          IS NOT NULL
        );
[0m15:49:07.627685 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:49:10.304032 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m15:49:10.319920 [debug] [Thread-1 (]: Timing info for model.mini_project.raw_customers (execute): 15:49:07.604998 => 15:49:10.319920
[0m15:49:10.319920 [debug] [Thread-1 (]: On model.mini_project.raw_customers: Close
[0m15:49:10.319920 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m15:49:10.335772 [debug] [Thread-2 (]: Timing info for model.mini_project.raw_products (execute): 15:49:07.576935 => 15:49:10.335772
[0m15:49:10.335772 [debug] [Thread-2 (]: On model.mini_project.raw_products: Close
[0m15:49:10.967215 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef30dd32-a283-47e0-9d4c-359def54c30b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDF174B110>]}
[0m15:49:10.967215 [info ] [Thread-2 (]: 2 of 11 OK created sql table model JOB_PORTAL.RAW.raw_products ................. [[32mSUCCESS 1[0m in 3.41s]
[0m15:49:10.983152 [debug] [Thread-2 (]: Finished running node model.mini_project.raw_products
[0m15:49:10.983152 [debug] [Thread-2 (]: Began running node model.mini_project.raw_transaction
[0m15:49:10.983152 [info ] [Thread-2 (]: 3 of 11 START sql table model JOB_PORTAL.RAW.raw_transaction ................... [RUN]
[0m15:49:10.983152 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mini_project.raw_products, now model.mini_project.raw_transaction)
[0m15:49:10.983152 [debug] [Thread-2 (]: Began compiling node model.mini_project.raw_transaction
[0m15:49:10.983152 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.raw_transaction"
[0m15:49:10.983152 [debug] [Thread-2 (]: Timing info for model.mini_project.raw_transaction (compile): 15:49:10.983152 => 15:49:10.983152
[0m15:49:10.983152 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef30dd32-a283-47e0-9d4c-359def54c30b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDF171BEC0>]}
[0m15:49:10.983152 [debug] [Thread-2 (]: Began executing node model.mini_project.raw_transaction
[0m15:49:10.983152 [info ] [Thread-1 (]: 1 of 11 OK created sql table model JOB_PORTAL.RAW.raw_customers ................ [[32mSUCCESS 1[0m in 3.43s]
[0m15:49:10.996718 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.raw_transaction"
[0m15:49:10.997794 [debug] [Thread-1 (]: Finished running node model.mini_project.raw_customers
[0m15:49:10.998777 [debug] [Thread-1 (]: Began running node model.mini_project.prep_products
[0m15:49:10.999860 [info ] [Thread-1 (]: 4 of 11 START sql table model JOB_PORTAL.PREP.prep_products .................... [RUN]
[0m15:49:11.000860 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.raw_transaction"
[0m15:49:11.001826 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.raw_customers, now model.mini_project.prep_products)
[0m15:49:11.001826 [debug] [Thread-2 (]: On model.mini_project.raw_transaction: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.raw_transaction"} */
create or replace transient table JOB_PORTAL.RAW.raw_transaction
         as
        (
SELECT 
     *
FROM 
    MINI_PROJECT.RAW.Transaction 
    WHERE CUSTOMER_ID 
          IS NOT NULL
        );
[0m15:49:11.003137 [debug] [Thread-1 (]: Began compiling node model.mini_project.prep_products
[0m15:49:11.003885 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:49:11.007398 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.prep_products"
[0m15:49:11.010391 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_products (compile): 15:49:11.004385 => 15:49:11.010391
[0m15:49:11.011392 [debug] [Thread-1 (]: Began executing node model.mini_project.prep_products
[0m15:49:11.012394 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.prep_products"
[0m15:49:11.012394 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.prep_products"
[0m15:49:11.012394 [debug] [Thread-1 (]: On model.mini_project.prep_products: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.prep_products"} */
create or replace transient table JOB_PORTAL.PREP.prep_products
         as
        (
SELECT 
    PRODUCT_ID::VARCHAR AS PRODUCT_ID,
    LOWER(TRIM(PRODUCT_FAMILY)) AS PRODUCT_FAMILY,
    LOWER(TRIM(PRODUCT_SUB_FAMILY)) AS PRODUCT_SUB_FAMILY
FROM JOB_PORTAL.RAW.raw_products
        );
[0m15:49:11.017725 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:49:14.201844 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m15:49:14.201844 [debug] [Thread-2 (]: Timing info for model.mini_project.raw_transaction (execute): 15:49:10.983152 => 15:49:14.201844
[0m15:49:14.201844 [debug] [Thread-2 (]: On model.mini_project.raw_transaction: Close
[0m15:49:14.487653 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m15:49:14.489653 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_products (execute): 15:49:11.011392 => 15:49:14.489653
[0m15:49:14.490653 [debug] [Thread-1 (]: On model.mini_project.prep_products: Close
[0m15:49:14.868360 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef30dd32-a283-47e0-9d4c-359def54c30b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDF1846630>]}
[0m15:49:14.868360 [info ] [Thread-2 (]: 3 of 11 OK created sql table model JOB_PORTAL.RAW.raw_transaction .............. [[32mSUCCESS 1[0m in 3.89s]
[0m15:49:14.881537 [debug] [Thread-2 (]: Finished running node model.mini_project.raw_transaction
[0m15:49:14.881537 [debug] [Thread-2 (]: Began running node model.mini_project.prep_customers
[0m15:49:14.881537 [info ] [Thread-2 (]: 5 of 11 START sql table model JOB_PORTAL.PREP.prep_customers ................... [RUN]
[0m15:49:14.881537 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mini_project.raw_transaction, now model.mini_project.prep_customers)
[0m15:49:14.888232 [debug] [Thread-2 (]: Began compiling node model.mini_project.prep_customers
[0m15:49:14.891127 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.prep_customers"
[0m15:49:14.893229 [debug] [Thread-2 (]: Timing info for model.mini_project.prep_customers (compile): 15:49:14.888232 => 15:49:14.892476
[0m15:49:14.893825 [debug] [Thread-2 (]: Began executing node model.mini_project.prep_customers
[0m15:49:14.895680 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.prep_customers"
[0m15:49:14.895680 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.prep_customers"
[0m15:49:14.895680 [debug] [Thread-2 (]: On model.mini_project.prep_customers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.prep_customers"} */
create or replace transient table JOB_PORTAL.PREP.prep_customers
         as
        (
SELECT DISTINCT
    LOWER(TRIM(COMPANY)) AS COMPANY,
    CUSTOMER_ID::NUMBER AS CUSTOMER_ID,
    LOWER(
        REGEXP_REPLACE(
            TRIM(REGEXP_SUBSTR(CUSTOMERNAME, '^[^(]+')), 
            ',', 
            ''
        )
    ) AS CUSTOMERNAME,  --  name without commas
    
FROM JOB_PORTAL.RAW.raw_customers
        );
[0m15:49:14.895680 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:49:15.123742 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef30dd32-a283-47e0-9d4c-359def54c30b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDF18295B0>]}
[0m15:49:15.123742 [info ] [Thread-1 (]: 4 of 11 OK created sql table model JOB_PORTAL.PREP.prep_products ............... [[32mSUCCESS 1[0m in 4.12s]
[0m15:49:15.123742 [debug] [Thread-1 (]: Finished running node model.mini_project.prep_products
[0m15:49:15.123742 [debug] [Thread-1 (]: Began running node model.mini_project.prep_transaction
[0m15:49:15.123742 [info ] [Thread-1 (]: 6 of 11 START sql table model JOB_PORTAL.PREP.prep_transaction ................. [RUN]
[0m15:49:15.123742 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.prep_products, now model.mini_project.prep_transaction)
[0m15:49:15.123742 [debug] [Thread-1 (]: Began compiling node model.mini_project.prep_transaction
[0m15:49:15.139802 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.prep_transaction"
[0m15:49:15.141932 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_transaction (compile): 15:49:15.123742 => 15:49:15.141932
[0m15:49:15.142887 [debug] [Thread-1 (]: Began executing node model.mini_project.prep_transaction
[0m15:49:15.146003 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.prep_transaction"
[0m15:49:15.146003 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.prep_transaction"
[0m15:49:15.146003 [debug] [Thread-1 (]: On model.mini_project.prep_transaction: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.prep_transaction"} */
create or replace transient table JOB_PORTAL.PREP.prep_transaction
         as
        (
    SELECT DISTINCT
        CUSTOMER_ID::NUMBER AS CUSTOMER_ID,
        PRODUCT_ID::VARCHAR AS PRODUCT_ID,
        TO_DATE(PAYMENT_MONTH) AS PAYMENT_MONTH,
        REVENUE_TYPE::NUMBER AS REVENUE_TYPE,
        REVENUE::NUMBER(38,2) AS REVENUE,
        QUANTITY::NUMBER AS QUANTITY,
        LOWER(TRIM(COMPANIES)) AS COMPANIES
    FROM JOB_PORTAL.RAW.raw_transaction
        );
[0m15:49:15.146003 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:49:17.763621 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m15:49:17.776414 [debug] [Thread-2 (]: Timing info for model.mini_project.prep_customers (execute): 15:49:14.894835 => 15:49:17.776414
[0m15:49:17.776414 [debug] [Thread-2 (]: On model.mini_project.prep_customers: Close
[0m15:49:17.957451 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m15:49:17.957451 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_transaction (execute): 15:49:15.142887 => 15:49:17.957451
[0m15:49:17.957451 [debug] [Thread-1 (]: On model.mini_project.prep_transaction: Close
[0m15:49:18.438773 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef30dd32-a283-47e0-9d4c-359def54c30b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDF1844E00>]}
[0m15:49:18.438773 [info ] [Thread-2 (]: 5 of 11 OK created sql table model JOB_PORTAL.PREP.prep_customers .............. [[32mSUCCESS 1[0m in 3.56s]
[0m15:49:18.438773 [debug] [Thread-2 (]: Finished running node model.mini_project.prep_customers
[0m15:49:18.861770 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef30dd32-a283-47e0-9d4c-359def54c30b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDF1823C20>]}
[0m15:49:18.861770 [info ] [Thread-1 (]: 6 of 11 OK created sql table model JOB_PORTAL.PREP.prep_transaction ............ [[32mSUCCESS 1[0m in 3.74s]
[0m15:49:18.861770 [debug] [Thread-1 (]: Finished running node model.mini_project.prep_transaction
[0m15:49:18.861770 [debug] [Thread-2 (]: Began running node model.mini_project.kpi1
[0m15:49:18.861770 [debug] [Thread-1 (]: Began running node model.mini_project.kpi5
[0m15:49:18.861770 [info ] [Thread-2 (]: 7 of 11 START sql table model JOB_PORTAL.RAW.kpi1 .............................. [RUN]
[0m15:49:18.861770 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mini_project.prep_customers, now model.mini_project.kpi1)
[0m15:49:18.861770 [debug] [Thread-2 (]: Began compiling node model.mini_project.kpi1
[0m15:49:18.861770 [info ] [Thread-1 (]: 8 of 11 START sql table model JOB_PORTAL.RAW.kpi5 .............................. [RUN]
[0m15:49:18.861770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.prep_transaction, now model.mini_project.kpi5)
[0m15:49:18.861770 [debug] [Thread-1 (]: Began compiling node model.mini_project.kpi5
[0m15:49:18.873000 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.kpi5"
[0m15:49:18.875513 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.kpi1"
[0m15:49:18.877751 [debug] [Thread-2 (]: Timing info for model.mini_project.kpi1 (compile): 15:49:18.861770 => 15:49:18.876740
[0m15:49:18.877751 [debug] [Thread-1 (]: Timing info for model.mini_project.kpi5 (compile): 15:49:18.861770 => 15:49:18.877751
[0m15:49:18.878622 [debug] [Thread-2 (]: Began executing node model.mini_project.kpi1
[0m15:49:18.878622 [debug] [Thread-1 (]: Began executing node model.mini_project.kpi5
[0m15:49:18.882972 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.kpi1"
[0m15:49:18.885980 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.kpi5"
[0m15:49:18.887979 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.kpi1"
[0m15:49:18.887979 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.kpi5"
[0m15:49:18.887979 [debug] [Thread-2 (]: On model.mini_project.kpi1: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.kpi1"} */
create or replace transient table JOB_PORTAL.RAW.kpi1
         as
        (WITH
  CTE_1 AS (
    SELECT
      MAX(PAYMENT_MONTH) AS EOP
    FROM
      JOB_PORTAL.PREP.prep_transaction
  ),
  CTE_2 AS (
    SELECT
      *
    FROM
      JOB_PORTAL.PREP.prep_transaction
      INNER JOIN CTE_1 AS CT ON 1 = 1
  ),
  CTE_3 AS (
    SELECT
      CUSTOMER_ID,
      MAX(PAYMENT_MONTH) AS LATEST,
      MIN(PAYMENT_MONTH) AS FIRST,
      DATEADD (MONTH, -3, EOP) AS L3M,
      EOP,
      CASE
        WHEN (FIRST <= L3M) THEN 0
        ELSE 1
      END AS IS_NEW,
      CASE
        WHEN (
          FIRST <= L3M
          AND LATEST < EOP
        ) THEN 1
        ELSE 0
      END AS IS_CHURN
    FROM
      CTE_2
    GROUP BY
      CUSTOMER_ID,
      EOP
  )
SELECT
  SUM(IS_CHURN) AS CHURNED_CUSTOMERS,
  SUM(IS_NEW) AS NEW_CUSTOMERS,
  EOP
FROM
  CTE_3
GROUP BY
  EOP
        );
[0m15:49:18.887979 [debug] [Thread-1 (]: On model.mini_project.kpi5: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.kpi5"} */
create or replace transient table JOB_PORTAL.RAW.kpi5
         as
        (WITH CTE_1 AS(
  SELECT 
    CUSTOMER_ID, 
    MIN(PAYMENT_MONTH) AS FIRST_MONTH 
  FROM 
    JOB_PORTAL.PREP.prep_transaction 
  GROUP BY 
    CUSTOMER_ID
) 
SELECT 
  DISTINCT DATE_TRUNC('YEAR', FIRST_MONTH) AS FISCAL_YEAR, 
  (
    COUNT(CUSTOMER_ID)
  ) AS NEW_CUSTOMERS 
FROM 
  CTE_1 
GROUP BY 
  FISCAL_YEAR
        );
[0m15:49:18.887979 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:49:18.887979 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:49:21.512984 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m15:49:21.512984 [debug] [Thread-2 (]: Timing info for model.mini_project.kpi1 (execute): 15:49:18.879663 => 15:49:21.512984
[0m15:49:21.512984 [debug] [Thread-2 (]: On model.mini_project.kpi1: Close
[0m15:49:21.512984 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m15:49:21.523681 [debug] [Thread-1 (]: Timing info for model.mini_project.kpi5 (execute): 15:49:18.883980 => 15:49:21.523681
[0m15:49:21.523681 [debug] [Thread-1 (]: On model.mini_project.kpi5: Close
[0m15:49:22.178555 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef30dd32-a283-47e0-9d4c-359def54c30b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDF1709EB0>]}
[0m15:49:22.178555 [info ] [Thread-2 (]: 7 of 11 OK created sql table model JOB_PORTAL.RAW.kpi1 ......................... [[32mSUCCESS 1[0m in 3.32s]
[0m15:49:22.180433 [debug] [Thread-2 (]: Finished running node model.mini_project.kpi1
[0m15:49:22.180433 [debug] [Thread-2 (]: Began running node model.mini_project.kpi6
[0m15:49:22.180433 [info ] [Thread-2 (]: 9 of 11 START sql table model JOB_PORTAL.RAW.kpi6 .............................. [RUN]
[0m15:49:22.180433 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mini_project.kpi1, now model.mini_project.kpi6)
[0m15:49:22.180433 [debug] [Thread-2 (]: Began compiling node model.mini_project.kpi6
[0m15:49:22.180433 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.kpi6"
[0m15:49:22.180433 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef30dd32-a283-47e0-9d4c-359def54c30b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDF1862CC0>]}
[0m15:49:22.180433 [debug] [Thread-2 (]: Timing info for model.mini_project.kpi6 (compile): 15:49:22.180433 => 15:49:22.180433
[0m15:49:22.180433 [debug] [Thread-2 (]: Began executing node model.mini_project.kpi6
[0m15:49:22.180433 [info ] [Thread-1 (]: 8 of 11 OK created sql table model JOB_PORTAL.RAW.kpi5 ......................... [[32mSUCCESS 1[0m in 3.32s]
[0m15:49:22.246464 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.kpi6"
[0m15:49:22.247695 [debug] [Thread-1 (]: Finished running node model.mini_project.kpi5
[0m15:49:22.248537 [debug] [Thread-1 (]: Began running node model.mini_project.kpi7
[0m15:49:22.249578 [info ] [Thread-1 (]: 10 of 11 START sql table model JOB_PORTAL.RAW.kpi7 ............................. [RUN]
[0m15:49:22.250545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.kpi5, now model.mini_project.kpi7)
[0m15:49:22.251378 [debug] [Thread-1 (]: Began compiling node model.mini_project.kpi7
[0m15:49:22.254508 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.kpi7"
[0m15:49:22.256474 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.kpi6"
[0m15:49:22.256474 [debug] [Thread-2 (]: On model.mini_project.kpi6: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.kpi6"} */
create or replace transient table JOB_PORTAL.RAW.kpi6
         as
        (with
  cte_1 as (
    select
      product_id,
      sum(revenue) as revenue
    from
      JOB_PORTAL.PREP.prep_transaction
    where
      revenue_type = 1
    group by
      product_id
  ),
  cte_2 as (
    select
      product_id,
      revenue,
      dense_rank() over (
        order by
          revenue desc
      )
    from
      cte_1
  )
select
  *
from
  cte_2;
[0m15:49:22.257473 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:49:22.259473 [debug] [Thread-1 (]: Timing info for model.mini_project.kpi7 (compile): 15:49:22.251378 => 15:49:22.259473
[0m15:49:22.260507 [debug] [Thread-1 (]: Began executing node model.mini_project.kpi7
[0m15:49:22.263506 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.kpi7"
[0m15:49:22.264945 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.kpi7"
[0m15:49:22.265952 [debug] [Thread-1 (]: On model.mini_project.kpi7: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.kpi7"} */
create or replace transient table JOB_PORTAL.RAW.kpi7
         as
        (with
  cte_1 as (
    select
      customer_id,
      sum(revenue) as revenue
    from
      JOB_PORTAL.PREP.prep_transaction
    where
      revenue_type = 1
    group by
      customer_id
  ),
  cte_2 as (
    select
      customer_id,
      revenue,
      dense_rank() over (
        order by
          revenue desc
      )
    from
      cte_1
  )
select
  *
from
  cte_2;
[0m15:49:22.265952 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:49:24.177478 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01bb000b-0004-bb9f-0005-d15300013fd6
[0m15:49:24.177478 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 29 at position 7 unexpected ';'.
[0m15:49:24.179709 [debug] [Thread-2 (]: Timing info for model.mini_project.kpi6 (execute): 15:49:22.192538 => 15:49:24.179709
[0m15:49:24.179709 [debug] [Thread-2 (]: On model.mini_project.kpi6: Close
[0m15:49:24.305031 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb000b-0004-bded-0005-d15300016f12
[0m15:49:24.305031 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 29 at position 7 unexpected ';'.
[0m15:49:24.305031 [debug] [Thread-1 (]: Timing info for model.mini_project.kpi7 (execute): 15:49:22.260507 => 15:49:24.305031
[0m15:49:24.305031 [debug] [Thread-1 (]: On model.mini_project.kpi7: Close
[0m15:49:24.827575 [debug] [Thread-2 (]: Database Error in model kpi6 (models\crb\kpi6.sql)
  001003 (42000): SQL compilation error:
  syntax error line 29 at position 7 unexpected ';'.
  compiled Code at target\run\mini_project\models\crb\kpi6.sql
[0m15:49:24.827575 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef30dd32-a283-47e0-9d4c-359def54c30b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDF152AC00>]}
[0m15:49:24.827575 [error] [Thread-2 (]: 9 of 11 ERROR creating sql table model JOB_PORTAL.RAW.kpi6 ..................... [[31mERROR[0m in 2.65s]
[0m15:49:24.827575 [debug] [Thread-2 (]: Finished running node model.mini_project.kpi6
[0m15:49:24.827575 [debug] [Thread-2 (]: Began running node model.mini_project.prep_fulldata
[0m15:49:24.827575 [info ] [Thread-2 (]: 11 of 11 START sql table model JOB_PORTAL.PREP.prep_fulldata ................... [RUN]
[0m15:49:24.827575 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mini_project.kpi6, now model.mini_project.prep_fulldata)
[0m15:49:24.827575 [debug] [Thread-2 (]: Began compiling node model.mini_project.prep_fulldata
[0m15:49:24.844524 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.prep_fulldata"
[0m15:49:24.847328 [debug] [Thread-2 (]: Timing info for model.mini_project.prep_fulldata (compile): 15:49:24.827575 => 15:49:24.846264
[0m15:49:24.847328 [debug] [Thread-2 (]: Began executing node model.mini_project.prep_fulldata
[0m15:49:24.849648 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.prep_fulldata"
[0m15:49:24.853715 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.prep_fulldata"
[0m15:49:24.854740 [debug] [Thread-2 (]: On model.mini_project.prep_fulldata: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.prep_fulldata"} */
create or replace transient table JOB_PORTAL.PREP.prep_fulldata
         as
        (
WITH CTE_1 AS(
    SELECT DISTINCT
        ST.CUSTOMER_ID,
        ST.PRODUCT_ID,
        ST.PAYMENT_MONTH,
        ST.REVENUE,
        ST.REVENUE_TYPE,
        ST.QUANTITY,
        CUST.COMPANY AS CUSTOMER_COMPANY,
        CUST.CUSTOMERNAME AS CUSTOMER_NAME,
        PROD.PRODUCT_FAMILY,
        PROD.PRODUCT_SUB_FAMILY
    FROM JOB_PORTAL.PREP.prep_transaction ST
    LEFT JOIN JOB_PORTAL.PREP.prep_customers CUST ON ST.CUSTOMER_ID = CUST.CUSTOMER_ID
    LEFT JOIN JOB_PORTAL.PREP.prep_products PROD ON ST.PRODUCT_ID = PROD.PRODUCT_ID
)
SELECT
     *
FROM
    CTE_1
    WHERE REVENUE_TYPE = 1
        );
[0m15:49:24.855438 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:49:24.987268 [debug] [Thread-1 (]: Database Error in model kpi7 (models\crb\kpi7.sql)
  001003 (42000): SQL compilation error:
  syntax error line 29 at position 7 unexpected ';'.
  compiled Code at target\run\mini_project\models\crb\kpi7.sql
[0m15:49:24.987268 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef30dd32-a283-47e0-9d4c-359def54c30b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDF1879430>]}
[0m15:49:24.987268 [error] [Thread-1 (]: 10 of 11 ERROR creating sql table model JOB_PORTAL.RAW.kpi7 .................... [[31mERROR[0m in 2.74s]
[0m15:49:24.987268 [debug] [Thread-1 (]: Finished running node model.mini_project.kpi7
[0m15:49:27.828233 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m15:49:27.830243 [debug] [Thread-2 (]: Timing info for model.mini_project.prep_fulldata (execute): 15:49:24.847328 => 15:49:27.830243
[0m15:49:27.830243 [debug] [Thread-2 (]: On model.mini_project.prep_fulldata: Close
[0m15:49:28.474788 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef30dd32-a283-47e0-9d4c-359def54c30b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDF152A6F0>]}
[0m15:49:28.474788 [info ] [Thread-2 (]: 11 of 11 OK created sql table model JOB_PORTAL.PREP.prep_fulldata .............. [[32mSUCCESS 1[0m in 3.65s]
[0m15:49:28.474788 [debug] [Thread-2 (]: Finished running node model.mini_project.prep_fulldata
[0m15:49:28.474788 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:49:28.482946 [debug] [MainThread]: Connection 'list_JOB_PORTAL' was properly closed.
[0m15:49:28.482946 [debug] [MainThread]: Connection 'list_JOB_PORTAL' was properly closed.
[0m15:49:28.482946 [debug] [MainThread]: Connection 'list_JOB_PORTAL_RAW' was properly closed.
[0m15:49:28.484958 [debug] [MainThread]: Connection 'list_JOB_PORTAL_PREP' was properly closed.
[0m15:49:28.484958 [debug] [MainThread]: Connection 'model.mini_project.prep_fulldata' was properly closed.
[0m15:49:28.484958 [debug] [MainThread]: Connection 'model.mini_project.kpi7' was properly closed.
[0m15:49:28.486968 [info ] [MainThread]: 
[0m15:49:28.486968 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 28.84 seconds (28.84s).
[0m15:49:28.492510 [debug] [MainThread]: Command end result
[0m15:49:28.504305 [info ] [MainThread]: 
[0m15:49:28.507317 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m15:49:28.509351 [info ] [MainThread]: 
[0m15:49:28.510330 [error] [MainThread]:   Database Error in model kpi6 (models\crb\kpi6.sql)
  001003 (42000): SQL compilation error:
  syntax error line 29 at position 7 unexpected ';'.
  compiled Code at target\run\mini_project\models\crb\kpi6.sql
[0m15:49:28.511326 [info ] [MainThread]: 
[0m15:49:28.512326 [error] [MainThread]:   Database Error in model kpi7 (models\crb\kpi7.sql)
  001003 (42000): SQL compilation error:
  syntax error line 29 at position 7 unexpected ';'.
  compiled Code at target\run\mini_project\models\crb\kpi7.sql
[0m15:49:28.512326 [info ] [MainThread]: 
[0m15:49:28.513325 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=2 SKIP=0 TOTAL=11
[0m15:49:28.515164 [debug] [MainThread]: Command `dbt run` failed at 15:49:28.515164 after 31.04 seconds
[0m15:49:28.515164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDEF37EB70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDF002A1E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDF184C3B0>]}
[0m15:49:28.516260 [debug] [MainThread]: Flushing usage events
[0m15:50:02.461681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224F86AD760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224F86ADC70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224F86AD0D0>]}


============================== 15:50:02.461681 | 2f2d4144-cb20-40c9-aba5-6868ad7fbf47 ==============================
[0m15:50:02.461681 [info ] [MainThread]: Running with dbt=1.7.19
[0m15:50:02.461681 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\DasariUday\\venv\\.venv\\mini_project\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\DasariUday\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:50:02.912540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f2d4144-cb20-40c9-aba5-6868ad7fbf47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224F93C97C0>]}
[0m15:50:02.967919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f2d4144-cb20-40c9-aba5-6868ad7fbf47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224F7716990>]}
[0m15:50:02.967919 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m15:50:02.974014 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m15:50:03.062825 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:50:03.062825 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:50:03.063825 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project.mart
[0m15:50:03.069676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f2d4144-cb20-40c9-aba5-6868ad7fbf47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224FA479370>]}
[0m15:50:03.080082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f2d4144-cb20-40c9-aba5-6868ad7fbf47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224FA4E8F20>]}
[0m15:50:03.080082 [info ] [MainThread]: Found 11 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m15:50:03.080082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f2d4144-cb20-40c9-aba5-6868ad7fbf47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224F9030860>]}
[0m15:50:03.080082 [info ] [MainThread]: 
[0m15:50:03.080082 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:50:03.080082 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL'
[0m15:50:03.099214 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL"
[0m15:50:03.099214 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL'
[0m15:50:03.099214 [debug] [ThreadPool]: On list_JOB_PORTAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL"} */
show terse schemas in database JOB_PORTAL
    limit 10000
[0m15:50:03.099214 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL"
[0m15:50:03.099214 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:03.108473 [debug] [ThreadPool]: On list_JOB_PORTAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL"} */
show terse schemas in database JOB_PORTAL
    limit 10000
[0m15:50:03.109491 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:05.453198 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m15:50:05.460469 [debug] [ThreadPool]: On list_JOB_PORTAL: Close
[0m15:50:05.468949 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m15:50:05.475678 [debug] [ThreadPool]: On list_JOB_PORTAL: Close
[0m15:50:06.113619 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m15:50:06.129694 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL_RAW'
[0m15:50:06.129694 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m15:50:06.134407 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_RAW"
[0m15:50:06.134407 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show terse objects in MINI_PROJECT.RAW limit 10000
[0m15:50:06.134407 [debug] [ThreadPool]: On list_JOB_PORTAL_RAW: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_RAW"} */
show terse objects in JOB_PORTAL.RAW limit 10000
[0m15:50:06.134407 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:06.134407 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:07.907864 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m15:50:07.907864 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: Close
[0m15:50:07.907864 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m15:50:07.907864 [debug] [ThreadPool]: On list_JOB_PORTAL_RAW: Close
[0m15:50:08.547239 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_RAW, now list_JOB_PORTAL_PREP)
[0m15:50:08.547239 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_PREP"
[0m15:50:08.547239 [debug] [ThreadPool]: On list_JOB_PORTAL_PREP: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_PREP"} */
show terse objects in JOB_PORTAL.PREP limit 10000
[0m15:50:08.547239 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:50:10.406826 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.0 seconds
[0m15:50:10.406826 [debug] [ThreadPool]: On list_JOB_PORTAL_PREP: Close
[0m15:50:11.069962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f2d4144-cb20-40c9-aba5-6868ad7fbf47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224FA627F20>]}
[0m15:50:11.069962 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:50:11.069962 [info ] [MainThread]: 
[0m15:50:11.069962 [debug] [Thread-1 (]: Began running node model.mini_project.raw_customers
[0m15:50:11.069962 [debug] [Thread-2 (]: Began running node model.mini_project.raw_products
[0m15:50:11.069962 [info ] [Thread-1 (]: 1 of 11 START sql table model JOB_PORTAL.RAW.raw_customers ..................... [RUN]
[0m15:50:11.069962 [info ] [Thread-2 (]: 2 of 11 START sql table model JOB_PORTAL.RAW.raw_products ...................... [RUN]
[0m15:50:11.085189 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project.raw_customers'
[0m15:50:11.086034 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.mini_project.raw_products'
[0m15:50:11.086834 [debug] [Thread-1 (]: Began compiling node model.mini_project.raw_customers
[0m15:50:11.086834 [debug] [Thread-2 (]: Began compiling node model.mini_project.raw_products
[0m15:50:11.089949 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.raw_customers"
[0m15:50:11.098193 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.raw_products"
[0m15:50:11.100854 [debug] [Thread-1 (]: Timing info for model.mini_project.raw_customers (compile): 15:50:11.086834 => 15:50:11.099845
[0m15:50:11.101853 [debug] [Thread-1 (]: Began executing node model.mini_project.raw_customers
[0m15:50:11.118496 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.raw_customers"
[0m15:50:11.133265 [debug] [Thread-2 (]: Timing info for model.mini_project.raw_products (compile): 15:50:11.089949 => 15:50:11.118496
[0m15:50:11.133265 [debug] [Thread-2 (]: Began executing node model.mini_project.raw_products
[0m15:50:11.136305 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.raw_products"
[0m15:50:11.138608 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.raw_customers"
[0m15:50:11.138608 [debug] [Thread-1 (]: On model.mini_project.raw_customers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.raw_customers"} */
create or replace transient table JOB_PORTAL.RAW.raw_customers
         as
        (
SELECT 
    * 
FROM 
    MINI_PROJECT.RAW.Customers 
    WHERE CUSTOMER_ID 
          IS NOT NULL
        );
[0m15:50:11.139608 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:50:11.141642 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.raw_products"
[0m15:50:11.141642 [debug] [Thread-2 (]: On model.mini_project.raw_products: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.raw_products"} */
create or replace transient table JOB_PORTAL.RAW.raw_products
         as
        (
SELECT 
     *
FROM 
     MINI_PROJECT.RAW.Products 
     WHERE PRODUCT_ID 
           IS NOT NULL
        );
[0m15:50:11.141642 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:50:13.657979 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m15:50:13.673797 [debug] [Thread-2 (]: Timing info for model.mini_project.raw_products (execute): 15:50:11.133265 => 15:50:13.673797
[0m15:50:13.673797 [debug] [Thread-2 (]: On model.mini_project.raw_products: Close
[0m15:50:13.716756 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m15:50:13.722472 [debug] [Thread-1 (]: Timing info for model.mini_project.raw_customers (execute): 15:50:11.101853 => 15:50:13.722472
[0m15:50:13.722472 [debug] [Thread-1 (]: On model.mini_project.raw_customers: Close
[0m15:50:14.336800 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f2d4144-cb20-40c9-aba5-6868ad7fbf47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224FA879190>]}
[0m15:50:14.336800 [info ] [Thread-2 (]: 2 of 11 OK created sql table model JOB_PORTAL.RAW.raw_products ................. [[32mSUCCESS 1[0m in 3.25s]
[0m15:50:14.336800 [debug] [Thread-2 (]: Finished running node model.mini_project.raw_products
[0m15:50:14.336800 [debug] [Thread-2 (]: Began running node model.mini_project.raw_transaction
[0m15:50:14.336800 [info ] [Thread-2 (]: 3 of 11 START sql table model JOB_PORTAL.RAW.raw_transaction ................... [RUN]
[0m15:50:14.336800 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mini_project.raw_products, now model.mini_project.raw_transaction)
[0m15:50:14.336800 [debug] [Thread-2 (]: Began compiling node model.mini_project.raw_transaction
[0m15:50:14.349194 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.raw_transaction"
[0m15:50:14.349194 [debug] [Thread-2 (]: Timing info for model.mini_project.raw_transaction (compile): 15:50:14.336800 => 15:50:14.349194
[0m15:50:14.349194 [debug] [Thread-2 (]: Began executing node model.mini_project.raw_transaction
[0m15:50:14.353668 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.raw_transaction"
[0m15:50:14.355582 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.raw_transaction"
[0m15:50:14.355582 [debug] [Thread-2 (]: On model.mini_project.raw_transaction: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.raw_transaction"} */
create or replace transient table JOB_PORTAL.RAW.raw_transaction
         as
        (
SELECT 
     *
FROM 
    MINI_PROJECT.RAW.Transaction 
    WHERE CUSTOMER_ID 
          IS NOT NULL
        );
[0m15:50:14.356686 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:50:14.365075 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f2d4144-cb20-40c9-aba5-6868ad7fbf47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224FA86A5D0>]}
[0m15:50:14.365075 [info ] [Thread-1 (]: 1 of 11 OK created sql table model JOB_PORTAL.RAW.raw_customers ................ [[32mSUCCESS 1[0m in 3.30s]
[0m15:50:14.365075 [debug] [Thread-1 (]: Finished running node model.mini_project.raw_customers
[0m15:50:14.365075 [debug] [Thread-1 (]: Began running node model.mini_project.prep_products
[0m15:50:14.365075 [info ] [Thread-1 (]: 4 of 11 START sql table model JOB_PORTAL.PREP.prep_products .................... [RUN]
[0m15:50:14.369627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.raw_customers, now model.mini_project.prep_products)
[0m15:50:14.370637 [debug] [Thread-1 (]: Began compiling node model.mini_project.prep_products
[0m15:50:14.373632 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.prep_products"
[0m15:50:14.375635 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_products (compile): 15:50:14.370637 => 15:50:14.374633
[0m15:50:14.375635 [debug] [Thread-1 (]: Began executing node model.mini_project.prep_products
[0m15:50:14.378971 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.prep_products"
[0m15:50:14.380975 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.prep_products"
[0m15:50:14.380975 [debug] [Thread-1 (]: On model.mini_project.prep_products: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.prep_products"} */
create or replace transient table JOB_PORTAL.PREP.prep_products
         as
        (
SELECT 
    PRODUCT_ID::VARCHAR AS PRODUCT_ID,
    LOWER(TRIM(PRODUCT_FAMILY)) AS PRODUCT_FAMILY,
    LOWER(TRIM(PRODUCT_SUB_FAMILY)) AS PRODUCT_SUB_FAMILY
FROM JOB_PORTAL.RAW.raw_products
        );
[0m15:50:14.380975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:16.858760 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m15:50:16.858760 [debug] [Thread-2 (]: Timing info for model.mini_project.raw_transaction (execute): 15:50:14.351201 => 15:50:16.858760
[0m15:50:16.858760 [debug] [Thread-2 (]: On model.mini_project.raw_transaction: Close
[0m15:50:16.939494 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m15:50:16.939494 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_products (execute): 15:50:14.375635 => 15:50:16.939494
[0m15:50:16.939494 [debug] [Thread-1 (]: On model.mini_project.prep_products: Close
[0m15:50:17.506492 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f2d4144-cb20-40c9-aba5-6868ad7fbf47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224F900F680>]}
[0m15:50:17.506492 [info ] [Thread-2 (]: 3 of 11 OK created sql table model JOB_PORTAL.RAW.raw_transaction .............. [[32mSUCCESS 1[0m in 3.17s]
[0m15:50:17.506492 [debug] [Thread-2 (]: Finished running node model.mini_project.raw_transaction
[0m15:50:17.506492 [debug] [Thread-2 (]: Began running node model.mini_project.prep_customers
[0m15:50:17.506492 [info ] [Thread-2 (]: 5 of 11 START sql table model JOB_PORTAL.PREP.prep_customers ................... [RUN]
[0m15:50:17.506492 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mini_project.raw_transaction, now model.mini_project.prep_customers)
[0m15:50:17.506492 [debug] [Thread-2 (]: Began compiling node model.mini_project.prep_customers
[0m15:50:17.514047 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.prep_customers"
[0m15:50:17.514047 [debug] [Thread-2 (]: Timing info for model.mini_project.prep_customers (compile): 15:50:17.506492 => 15:50:17.514047
[0m15:50:17.516055 [debug] [Thread-2 (]: Began executing node model.mini_project.prep_customers
[0m15:50:17.518062 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.prep_customers"
[0m15:50:17.520069 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.prep_customers"
[0m15:50:17.520069 [debug] [Thread-2 (]: On model.mini_project.prep_customers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.prep_customers"} */
create or replace transient table JOB_PORTAL.PREP.prep_customers
         as
        (
SELECT DISTINCT
    LOWER(TRIM(COMPANY)) AS COMPANY,
    CUSTOMER_ID::NUMBER AS CUSTOMER_ID,
    LOWER(
        REGEXP_REPLACE(
            TRIM(REGEXP_SUBSTR(CUSTOMERNAME, '^[^(]+')), 
            ',', 
            ''
        )
    ) AS CUSTOMERNAME,  --  name without commas
    
FROM JOB_PORTAL.RAW.raw_customers
        );
[0m15:50:17.521818 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:50:17.598975 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f2d4144-cb20-40c9-aba5-6868ad7fbf47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224FA9992B0>]}
[0m15:50:17.599968 [info ] [Thread-1 (]: 4 of 11 OK created sql table model JOB_PORTAL.PREP.prep_products ............... [[32mSUCCESS 1[0m in 3.23s]
[0m15:50:17.601111 [debug] [Thread-1 (]: Finished running node model.mini_project.prep_products
[0m15:50:17.602156 [debug] [Thread-1 (]: Began running node model.mini_project.prep_transaction
[0m15:50:17.603174 [info ] [Thread-1 (]: 6 of 11 START sql table model JOB_PORTAL.PREP.prep_transaction ................. [RUN]
[0m15:50:17.604184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.prep_products, now model.mini_project.prep_transaction)
[0m15:50:17.605185 [debug] [Thread-1 (]: Began compiling node model.mini_project.prep_transaction
[0m15:50:17.608184 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.prep_transaction"
[0m15:50:17.608184 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_transaction (compile): 15:50:17.605185 => 15:50:17.608184
[0m15:50:17.608184 [debug] [Thread-1 (]: Began executing node model.mini_project.prep_transaction
[0m15:50:17.608184 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.prep_transaction"
[0m15:50:17.608184 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.prep_transaction"
[0m15:50:17.608184 [debug] [Thread-1 (]: On model.mini_project.prep_transaction: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.prep_transaction"} */
create or replace transient table JOB_PORTAL.PREP.prep_transaction
         as
        (
    SELECT DISTINCT
        CUSTOMER_ID::NUMBER AS CUSTOMER_ID,
        PRODUCT_ID::VARCHAR AS PRODUCT_ID,
        TO_DATE(PAYMENT_MONTH) AS PAYMENT_MONTH,
        REVENUE_TYPE::NUMBER AS REVENUE_TYPE,
        REVENUE::NUMBER(38,2) AS REVENUE,
        QUANTITY::NUMBER AS QUANTITY,
        LOWER(TRIM(COMPANIES)) AS COMPANIES
    FROM JOB_PORTAL.RAW.raw_transaction
        );
[0m15:50:17.608184 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:20.271688 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m15:50:20.271688 [debug] [Thread-2 (]: Timing info for model.mini_project.prep_customers (execute): 15:50:17.516055 => 15:50:20.271688
[0m15:50:20.271688 [debug] [Thread-2 (]: On model.mini_project.prep_customers: Close
[0m15:50:20.287691 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m15:50:20.295562 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_transaction (execute): 15:50:17.608184 => 15:50:20.293554
[0m15:50:20.295562 [debug] [Thread-1 (]: On model.mini_project.prep_transaction: Close
[0m15:50:20.920039 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f2d4144-cb20-40c9-aba5-6868ad7fbf47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224F5660950>]}
[0m15:50:20.920039 [info ] [Thread-2 (]: 5 of 11 OK created sql table model JOB_PORTAL.PREP.prep_customers .............. [[32mSUCCESS 1[0m in 3.41s]
[0m15:50:20.920039 [debug] [Thread-2 (]: Finished running node model.mini_project.prep_customers
[0m15:50:20.931399 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f2d4144-cb20-40c9-aba5-6868ad7fbf47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224FA832000>]}
[0m15:50:20.931399 [info ] [Thread-1 (]: 6 of 11 OK created sql table model JOB_PORTAL.PREP.prep_transaction ............ [[32mSUCCESS 1[0m in 3.33s]
[0m15:50:20.931399 [debug] [Thread-1 (]: Finished running node model.mini_project.prep_transaction
[0m15:50:20.934286 [debug] [Thread-2 (]: Began running node model.mini_project.kpi1
[0m15:50:20.935177 [debug] [Thread-1 (]: Began running node model.mini_project.kpi5
[0m15:50:20.935177 [info ] [Thread-2 (]: 7 of 11 START sql table model JOB_PORTAL.RAW.kpi1 .............................. [RUN]
[0m15:50:20.937006 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mini_project.prep_customers, now model.mini_project.kpi1)
[0m15:50:20.937006 [debug] [Thread-2 (]: Began compiling node model.mini_project.kpi1
[0m15:50:20.939234 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.kpi1"
[0m15:50:20.935932 [info ] [Thread-1 (]: 8 of 11 START sql table model JOB_PORTAL.RAW.kpi5 .............................. [RUN]
[0m15:50:20.942934 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.prep_transaction, now model.mini_project.kpi5)
[0m15:50:20.943947 [debug] [Thread-1 (]: Began compiling node model.mini_project.kpi5
[0m15:50:20.947578 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.kpi5"
[0m15:50:20.948578 [debug] [Thread-2 (]: Timing info for model.mini_project.kpi1 (compile): 15:50:20.938005 => 15:50:20.948578
[0m15:50:20.948578 [debug] [Thread-2 (]: Began executing node model.mini_project.kpi1
[0m15:50:20.950578 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.kpi1"
[0m15:50:20.950578 [debug] [Thread-1 (]: Timing info for model.mini_project.kpi5 (compile): 15:50:20.944949 => 15:50:20.950578
[0m15:50:20.950578 [debug] [Thread-1 (]: Began executing node model.mini_project.kpi5
[0m15:50:20.950578 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.kpi5"
[0m15:50:20.950578 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.kpi1"
[0m15:50:20.950578 [debug] [Thread-2 (]: On model.mini_project.kpi1: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.kpi1"} */
create or replace transient table JOB_PORTAL.RAW.kpi1
         as
        (WITH
  CTE_1 AS (
    SELECT
      MAX(PAYMENT_MONTH) AS EOP
    FROM
      JOB_PORTAL.PREP.prep_transaction
  ),
  CTE_2 AS (
    SELECT
      *
    FROM
      JOB_PORTAL.PREP.prep_transaction
      INNER JOIN CTE_1 AS CT ON 1 = 1
  ),
  CTE_3 AS (
    SELECT
      CUSTOMER_ID,
      MAX(PAYMENT_MONTH) AS LATEST,
      MIN(PAYMENT_MONTH) AS FIRST,
      DATEADD (MONTH, -3, EOP) AS L3M,
      EOP,
      CASE
        WHEN (FIRST <= L3M) THEN 0
        ELSE 1
      END AS IS_NEW,
      CASE
        WHEN (
          FIRST <= L3M
          AND LATEST < EOP
        ) THEN 1
        ELSE 0
      END AS IS_CHURN
    FROM
      CTE_2
    GROUP BY
      CUSTOMER_ID,
      EOP
  )
SELECT
  SUM(IS_CHURN) AS CHURNED_CUSTOMERS,
  SUM(IS_NEW) AS NEW_CUSTOMERS,
  EOP
FROM
  CTE_3
GROUP BY
  EOP
        );
[0m15:50:20.959592 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:50:20.962637 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.kpi5"
[0m15:50:20.963635 [debug] [Thread-1 (]: On model.mini_project.kpi5: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.kpi5"} */
create or replace transient table JOB_PORTAL.RAW.kpi5
         as
        (WITH CTE_1 AS(
  SELECT 
    CUSTOMER_ID, 
    MIN(PAYMENT_MONTH) AS FIRST_MONTH 
  FROM 
    JOB_PORTAL.PREP.prep_transaction 
  GROUP BY 
    CUSTOMER_ID
) 
SELECT 
  DISTINCT DATE_TRUNC('YEAR', FIRST_MONTH) AS FISCAL_YEAR, 
  (
    COUNT(CUSTOMER_ID)
  ) AS NEW_CUSTOMERS 
FROM 
  CTE_1 
GROUP BY 
  FISCAL_YEAR
        );
[0m15:50:20.963635 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:23.414639 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m15:50:23.414639 [debug] [Thread-1 (]: Timing info for model.mini_project.kpi5 (execute): 15:50:20.950578 => 15:50:23.414639
[0m15:50:23.414639 [debug] [Thread-1 (]: On model.mini_project.kpi5: Close
[0m15:50:23.538452 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m15:50:23.554499 [debug] [Thread-2 (]: Timing info for model.mini_project.kpi1 (execute): 15:50:20.949577 => 15:50:23.554499
[0m15:50:23.554499 [debug] [Thread-2 (]: On model.mini_project.kpi1: Close
[0m15:50:24.075464 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f2d4144-cb20-40c9-aba5-6868ad7fbf47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224FA8BACC0>]}
[0m15:50:24.075464 [info ] [Thread-1 (]: 8 of 11 OK created sql table model JOB_PORTAL.RAW.kpi5 ......................... [[32mSUCCESS 1[0m in 3.14s]
[0m15:50:24.075464 [debug] [Thread-1 (]: Finished running node model.mini_project.kpi5
[0m15:50:24.075464 [debug] [Thread-1 (]: Began running node model.mini_project.kpi6
[0m15:50:24.075464 [info ] [Thread-1 (]: 9 of 11 START sql table model JOB_PORTAL.RAW.kpi6 .............................. [RUN]
[0m15:50:24.075464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.kpi5, now model.mini_project.kpi6)
[0m15:50:24.075464 [debug] [Thread-1 (]: Began compiling node model.mini_project.kpi6
[0m15:50:24.075464 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.kpi6"
[0m15:50:24.090083 [debug] [Thread-1 (]: Timing info for model.mini_project.kpi6 (compile): 15:50:24.075464 => 15:50:24.090083
[0m15:50:24.090083 [debug] [Thread-1 (]: Began executing node model.mini_project.kpi6
[0m15:50:24.093942 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.kpi6"
[0m15:50:24.094943 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.kpi6"
[0m15:50:24.095650 [debug] [Thread-1 (]: On model.mini_project.kpi6: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.kpi6"} */
create or replace transient table JOB_PORTAL.RAW.kpi6
         as
        (with
  cte_1 as (
    select
      product_id,
      sum(revenue) as revenue
    from
      JOB_PORTAL.PREP.prep_transaction
    where
      revenue_type = 1
    group by
      product_id
  ),
  cte_2 as (
    select
      product_id,
      revenue,
      dense_rank() over (
        order by
          revenue desc
      )
    from
      cte_1
  )
select
  *
from
  cte_2
        );
[0m15:50:24.096558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:24.208635 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f2d4144-cb20-40c9-aba5-6868ad7fbf47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224FA831580>]}
[0m15:50:24.210639 [info ] [Thread-2 (]: 7 of 11 OK created sql table model JOB_PORTAL.RAW.kpi1 ......................... [[32mSUCCESS 1[0m in 3.27s]
[0m15:50:24.210639 [debug] [Thread-2 (]: Finished running node model.mini_project.kpi1
[0m15:50:24.210639 [debug] [Thread-2 (]: Began running node model.mini_project.kpi7
[0m15:50:24.210639 [info ] [Thread-2 (]: 10 of 11 START sql table model JOB_PORTAL.RAW.kpi7 ............................. [RUN]
[0m15:50:24.213477 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mini_project.kpi1, now model.mini_project.kpi7)
[0m15:50:24.213477 [debug] [Thread-2 (]: Began compiling node model.mini_project.kpi7
[0m15:50:24.213477 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.kpi7"
[0m15:50:24.213477 [debug] [Thread-2 (]: Timing info for model.mini_project.kpi7 (compile): 15:50:24.213477 => 15:50:24.213477
[0m15:50:24.213477 [debug] [Thread-2 (]: Began executing node model.mini_project.kpi7
[0m15:50:24.264693 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.kpi7"
[0m15:50:24.264693 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.kpi7"
[0m15:50:24.264693 [debug] [Thread-2 (]: On model.mini_project.kpi7: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.kpi7"} */
create or replace transient table JOB_PORTAL.RAW.kpi7
         as
        (with
  cte_1 as (
    select
      customer_id,
      sum(revenue) as revenue
    from
      JOB_PORTAL.PREP.prep_transaction
    where
      revenue_type = 1
    group by
      customer_id
  ),
  cte_2 as (
    select
      customer_id,
      revenue,
      dense_rank() over (
        order by
          revenue desc
      )
    from
      cte_1
  )
select
  *
from
  cte_2
        );
[0m15:50:24.264693 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:50:26.919554 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m15:50:26.919554 [debug] [Thread-2 (]: Timing info for model.mini_project.kpi7 (execute): 15:50:24.213477 => 15:50:26.919554
[0m15:50:26.919554 [debug] [Thread-2 (]: On model.mini_project.kpi7: Close
[0m15:50:27.113005 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m15:50:27.113005 [debug] [Thread-1 (]: Timing info for model.mini_project.kpi6 (execute): 15:50:24.091064 => 15:50:27.113005
[0m15:50:27.113005 [debug] [Thread-1 (]: On model.mini_project.kpi6: Close
[0m15:50:27.563381 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f2d4144-cb20-40c9-aba5-6868ad7fbf47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224FA8A9340>]}
[0m15:50:27.564381 [info ] [Thread-2 (]: 10 of 11 OK created sql table model JOB_PORTAL.RAW.kpi7 ........................ [[32mSUCCESS 1[0m in 3.35s]
[0m15:50:27.564779 [debug] [Thread-2 (]: Finished running node model.mini_project.kpi7
[0m15:50:27.565817 [debug] [Thread-2 (]: Began running node model.mini_project.prep_fulldata
[0m15:50:27.565817 [info ] [Thread-2 (]: 11 of 11 START sql table model JOB_PORTAL.PREP.prep_fulldata ................... [RUN]
[0m15:50:27.566785 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mini_project.kpi7, now model.mini_project.prep_fulldata)
[0m15:50:27.566785 [debug] [Thread-2 (]: Began compiling node model.mini_project.prep_fulldata
[0m15:50:27.566785 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.prep_fulldata"
[0m15:50:27.566785 [debug] [Thread-2 (]: Timing info for model.mini_project.prep_fulldata (compile): 15:50:27.566785 => 15:50:27.566785
[0m15:50:27.566785 [debug] [Thread-2 (]: Began executing node model.mini_project.prep_fulldata
[0m15:50:27.566785 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.prep_fulldata"
[0m15:50:27.566785 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.prep_fulldata"
[0m15:50:27.566785 [debug] [Thread-2 (]: On model.mini_project.prep_fulldata: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.prep_fulldata"} */
create or replace transient table JOB_PORTAL.PREP.prep_fulldata
         as
        (
WITH CTE_1 AS(
    SELECT DISTINCT
        ST.CUSTOMER_ID,
        ST.PRODUCT_ID,
        ST.PAYMENT_MONTH,
        ST.REVENUE,
        ST.REVENUE_TYPE,
        ST.QUANTITY,
        CUST.COMPANY AS CUSTOMER_COMPANY,
        CUST.CUSTOMERNAME AS CUSTOMER_NAME,
        PROD.PRODUCT_FAMILY,
        PROD.PRODUCT_SUB_FAMILY
    FROM JOB_PORTAL.PREP.prep_transaction ST
    LEFT JOIN JOB_PORTAL.PREP.prep_customers CUST ON ST.CUSTOMER_ID = CUST.CUSTOMER_ID
    LEFT JOIN JOB_PORTAL.PREP.prep_products PROD ON ST.PRODUCT_ID = PROD.PRODUCT_ID
)
SELECT
     *
FROM
    CTE_1
    WHERE REVENUE_TYPE = 1
        );
[0m15:50:27.566785 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:50:27.783064 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f2d4144-cb20-40c9-aba5-6868ad7fbf47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224FA9CE390>]}
[0m15:50:27.783064 [info ] [Thread-1 (]: 9 of 11 OK created sql table model JOB_PORTAL.RAW.kpi6 ......................... [[32mSUCCESS 1[0m in 3.71s]
[0m15:50:27.783064 [debug] [Thread-1 (]: Finished running node model.mini_project.kpi6
[0m15:50:30.494755 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m15:50:30.519923 [debug] [Thread-2 (]: Timing info for model.mini_project.prep_fulldata (execute): 15:50:27.566785 => 15:50:30.519923
[0m15:50:30.521991 [debug] [Thread-2 (]: On model.mini_project.prep_fulldata: Close
[0m15:50:31.179903 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f2d4144-cb20-40c9-aba5-6868ad7fbf47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224FA4E91C0>]}
[0m15:50:31.179903 [info ] [Thread-2 (]: 11 of 11 OK created sql table model JOB_PORTAL.PREP.prep_fulldata .............. [[32mSUCCESS 1[0m in 3.61s]
[0m15:50:31.179903 [debug] [Thread-2 (]: Finished running node model.mini_project.prep_fulldata
[0m15:50:31.179903 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:50:31.179903 [debug] [MainThread]: Connection 'list_JOB_PORTAL' was properly closed.
[0m15:50:31.179903 [debug] [MainThread]: Connection 'list_JOB_PORTAL' was properly closed.
[0m15:50:31.179903 [debug] [MainThread]: Connection 'list_JOB_PORTAL_PREP' was properly closed.
[0m15:50:31.179903 [debug] [MainThread]: Connection 'list_JOB_PORTAL_RAW' was properly closed.
[0m15:50:31.179903 [debug] [MainThread]: Connection 'model.mini_project.kpi6' was properly closed.
[0m15:50:31.186429 [debug] [MainThread]: Connection 'model.mini_project.prep_fulldata' was properly closed.
[0m15:50:31.189333 [info ] [MainThread]: 
[0m15:50:31.189333 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 28.11 seconds (28.11s).
[0m15:50:31.194646 [debug] [MainThread]: Command end result
[0m15:50:31.203944 [info ] [MainThread]: 
[0m15:50:31.211702 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:50:31.211702 [info ] [MainThread]: 
[0m15:50:31.211702 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m15:50:31.211702 [debug] [MainThread]: Command `dbt run` succeeded at 15:50:31.211702 after 28.88 seconds
[0m15:50:31.215016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224F84B2360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224F849BEC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224F78D4080>]}
[0m15:50:31.215016 [debug] [MainThread]: Flushing usage events
[0m16:33:07.297879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017954ED5130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017954B23830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017954ED4B30>]}


============================== 16:33:07.303072 | 0b57734f-a035-42a5-8888-2be1ee2bb712 ==============================
[0m16:33:07.303072 [info ] [MainThread]: Running with dbt=1.7.19
[0m16:33:07.303522 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\DasariUday\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\DasariUday\\venv\\.venv\\mini_project\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m prep_extradata', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:33:07.721179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b57734f-a035-42a5-8888-2be1ee2bb712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017954ED6D20>]}
[0m16:33:07.779162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b57734f-a035-42a5-8888-2be1ee2bb712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017954E00140>]}
[0m16:33:07.780163 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m16:33:07.788828 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m16:33:07.867765 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:33:07.867765 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:33:07.867765 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project.mart
[0m16:33:07.867765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b57734f-a035-42a5-8888-2be1ee2bb712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179558F0EF0>]}
[0m16:33:07.902335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b57734f-a035-42a5-8888-2be1ee2bb712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017956D330E0>]}
[0m16:33:07.902335 [info ] [MainThread]: Found 13 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m16:33:07.902335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b57734f-a035-42a5-8888-2be1ee2bb712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017956D30170>]}
[0m16:33:07.902335 [info ] [MainThread]: 
[0m16:33:07.902335 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:33:07.918198 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL'
[0m16:33:07.932181 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL"
[0m16:33:07.932181 [debug] [ThreadPool]: On list_JOB_PORTAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL"} */
show terse schemas in database JOB_PORTAL
    limit 10000
[0m16:33:07.932181 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:33:10.202633 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m16:33:10.207034 [debug] [ThreadPool]: On list_JOB_PORTAL: Close
[0m16:33:10.873874 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m16:33:10.889791 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL_RAW'
[0m16:33:10.898802 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_RAW"
[0m16:33:10.898802 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m16:33:10.903776 [debug] [ThreadPool]: On list_JOB_PORTAL_RAW: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_RAW"} */
show terse objects in JOB_PORTAL.RAW limit 10000
[0m16:33:10.904734 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show terse objects in MINI_PROJECT.RAW limit 10000
[0m16:33:10.906077 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:33:10.906878 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:33:12.905716 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m16:33:12.905716 [debug] [ThreadPool]: On list_JOB_PORTAL_RAW: Close
[0m16:33:12.921755 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m16:33:12.921755 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: Close
[0m16:33:13.596271 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JOB_PORTAL_RAW, now list_JOB_PORTAL_PREP)
[0m16:33:13.601292 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_PREP"
[0m16:33:13.601292 [debug] [ThreadPool]: On list_JOB_PORTAL_PREP: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_PREP"} */
show terse objects in JOB_PORTAL.PREP limit 10000
[0m16:33:13.601292 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:33:15.442239 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.0 seconds
[0m16:33:15.457316 [debug] [ThreadPool]: On list_JOB_PORTAL_PREP: Close
[0m16:33:16.125368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b57734f-a035-42a5-8888-2be1ee2bb712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017954957AD0>]}
[0m16:33:16.127411 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m16:33:16.128377 [info ] [MainThread]: 
[0m16:33:16.131088 [debug] [Thread-1 (]: Began running node model.mini_project.prep_extradata
[0m16:33:16.131088 [info ] [Thread-1 (]: 1 of 1 START sql table model JOB_PORTAL.PREP.prep_extradata .................... [RUN]
[0m16:33:16.131088 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project.prep_extradata'
[0m16:33:16.136017 [debug] [Thread-1 (]: Began compiling node model.mini_project.prep_extradata
[0m16:33:16.144074 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.prep_extradata"
[0m16:33:16.145109 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_extradata (compile): 16:33:16.136017 => 16:33:16.145109
[0m16:33:16.146075 [debug] [Thread-1 (]: Began executing node model.mini_project.prep_extradata
[0m16:33:16.179431 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.prep_extradata"
[0m16:33:16.181401 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.prep_extradata"
[0m16:33:16.181401 [debug] [Thread-1 (]: On model.mini_project.prep_extradata: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.prep_extradata"} */
create or replace transient table JOB_PORTAL.PREP.prep_extradata
         as
        (SELECT CUSTOMER_ID,PRODUCT_ID, LAG(PAYMENT_MONTH)OVER(PARTITION BY CUSTOMER_ID ORDER BY PAYMENT_MONTH) AS LAST_MONTH,PAYMENT_MONTH,REVENUE,SUM(REVENUE)OVER(PARTITION BY PAYMENT_MONTH ORDER BY PAYMENT_MONTH) AS MONTH_REVENUE,CUSTOMER_NAME,PRODUCT_FAMILY,PRODUCT_SUB_FAMILY ,LAG(PRODUCT_FAMILY)OVER(PARTITION BY CUSTOMER_ID,PAYMENT_MONTH
 ORDER BY PAYMENT_MONTH) AS LAST_PRODUCT,LAG(PRODUCT_SUB_FAMILY)OVER(PARTITION BY CUSTOMER_ID,PAYMENT_MONTH ORDER BY PAYMENT_MONTH) AS LAST_PRODUCT_SUB FROM JOB_PORTAL.PREP.prep_fulldata ORDER BY CUSTOMER_ID,PAYMENT_MONTH;
[0m16:33:16.181401 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:33:18.294877 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0037-0004-c0bd-0005-d15300018a32
[0m16:33:18.294877 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 4 at position 221 unexpected ';'.
[0m16:33:18.294877 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_extradata (execute): 16:33:16.146075 => 16:33:18.294877
[0m16:33:18.294877 [debug] [Thread-1 (]: On model.mini_project.prep_extradata: Close
[0m16:33:18.985921 [debug] [Thread-1 (]: Database Error in model prep_extradata (models\prep\prep_extradata.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 221 unexpected ';'.
  compiled Code at target\run\mini_project\models\prep\prep_extradata.sql
[0m16:33:18.985921 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b57734f-a035-42a5-8888-2be1ee2bb712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001795715BB90>]}
[0m16:33:18.987065 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model JOB_PORTAL.PREP.prep_extradata ........... [[31mERROR[0m in 2.85s]
[0m16:33:18.988032 [debug] [Thread-1 (]: Finished running node model.mini_project.prep_extradata
[0m16:33:18.990705 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:33:18.990705 [debug] [MainThread]: Connection 'list_JOB_PORTAL' was properly closed.
[0m16:33:18.990705 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was properly closed.
[0m16:33:18.991706 [debug] [MainThread]: Connection 'list_JOB_PORTAL_PREP' was properly closed.
[0m16:33:18.991706 [debug] [MainThread]: Connection 'model.mini_project.prep_extradata' was properly closed.
[0m16:33:18.991706 [info ] [MainThread]: 
[0m16:33:18.992705 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.09 seconds (11.09s).
[0m16:33:18.994147 [debug] [MainThread]: Command end result
[0m16:33:19.006769 [info ] [MainThread]: 
[0m16:33:19.006769 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:33:19.006769 [info ] [MainThread]: 
[0m16:33:19.006769 [error] [MainThread]:   Database Error in model prep_extradata (models\prep\prep_extradata.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 221 unexpected ';'.
  compiled Code at target\run\mini_project\models\prep\prep_extradata.sql
[0m16:33:19.006769 [info ] [MainThread]: 
[0m16:33:19.006769 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:33:19.012650 [debug] [MainThread]: Command `dbt run` failed at 16:33:19.012650 after 11.88 seconds
[0m16:33:19.013676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017954ED5130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017954ED5640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017954ED4B30>]}
[0m16:33:19.014664 [debug] [MainThread]: Flushing usage events
[0m16:33:33.896142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5BDFF5100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5BDFF4E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5BDFF4D70>]}


============================== 16:33:33.896142 | 0f59a999-7540-4cb0-8aa7-d63a87ef1184 ==============================
[0m16:33:33.896142 [info ] [MainThread]: Running with dbt=1.7.19
[0m16:33:33.896142 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\DasariUday\\venv\\.venv\\mini_project\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\DasariUday\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m prep_extradata', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:33:34.344085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f59a999-7540-4cb0-8aa7-d63a87ef1184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5BFD44B00>]}
[0m16:33:34.410694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f59a999-7540-4cb0-8aa7-d63a87ef1184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5BCED4410>]}
[0m16:33:34.410694 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m16:33:34.426950 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m16:33:34.517679 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:33:34.518680 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:33:34.519680 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project.mart
[0m16:33:34.524680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f59a999-7540-4cb0-8aa7-d63a87ef1184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5BFDDA9F0>]}
[0m16:33:34.527095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f59a999-7540-4cb0-8aa7-d63a87ef1184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5BFE33C20>]}
[0m16:33:34.527095 [info ] [MainThread]: Found 13 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m16:33:34.527095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f59a999-7540-4cb0-8aa7-d63a87ef1184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5BE31A870>]}
[0m16:33:34.540851 [info ] [MainThread]: 
[0m16:33:34.542170 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:33:34.544209 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL'
[0m16:33:34.554560 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL"
[0m16:33:34.554560 [debug] [ThreadPool]: On list_JOB_PORTAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL"} */
show terse schemas in database JOB_PORTAL
    limit 10000
[0m16:33:34.554560 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:33:37.002859 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m16:33:37.004604 [debug] [ThreadPool]: On list_JOB_PORTAL: Close
[0m16:33:37.701461 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m16:33:37.712611 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL_RAW'
[0m16:33:37.712611 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m16:33:37.712611 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_RAW"
[0m16:33:37.712611 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show terse objects in MINI_PROJECT.RAW limit 10000
[0m16:33:37.712611 [debug] [ThreadPool]: On list_JOB_PORTAL_RAW: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_RAW"} */
show terse objects in JOB_PORTAL.RAW limit 10000
[0m16:33:37.712611 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:33:37.712611 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:33:39.577588 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m16:33:39.579587 [debug] [ThreadPool]: On list_JOB_PORTAL_RAW: Close
[0m16:33:39.615129 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m16:33:39.617133 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: Close
[0m16:33:40.264219 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JOB_PORTAL_RAW, now list_JOB_PORTAL_PREP)
[0m16:33:40.272155 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_PREP"
[0m16:33:40.272155 [debug] [ThreadPool]: On list_JOB_PORTAL_PREP: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_PREP"} */
show terse objects in JOB_PORTAL.PREP limit 10000
[0m16:33:40.272155 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:33:42.165631 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.0 seconds
[0m16:33:42.165631 [debug] [ThreadPool]: On list_JOB_PORTAL_PREP: Close
[0m16:33:42.824472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f59a999-7540-4cb0-8aa7-d63a87ef1184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5BFDD8110>]}
[0m16:33:42.826471 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m16:33:42.827866 [info ] [MainThread]: 
[0m16:33:42.836192 [debug] [Thread-1 (]: Began running node model.mini_project.prep_extradata
[0m16:33:42.837236 [info ] [Thread-1 (]: 1 of 1 START sql table model JOB_PORTAL.PREP.prep_extradata .................... [RUN]
[0m16:33:42.840280 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project.prep_extradata'
[0m16:33:42.841238 [debug] [Thread-1 (]: Began compiling node model.mini_project.prep_extradata
[0m16:33:42.852989 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.prep_extradata"
[0m16:33:42.853990 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_extradata (compile): 16:33:42.841238 => 16:33:42.853990
[0m16:33:42.854993 [debug] [Thread-1 (]: Began executing node model.mini_project.prep_extradata
[0m16:33:42.890410 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.prep_extradata"
[0m16:33:42.892404 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.prep_extradata"
[0m16:33:42.892847 [debug] [Thread-1 (]: On model.mini_project.prep_extradata: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.prep_extradata"} */
create or replace transient table JOB_PORTAL.PREP.prep_extradata
         as
        (SELECT CUSTOMER_ID,PRODUCT_ID, LAG(PAYMENT_MONTH)OVER(PARTITION BY CUSTOMER_ID ORDER BY PAYMENT_MONTH) AS LAST_MONTH,PAYMENT_MONTH,REVENUE,SUM(REVENUE)OVER(PARTITION BY PAYMENT_MONTH ORDER BY PAYMENT_MONTH) AS MONTH_REVENUE,CUSTOMER_NAME,PRODUCT_FAMILY,PRODUCT_SUB_FAMILY ,LAG(PRODUCT_FAMILY)OVER(PARTITION BY CUSTOMER_ID,PAYMENT_MONTH
 ORDER BY PAYMENT_MONTH) AS LAST_PRODUCT,LAG(PRODUCT_SUB_FAMILY)OVER(PARTITION BY CUSTOMER_ID,PAYMENT_MONTH ORDER BY PAYMENT_MONTH) AS LAST_PRODUCT_SUB FROM JOB_PORTAL.PREP.prep_fulldata ORDER BY CUSTOMER_ID,PAYMENT_MONTH
        );
[0m16:33:42.892847 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:33:46.615608 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.0 seconds
[0m16:33:46.627583 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_extradata (execute): 16:33:42.854993 => 16:33:46.627583
[0m16:33:46.627583 [debug] [Thread-1 (]: On model.mini_project.prep_extradata: Close
[0m16:33:47.292910 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f59a999-7540-4cb0-8aa7-d63a87ef1184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5C019E810>]}
[0m16:33:47.292910 [info ] [Thread-1 (]: 1 of 1 OK created sql table model JOB_PORTAL.PREP.prep_extradata ............... [[32mSUCCESS 1[0m in 4.45s]
[0m16:33:47.292910 [debug] [Thread-1 (]: Finished running node model.mini_project.prep_extradata
[0m16:33:47.306429 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:33:47.307469 [debug] [MainThread]: Connection 'list_JOB_PORTAL' was properly closed.
[0m16:33:47.307839 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was properly closed.
[0m16:33:47.307839 [debug] [MainThread]: Connection 'list_JOB_PORTAL_PREP' was properly closed.
[0m16:33:47.307839 [debug] [MainThread]: Connection 'model.mini_project.prep_extradata' was properly closed.
[0m16:33:47.307839 [info ] [MainThread]: 
[0m16:33:47.307839 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 12.77 seconds (12.77s).
[0m16:33:47.311145 [debug] [MainThread]: Command end result
[0m16:33:47.336122 [info ] [MainThread]: 
[0m16:33:47.336122 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:33:47.339865 [info ] [MainThread]: 
[0m16:33:47.340905 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:33:47.342875 [debug] [MainThread]: Command `dbt run` succeeded at 16:33:47.342875 after 13.59 seconds
[0m16:33:47.343873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5BD579670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5BDE716A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5BD5AE930>]}
[0m16:33:47.343873 [debug] [MainThread]: Flushing usage events
[0m16:49:43.552336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D66A224E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D66A225D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D66A224F80>]}


============================== 16:49:43.552336 | e8d753a6-ceaf-41b5-89b3-25b3b5abed08 ==============================
[0m16:49:43.552336 [info ] [MainThread]: Running with dbt=1.7.19
[0m16:49:43.552336 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\DasariUday\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\DasariUday\\venv\\.venv\\mini_project\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:49:44.071571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8d753a6-ceaf-41b5-89b3-25b3b5abed08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D66A24FD70>]}
[0m16:49:44.119110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8d753a6-ceaf-41b5-89b3-25b3b5abed08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D66AD3A9F0>]}
[0m16:49:44.119110 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m16:49:44.134945 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m16:49:44.224849 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:49:44.224849 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:49:44.224849 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project.mart
[0m16:49:44.224849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8d753a6-ceaf-41b5-89b3-25b3b5abed08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D66C004590>]}
[0m16:49:44.260554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8d753a6-ceaf-41b5-89b3-25b3b5abed08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D66C0635F0>]}
[0m16:49:44.260554 [info ] [MainThread]: Found 13 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m16:49:44.261506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8d753a6-ceaf-41b5-89b3-25b3b5abed08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D66A24E180>]}
[0m16:49:44.262539 [info ] [MainThread]: 
[0m16:49:44.262539 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:49:44.262539 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL'
[0m16:49:44.281895 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL"
[0m16:49:44.281895 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL'
[0m16:49:44.282899 [debug] [ThreadPool]: On list_JOB_PORTAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL"} */
show terse schemas in database JOB_PORTAL
    limit 10000
[0m16:49:44.282899 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL"
[0m16:49:44.282899 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:44.282899 [debug] [ThreadPool]: On list_JOB_PORTAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL"} */
show terse schemas in database JOB_PORTAL
    limit 10000
[0m16:49:44.288869 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:46.651164 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m16:49:46.651164 [debug] [ThreadPool]: On list_JOB_PORTAL: Close
[0m16:49:46.707367 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m16:49:46.707367 [debug] [ThreadPool]: On list_JOB_PORTAL: Close
[0m16:49:47.307510 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL"
[0m16:49:47.307510 [debug] [ThreadPool]: On list_JOB_PORTAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL"} */
show terse schemas in database JOB_PORTAL
    limit 10000
[0m16:49:47.315865 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:49:49.224689 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m16:49:49.240550 [debug] [ThreadPool]: On list_JOB_PORTAL: Close
[0m16:49:49.907276 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JOB_PORTAL, now create_JOB_PORTAL_KPI)
[0m16:49:49.907276 [debug] [ThreadPool]: Creating schema "database: "JOB_PORTAL"
schema: "KPI"
"
[0m16:49:49.919795 [debug] [ThreadPool]: Using snowflake connection "create_JOB_PORTAL_KPI"
[0m16:49:49.919795 [debug] [ThreadPool]: On create_JOB_PORTAL_KPI: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "create_JOB_PORTAL_KPI"} */
create schema if not exists JOB_PORTAL.KPI
[0m16:49:49.919795 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:49:51.796598 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:49:51.796598 [debug] [ThreadPool]: On create_JOB_PORTAL_KPI: Close
[0m16:49:52.485995 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL_KPI'
[0m16:49:52.491476 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL_RAW'
[0m16:49:52.495485 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_KPI"
[0m16:49:52.497488 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_RAW"
[0m16:49:52.497488 [debug] [ThreadPool]: On list_JOB_PORTAL_KPI: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_KPI"} */
show terse objects in JOB_PORTAL.KPI limit 10000
[0m16:49:52.497488 [debug] [ThreadPool]: On list_JOB_PORTAL_RAW: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_RAW"} */
show terse objects in JOB_PORTAL.RAW limit 10000
[0m16:49:52.497488 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:52.497488 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:54.301726 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 2.0 seconds
[0m16:49:54.301726 [debug] [ThreadPool]: On list_JOB_PORTAL_KPI: Close
[0m16:49:54.317746 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m16:49:54.317746 [debug] [ThreadPool]: On list_JOB_PORTAL_RAW: Close
[0m16:49:54.982400 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JOB_PORTAL_KPI, now list_JOB_PORTAL_PREP)
[0m16:49:54.982400 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_PREP"
[0m16:49:54.982400 [debug] [ThreadPool]: On list_JOB_PORTAL_PREP: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_PREP"} */
show terse objects in JOB_PORTAL.PREP limit 10000
[0m16:49:54.982400 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:49:54.982400 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JOB_PORTAL_RAW, now list_MINI_PROJECT_RAW)
[0m16:49:54.982400 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m16:49:54.982400 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show terse objects in MINI_PROJECT.RAW limit 10000
[0m16:49:54.982400 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:49:56.841729 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m16:49:56.841729 [debug] [ThreadPool]: On list_JOB_PORTAL_PREP: Close
[0m16:49:56.971058 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m16:49:56.971058 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: Close
[0m16:49:57.651401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8d753a6-ceaf-41b5-89b3-25b3b5abed08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D66C0E7800>]}
[0m16:49:57.651401 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m16:49:57.651401 [info ] [MainThread]: 
[0m16:49:57.651401 [debug] [Thread-1 (]: Began running node model.mini_project.raw_customers
[0m16:49:57.651401 [debug] [Thread-2 (]: Began running node model.mini_project.raw_products
[0m16:49:57.651401 [info ] [Thread-1 (]: 1 of 13 START sql table model JOB_PORTAL.RAW.raw_customers ..................... [RUN]
[0m16:49:57.667657 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project.raw_customers'
[0m16:49:57.668666 [debug] [Thread-1 (]: Began compiling node model.mini_project.raw_customers
[0m16:49:57.666501 [info ] [Thread-2 (]: 2 of 13 START sql table model JOB_PORTAL.RAW.raw_products ...................... [RUN]
[0m16:49:57.678315 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.raw_customers"
[0m16:49:57.679283 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.mini_project.raw_products'
[0m16:49:57.679994 [debug] [Thread-2 (]: Began compiling node model.mini_project.raw_products
[0m16:49:57.682033 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.raw_products"
[0m16:49:57.682033 [debug] [Thread-1 (]: Timing info for model.mini_project.raw_customers (compile): 16:49:57.668666 => 16:49:57.682033
[0m16:49:57.682033 [debug] [Thread-1 (]: Began executing node model.mini_project.raw_customers
[0m16:49:57.692011 [debug] [Thread-2 (]: Timing info for model.mini_project.raw_products (compile): 16:49:57.679994 => 16:49:57.691024
[0m16:49:57.708651 [debug] [Thread-2 (]: Began executing node model.mini_project.raw_products
[0m16:49:57.715486 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.raw_customers"
[0m16:49:57.717492 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.raw_products"
[0m16:49:57.717492 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.raw_products"
[0m16:49:57.717492 [debug] [Thread-2 (]: On model.mini_project.raw_products: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.raw_products"} */
create or replace transient table JOB_PORTAL.RAW.raw_products
         as
        (
SELECT 
     *
FROM 
     MINI_PROJECT.RAW.Products 
     WHERE PRODUCT_ID 
           IS NOT NULL
        );
[0m16:49:57.723337 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.raw_customers"
[0m16:49:57.723337 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:49:57.724344 [debug] [Thread-1 (]: On model.mini_project.raw_customers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.raw_customers"} */
create or replace transient table JOB_PORTAL.RAW.raw_customers
         as
        (
SELECT 
    * 
FROM 
    MINI_PROJECT.RAW.Customers 
    WHERE CUSTOMER_ID 
          IS NOT NULL
        );
[0m16:49:57.726372 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:50:00.369487 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m16:50:00.398979 [debug] [Thread-1 (]: Timing info for model.mini_project.raw_customers (execute): 16:49:57.682033 => 16:50:00.398979
[0m16:50:00.398979 [debug] [Thread-1 (]: On model.mini_project.raw_customers: Close
[0m16:50:00.415362 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m16:50:00.415362 [debug] [Thread-2 (]: Timing info for model.mini_project.raw_products (execute): 16:49:57.717492 => 16:50:00.415362
[0m16:50:00.415362 [debug] [Thread-2 (]: On model.mini_project.raw_products: Close
[0m16:50:01.054236 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8d753a6-ceaf-41b5-89b3-25b3b5abed08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D66C557A10>]}
[0m16:50:01.054236 [info ] [Thread-1 (]: 1 of 13 OK created sql table model JOB_PORTAL.RAW.raw_customers ................ [[32mSUCCESS 1[0m in 3.39s]
[0m16:50:01.054236 [debug] [Thread-1 (]: Finished running node model.mini_project.raw_customers
[0m16:50:01.054236 [debug] [Thread-1 (]: Began running node model.mini_project.raw_transaction
[0m16:50:01.054236 [info ] [Thread-1 (]: 3 of 13 START sql table model JOB_PORTAL.RAW.raw_transaction ................... [RUN]
[0m16:50:01.063676 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.raw_customers, now model.mini_project.raw_transaction)
[0m16:50:01.063676 [debug] [Thread-1 (]: Began compiling node model.mini_project.raw_transaction
[0m16:50:01.063676 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.raw_transaction"
[0m16:50:01.063676 [debug] [Thread-1 (]: Timing info for model.mini_project.raw_transaction (compile): 16:50:01.063676 => 16:50:01.063676
[0m16:50:01.063676 [debug] [Thread-1 (]: Began executing node model.mini_project.raw_transaction
[0m16:50:01.063676 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.raw_transaction"
[0m16:50:01.063676 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.raw_transaction"
[0m16:50:01.063676 [debug] [Thread-1 (]: On model.mini_project.raw_transaction: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.raw_transaction"} */
create or replace transient table JOB_PORTAL.RAW.raw_transaction
         as
        (
SELECT 
     *
FROM 
    MINI_PROJECT.RAW.Transaction 
    WHERE CUSTOMER_ID 
          IS NOT NULL
        );
[0m16:50:01.063676 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:50:01.063676 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8d753a6-ceaf-41b5-89b3-25b3b5abed08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D66C53AF90>]}
[0m16:50:01.078731 [info ] [Thread-2 (]: 2 of 13 OK created sql table model JOB_PORTAL.RAW.raw_products ................. [[32mSUCCESS 1[0m in 3.39s]
[0m16:50:01.079739 [debug] [Thread-2 (]: Finished running node model.mini_project.raw_products
[0m16:50:01.080809 [debug] [Thread-2 (]: Began running node model.mini_project.prep_customers
[0m16:50:01.080809 [info ] [Thread-2 (]: 4 of 13 START sql table model JOB_PORTAL.PREP.prep_customers ................... [RUN]
[0m16:50:01.082636 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mini_project.raw_products, now model.mini_project.prep_customers)
[0m16:50:01.082636 [debug] [Thread-2 (]: Began compiling node model.mini_project.prep_customers
[0m16:50:01.085700 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.prep_customers"
[0m16:50:01.085700 [debug] [Thread-2 (]: Timing info for model.mini_project.prep_customers (compile): 16:50:01.082636 => 16:50:01.085700
[0m16:50:01.085700 [debug] [Thread-2 (]: Began executing node model.mini_project.prep_customers
[0m16:50:01.085700 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.prep_customers"
[0m16:50:01.085700 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.prep_customers"
[0m16:50:01.085700 [debug] [Thread-2 (]: On model.mini_project.prep_customers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.prep_customers"} */
create or replace transient table JOB_PORTAL.PREP.prep_customers
         as
        (
SELECT DISTINCT
    LOWER(TRIM(COMPANY)) AS COMPANY,
    CUSTOMER_ID::NUMBER AS CUSTOMER_ID,
    LOWER(
        REGEXP_REPLACE(
            TRIM(REGEXP_SUBSTR(CUSTOMERNAME, '^[^(]+')), 
            ',', 
            ''
        )
    ) AS CUSTOMERNAME,  --  name without commas
    
FROM JOB_PORTAL.RAW.raw_customers
        );
[0m16:50:01.093396 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:50:03.978471 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m16:50:03.978471 [debug] [Thread-2 (]: Timing info for model.mini_project.prep_customers (execute): 16:50:01.085700 => 16:50:03.978471
[0m16:50:03.978471 [debug] [Thread-2 (]: On model.mini_project.prep_customers: Close
[0m16:50:04.280854 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m16:50:04.292813 [debug] [Thread-1 (]: Timing info for model.mini_project.raw_transaction (execute): 16:50:01.063676 => 16:50:04.292813
[0m16:50:04.294821 [debug] [Thread-1 (]: On model.mini_project.raw_transaction: Close
[0m16:50:04.637784 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8d753a6-ceaf-41b5-89b3-25b3b5abed08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D66C53A5D0>]}
[0m16:50:04.637784 [info ] [Thread-2 (]: 4 of 13 OK created sql table model JOB_PORTAL.PREP.prep_customers .............. [[32mSUCCESS 1[0m in 3.56s]
[0m16:50:04.637784 [debug] [Thread-2 (]: Finished running node model.mini_project.prep_customers
[0m16:50:04.637784 [debug] [Thread-2 (]: Began running node model.mini_project.prep_products
[0m16:50:04.637784 [info ] [Thread-2 (]: 5 of 13 START sql table model JOB_PORTAL.PREP.prep_products .................... [RUN]
[0m16:50:04.637784 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mini_project.prep_customers, now model.mini_project.prep_products)
[0m16:50:04.649737 [debug] [Thread-2 (]: Began compiling node model.mini_project.prep_products
[0m16:50:04.655568 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.prep_products"
[0m16:50:04.655568 [debug] [Thread-2 (]: Timing info for model.mini_project.prep_products (compile): 16:50:04.650759 => 16:50:04.655568
[0m16:50:04.655568 [debug] [Thread-2 (]: Began executing node model.mini_project.prep_products
[0m16:50:04.655568 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.prep_products"
[0m16:50:04.655568 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.prep_products"
[0m16:50:04.655568 [debug] [Thread-2 (]: On model.mini_project.prep_products: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.prep_products"} */
create or replace transient table JOB_PORTAL.PREP.prep_products
         as
        (
SELECT 
    PRODUCT_ID::VARCHAR AS PRODUCT_ID,
    LOWER(TRIM(PRODUCT_FAMILY)) AS PRODUCT_FAMILY,
    LOWER(TRIM(PRODUCT_SUB_FAMILY)) AS PRODUCT_SUB_FAMILY
FROM JOB_PORTAL.RAW.raw_products
        );
[0m16:50:04.655568 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:50:04.962454 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8d753a6-ceaf-41b5-89b3-25b3b5abed08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D66C3C3EC0>]}
[0m16:50:04.962454 [info ] [Thread-1 (]: 3 of 13 OK created sql table model JOB_PORTAL.RAW.raw_transaction .............. [[32mSUCCESS 1[0m in 3.90s]
[0m16:50:04.962454 [debug] [Thread-1 (]: Finished running node model.mini_project.raw_transaction
[0m16:50:04.962454 [debug] [Thread-1 (]: Began running node model.mini_project.prep_transaction
[0m16:50:04.962454 [info ] [Thread-1 (]: 6 of 13 START sql table model JOB_PORTAL.PREP.prep_transaction ................. [RUN]
[0m16:50:04.962454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.raw_transaction, now model.mini_project.prep_transaction)
[0m16:50:04.962454 [debug] [Thread-1 (]: Began compiling node model.mini_project.prep_transaction
[0m16:50:04.962454 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.prep_transaction"
[0m16:50:04.962454 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_transaction (compile): 16:50:04.962454 => 16:50:04.962454
[0m16:50:04.962454 [debug] [Thread-1 (]: Began executing node model.mini_project.prep_transaction
[0m16:50:04.962454 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.prep_transaction"
[0m16:50:04.962454 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.prep_transaction"
[0m16:50:04.962454 [debug] [Thread-1 (]: On model.mini_project.prep_transaction: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.prep_transaction"} */
create or replace transient table JOB_PORTAL.PREP.prep_transaction
         as
        (
    SELECT DISTINCT
        CUSTOMER_ID::NUMBER AS CUSTOMER_ID,
        PRODUCT_ID::VARCHAR AS PRODUCT_ID,
        TO_DATE(PAYMENT_MONTH) AS PAYMENT_MONTH,
        REVENUE_TYPE::NUMBER AS REVENUE_TYPE,
        REVENUE::NUMBER(38,2) AS REVENUE,
        QUANTITY::NUMBER AS QUANTITY,
        LOWER(TRIM(COMPANIES)) AS COMPANIES
    FROM JOB_PORTAL.RAW.raw_transaction
        );
[0m16:50:04.962454 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:50:07.386479 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m16:50:07.386479 [debug] [Thread-2 (]: Timing info for model.mini_project.prep_products (execute): 16:50:04.655568 => 16:50:07.386479
[0m16:50:07.386479 [debug] [Thread-2 (]: On model.mini_project.prep_products: Close
[0m16:50:07.519229 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m16:50:07.523199 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_transaction (execute): 16:50:04.962454 => 16:50:07.522200
[0m16:50:07.523199 [debug] [Thread-1 (]: On model.mini_project.prep_transaction: Close
[0m16:50:08.044285 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8d753a6-ceaf-41b5-89b3-25b3b5abed08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D66C587D10>]}
[0m16:50:08.045286 [info ] [Thread-2 (]: 5 of 13 OK created sql table model JOB_PORTAL.PREP.prep_products ............... [[32mSUCCESS 1[0m in 3.41s]
[0m16:50:08.046131 [debug] [Thread-2 (]: Finished running node model.mini_project.prep_products
[0m16:50:08.190972 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8d753a6-ceaf-41b5-89b3-25b3b5abed08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D66C586BA0>]}
[0m16:50:08.190972 [info ] [Thread-1 (]: 6 of 13 OK created sql table model JOB_PORTAL.PREP.prep_transaction ............ [[32mSUCCESS 1[0m in 3.23s]
[0m16:50:08.198549 [debug] [Thread-1 (]: Finished running node model.mini_project.prep_transaction
[0m16:50:08.198549 [debug] [Thread-2 (]: Began running node model.mini_project.kpi1
[0m16:50:08.198549 [debug] [Thread-1 (]: Began running node model.mini_project.kpi5
[0m16:50:08.198549 [info ] [Thread-2 (]: 7 of 13 START sql table model JOB_PORTAL.KPI.kpi1 .............................. [RUN]
[0m16:50:08.198549 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mini_project.prep_products, now model.mini_project.kpi1)
[0m16:50:08.198549 [debug] [Thread-2 (]: Began compiling node model.mini_project.kpi1
[0m16:50:08.205455 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.kpi1"
[0m16:50:08.198549 [info ] [Thread-1 (]: 8 of 13 START sql table model JOB_PORTAL.KPI.kpi5 .............................. [RUN]
[0m16:50:08.205455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.prep_transaction, now model.mini_project.kpi5)
[0m16:50:08.205455 [debug] [Thread-1 (]: Began compiling node model.mini_project.kpi5
[0m16:50:08.205455 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.kpi5"
[0m16:50:08.205455 [debug] [Thread-2 (]: Timing info for model.mini_project.kpi1 (compile): 16:50:08.198549 => 16:50:08.205455
[0m16:50:08.205455 [debug] [Thread-2 (]: Began executing node model.mini_project.kpi1
[0m16:50:08.215731 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.kpi1"
[0m16:50:08.215731 [debug] [Thread-1 (]: Timing info for model.mini_project.kpi5 (compile): 16:50:08.205455 => 16:50:08.215731
[0m16:50:08.217215 [debug] [Thread-1 (]: Began executing node model.mini_project.kpi5
[0m16:50:08.219413 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.kpi5"
[0m16:50:08.221531 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.kpi5"
[0m16:50:08.222790 [debug] [Thread-1 (]: On model.mini_project.kpi5: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.kpi5"} */
create or replace transient table JOB_PORTAL.KPI.kpi5
         as
        (
WITH CTE_1 AS(
  SELECT 
    CUSTOMER_ID, 
    MIN(PAYMENT_MONTH) AS FIRST_MONTH 
  FROM 
    JOB_PORTAL.PREP.prep_transaction 
  GROUP BY 
    CUSTOMER_ID
) 
SELECT 
  DISTINCT DATE_TRUNC('YEAR', FIRST_MONTH) AS FISCAL_YEAR, 
  (
    COUNT(CUSTOMER_ID)
  ) AS NEW_CUSTOMERS 
FROM 
  CTE_1 
GROUP BY 
  FISCAL_YEAR
        );
[0m16:50:08.223781 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.kpi1"
[0m16:50:08.224832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:50:08.225287 [debug] [Thread-2 (]: On model.mini_project.kpi1: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.kpi1"} */
create or replace transient table JOB_PORTAL.KPI.kpi1
         as
        (
WITH
  CTE_1 AS (
    SELECT
      MAX(PAYMENT_MONTH) AS EOP
    FROM
      JOB_PORTAL.PREP.prep_transaction
  ),
  CTE_2 AS (
    SELECT
      *
    FROM
      JOB_PORTAL.PREP.prep_transaction
      INNER JOIN CTE_1 AS CT ON 1 = 1
  ),
  CTE_3 AS (
    SELECT
      CUSTOMER_ID,
      MAX(PAYMENT_MONTH) AS LATEST,
      MIN(PAYMENT_MONTH) AS FIRST,
      DATEADD (MONTH, -3, EOP) AS L3M,
      EOP,
      CASE
        WHEN (FIRST <= L3M) THEN 0
        ELSE 1
      END AS IS_NEW,
      CASE
        WHEN (
          FIRST <= L3M
          AND LATEST < EOP
        ) THEN 1
        ELSE 0
      END AS IS_CHURN
    FROM
      CTE_2
    GROUP BY
      CUSTOMER_ID,
      EOP
  )
SELECT
  SUM(IS_CHURN) AS CHURNED_CUSTOMERS,
  SUM(IS_NEW) AS NEW_CUSTOMERS,
  EOP
FROM
  CTE_3
GROUP BY
  EOP
        );
[0m16:50:08.227293 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:50:10.621485 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:50:10.621485 [debug] [Thread-1 (]: Timing info for model.mini_project.kpi5 (execute): 16:50:08.217215 => 16:50:10.621485
[0m16:50:10.621485 [debug] [Thread-1 (]: On model.mini_project.kpi5: Close
[0m16:50:10.699424 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:50:10.708661 [debug] [Thread-2 (]: Timing info for model.mini_project.kpi1 (execute): 16:50:08.205455 => 16:50:10.708661
[0m16:50:10.708661 [debug] [Thread-2 (]: On model.mini_project.kpi1: Close
[0m16:50:11.285239 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8d753a6-ceaf-41b5-89b3-25b3b5abed08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D66C586F30>]}
[0m16:50:11.285239 [info ] [Thread-1 (]: 8 of 13 OK created sql table model JOB_PORTAL.KPI.kpi5 ......................... [[32mSUCCESS 1[0m in 3.08s]
[0m16:50:11.285239 [debug] [Thread-1 (]: Finished running node model.mini_project.kpi5
[0m16:50:11.285239 [debug] [Thread-1 (]: Began running node model.mini_project.kpi6
[0m16:50:11.285239 [info ] [Thread-1 (]: 9 of 13 START sql table model JOB_PORTAL.KPI.kpi6 .............................. [RUN]
[0m16:50:11.301029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.kpi5, now model.mini_project.kpi6)
[0m16:50:11.301029 [debug] [Thread-1 (]: Began compiling node model.mini_project.kpi6
[0m16:50:11.301029 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.kpi6"
[0m16:50:11.301029 [debug] [Thread-1 (]: Timing info for model.mini_project.kpi6 (compile): 16:50:11.301029 => 16:50:11.301029
[0m16:50:11.301029 [debug] [Thread-1 (]: Began executing node model.mini_project.kpi6
[0m16:50:11.301029 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.kpi6"
[0m16:50:11.301029 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.kpi6"
[0m16:50:11.301029 [debug] [Thread-1 (]: On model.mini_project.kpi6: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.kpi6"} */
create or replace transient table JOB_PORTAL.KPI.kpi6
         as
        (
with
  cte_1 as (
    select
      product_id,
      sum(revenue) as revenue
    from
      JOB_PORTAL.PREP.prep_transaction
    where
      revenue_type = 1
    group by
      product_id
  ),
  cte_2 as (
    select
      product_id,
      revenue,
      dense_rank() over (
        order by
          revenue desc
      )
    from
      cte_1
  )
select
  *
from
  cte_2
        );
[0m16:50:11.301029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:50:11.353821 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8d753a6-ceaf-41b5-89b3-25b3b5abed08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D66C587200>]}
[0m16:50:11.354784 [info ] [Thread-2 (]: 7 of 13 OK created sql table model JOB_PORTAL.KPI.kpi1 ......................... [[32mSUCCESS 1[0m in 3.15s]
[0m16:50:11.354784 [debug] [Thread-2 (]: Finished running node model.mini_project.kpi1
[0m16:50:11.354784 [debug] [Thread-2 (]: Began running node model.mini_project.kpi7
[0m16:50:11.354784 [info ] [Thread-2 (]: 10 of 13 START sql table model JOB_PORTAL.KPI.kpi7 ............................. [RUN]
[0m16:50:11.354784 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mini_project.kpi1, now model.mini_project.kpi7)
[0m16:50:11.354784 [debug] [Thread-2 (]: Began compiling node model.mini_project.kpi7
[0m16:50:11.354784 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.kpi7"
[0m16:50:11.354784 [debug] [Thread-2 (]: Timing info for model.mini_project.kpi7 (compile): 16:50:11.354784 => 16:50:11.354784
[0m16:50:11.354784 [debug] [Thread-2 (]: Began executing node model.mini_project.kpi7
[0m16:50:11.354784 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.kpi7"
[0m16:50:11.354784 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.kpi7"
[0m16:50:11.354784 [debug] [Thread-2 (]: On model.mini_project.kpi7: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.kpi7"} */
create or replace transient table JOB_PORTAL.KPI.kpi7
         as
        (
with
  cte_1 as (
    select
      customer_id,
      sum(revenue) as revenue
    from
      JOB_PORTAL.PREP.prep_transaction
    where
      revenue_type = 1
    group by
      customer_id
  ),
  cte_2 as (
    select
      customer_id,
      revenue,
      dense_rank() over (
        order by
          revenue desc
      )
    from
      cte_1
  )
select
  *
from
  cte_2
        );
[0m16:50:11.354784 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:50:13.734916 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:50:13.742626 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:50:13.744477 [debug] [Thread-2 (]: Timing info for model.mini_project.kpi7 (execute): 16:50:11.354784 => 16:50:13.744477
[0m16:50:13.744477 [debug] [Thread-2 (]: On model.mini_project.kpi7: Close
[0m16:50:13.746485 [debug] [Thread-1 (]: Timing info for model.mini_project.kpi6 (execute): 16:50:11.301029 => 16:50:13.746485
[0m16:50:13.746485 [debug] [Thread-1 (]: On model.mini_project.kpi6: Close
[0m16:50:14.406869 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8d753a6-ceaf-41b5-89b3-25b3b5abed08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D66C4FD700>]}
[0m16:50:14.407877 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8d753a6-ceaf-41b5-89b3-25b3b5abed08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D66C4FFF80>]}
[0m16:50:14.407877 [info ] [Thread-2 (]: 10 of 13 OK created sql table model JOB_PORTAL.KPI.kpi7 ........................ [[32mSUCCESS 1[0m in 3.05s]
[0m16:50:14.409878 [debug] [Thread-2 (]: Finished running node model.mini_project.kpi7
[0m16:50:14.410877 [debug] [Thread-2 (]: Began running node model.mini_project.prep_fulldata
[0m16:50:14.408881 [info ] [Thread-1 (]: 9 of 13 OK created sql table model JOB_PORTAL.KPI.kpi6 ......................... [[32mSUCCESS 1[0m in 3.11s]
[0m16:50:14.411894 [debug] [Thread-1 (]: Finished running node model.mini_project.kpi6
[0m16:50:14.410877 [info ] [Thread-2 (]: 11 of 13 START sql table model JOB_PORTAL.PREP.prep_fulldata ................... [RUN]
[0m16:50:14.412880 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mini_project.kpi7, now model.mini_project.prep_fulldata)
[0m16:50:14.413894 [debug] [Thread-2 (]: Began compiling node model.mini_project.prep_fulldata
[0m16:50:14.416876 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.prep_fulldata"
[0m16:50:14.417876 [debug] [Thread-2 (]: Timing info for model.mini_project.prep_fulldata (compile): 16:50:14.413894 => 16:50:14.417876
[0m16:50:14.417876 [debug] [Thread-2 (]: Began executing node model.mini_project.prep_fulldata
[0m16:50:14.421860 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.prep_fulldata"
[0m16:50:14.423966 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.prep_fulldata"
[0m16:50:14.425034 [debug] [Thread-2 (]: On model.mini_project.prep_fulldata: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.prep_fulldata"} */
create or replace transient table JOB_PORTAL.PREP.prep_fulldata
         as
        (
WITH CTE_1 AS(
    SELECT DISTINCT
        ST.CUSTOMER_ID,
        ST.PRODUCT_ID,
        ST.PAYMENT_MONTH,
        ST.REVENUE,
        ST.REVENUE_TYPE,
        ST.QUANTITY,
        CUST.COMPANY AS CUSTOMER_COMPANY,
        CUST.CUSTOMERNAME AS CUSTOMER_NAME,
        PROD.PRODUCT_FAMILY,
        PROD.PRODUCT_SUB_FAMILY
    FROM JOB_PORTAL.PREP.prep_transaction ST
    LEFT JOIN JOB_PORTAL.PREP.prep_customers CUST ON ST.CUSTOMER_ID = CUST.CUSTOMER_ID
    LEFT JOIN JOB_PORTAL.PREP.prep_products PROD ON ST.PRODUCT_ID = PROD.PRODUCT_ID
)
SELECT
     *
FROM
    CTE_1
    WHERE REVENUE_TYPE = 1
        );
[0m16:50:14.425034 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:50:17.382013 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m16:50:17.382013 [debug] [Thread-2 (]: Timing info for model.mini_project.prep_fulldata (execute): 16:50:14.418876 => 16:50:17.382013
[0m16:50:17.382013 [debug] [Thread-2 (]: On model.mini_project.prep_fulldata: Close
[0m16:50:18.056309 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8d753a6-ceaf-41b5-89b3-25b3b5abed08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D66C248350>]}
[0m16:50:18.056309 [info ] [Thread-2 (]: 11 of 13 OK created sql table model JOB_PORTAL.PREP.prep_fulldata .............. [[32mSUCCESS 1[0m in 3.64s]
[0m16:50:18.063735 [debug] [Thread-2 (]: Finished running node model.mini_project.prep_fulldata
[0m16:50:18.063735 [debug] [Thread-1 (]: Began running node model.mini_project.prep_extradata
[0m16:50:18.063735 [info ] [Thread-1 (]: 12 of 13 START sql table model JOB_PORTAL.PREP.prep_extradata .................. [RUN]
[0m16:50:18.063735 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.kpi6, now model.mini_project.prep_extradata)
[0m16:50:18.063735 [debug] [Thread-1 (]: Began compiling node model.mini_project.prep_extradata
[0m16:50:18.063735 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.prep_extradata"
[0m16:50:18.063735 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_extradata (compile): 16:50:18.063735 => 16:50:18.063735
[0m16:50:18.063735 [debug] [Thread-1 (]: Began executing node model.mini_project.prep_extradata
[0m16:50:18.063735 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.prep_extradata"
[0m16:50:18.063735 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.prep_extradata"
[0m16:50:18.063735 [debug] [Thread-1 (]: On model.mini_project.prep_extradata: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.prep_extradata"} */
create or replace transient table JOB_PORTAL.PREP.prep_extradata
         as
        (SELECT CUSTOMER_ID,PRODUCT_ID, LAG(PAYMENT_MONTH)OVER(PARTITION BY CUSTOMER_ID ORDER BY PAYMENT_MONTH) AS LAST_MONTH,PAYMENT_MONTH,REVENUE,SUM(REVENUE)OVER(PARTITION BY PAYMENT_MONTH ORDER BY PAYMENT_MONTH) AS MONTH_REVENUE,CUSTOMER_NAME,PRODUCT_FAMILY,PRODUCT_SUB_FAMILY ,LAG(PRODUCT_FAMILY)OVER(PARTITION BY CUSTOMER_ID,PAYMENT_MONTH
 ORDER BY PAYMENT_MONTH) AS LAST_PRODUCT,LAG(PRODUCT_SUB_FAMILY)OVER(PARTITION BY CUSTOMER_ID,PAYMENT_MONTH ORDER BY PAYMENT_MONTH) AS LAST_PRODUCT_SUB FROM JOB_PORTAL.PREP.prep_fulldata ORDER BY CUSTOMER_ID,PAYMENT_MONTH
        );
[0m16:50:18.063735 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:50:21.463650 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m16:50:21.475212 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_extradata (execute): 16:50:18.063735 => 16:50:21.475212
[0m16:50:21.475212 [debug] [Thread-1 (]: On model.mini_project.prep_extradata: Close
[0m16:50:22.154381 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8d753a6-ceaf-41b5-89b3-25b3b5abed08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D66C400C80>]}
[0m16:50:22.154381 [info ] [Thread-1 (]: 12 of 13 OK created sql table model JOB_PORTAL.PREP.prep_extradata ............. [[32mSUCCESS 1[0m in 4.09s]
[0m16:50:22.154381 [debug] [Thread-1 (]: Finished running node model.mini_project.prep_extradata
[0m16:50:22.154381 [debug] [Thread-2 (]: Began running node model.mini_project.kpi2
[0m16:50:22.154381 [info ] [Thread-2 (]: 13 of 13 START sql table model JOB_PORTAL.KPI.kpi2 ............................. [RUN]
[0m16:50:22.154381 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mini_project.prep_fulldata, now model.mini_project.kpi2)
[0m16:50:22.154381 [debug] [Thread-2 (]: Began compiling node model.mini_project.kpi2
[0m16:50:22.154381 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.kpi2"
[0m16:50:22.154381 [debug] [Thread-2 (]: Timing info for model.mini_project.kpi2 (compile): 16:50:22.154381 => 16:50:22.154381
[0m16:50:22.154381 [debug] [Thread-2 (]: Began executing node model.mini_project.kpi2
[0m16:50:22.154381 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.kpi2"
[0m16:50:22.154381 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.kpi2"
[0m16:50:22.154381 [debug] [Thread-2 (]: On model.mini_project.kpi2: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.kpi2"} */
create or replace transient table JOB_PORTAL.KPI.kpi2
         as
        (
 WITH customer_data AS (
    SELECT
        CUSTOMER_NAME,
        PRODUCT_ID,
        PRODUCT_FAMILY
    FROM
        JOB_PORTAL.PREP.prep_extradata
),
product_count AS (
    SELECT
        CUSTOMER_NAME,
        COUNT(DISTINCT PRODUCT_ID) AS product_count
    FROM
        customer_data
    GROUP BY
        CUSTOMER_NAME
),
product_churn AS (
    SELECT
        CUSTOMER_NAME,
        COUNT(DISTINCT PRODUCT_FAMILY) AS Product_Churn
    FROM
        customer_data
    GROUP BY
        CUSTOMER_NAME
),
ranked_customers AS (
    SELECT
        c.CUSTOMER_NAME,
        c.product_count,
        p.Product_Churn,
        (c.product_count-p.Product_Churn) AS Cross_Sell,
        DENSE_RANK() OVER (ORDER BY c.product_count-p.Product_Churn DESC) AS Cross_Sell_Rank,
        DENSE_RANK() OVER (ORDER BY p.Product_Churn DESC) AS Product_Churn_Rank
    FROM
        product_count c
    JOIN
        product_churn p ON c.CUSTOMER_NAME = p.CUSTOMER_NAME
)
SELECT
    CUSTOMER_NAME,
    product_count,
    Cross_Sell,
    Product_Churn,
    Cross_Sell_Rank,
    Product_Churn_Rank
FROM
    ranked_customers
ORDER BY
    Cross_Sell_Rank,
    Product_Churn_Rank;
[0m16:50:22.170261 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:50:24.247999 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01bb0048-0004-bb9d-0005-d153000191d6
[0m16:50:24.247999 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 54 at position 22 unexpected ';'.
[0m16:50:24.247999 [debug] [Thread-2 (]: Timing info for model.mini_project.kpi2 (execute): 16:50:22.154381 => 16:50:24.247999
[0m16:50:24.247999 [debug] [Thread-2 (]: On model.mini_project.kpi2: Close
[0m16:50:24.931268 [debug] [Thread-2 (]: Database Error in model kpi2 (models\crb\kpi2.sql)
  001003 (42000): SQL compilation error:
  syntax error line 54 at position 22 unexpected ';'.
  compiled Code at target\run\mini_project\models\crb\kpi2.sql
[0m16:50:24.931268 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8d753a6-ceaf-41b5-89b3-25b3b5abed08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D66C553B00>]}
[0m16:50:24.931268 [error] [Thread-2 (]: 13 of 13 ERROR creating sql table model JOB_PORTAL.KPI.kpi2 .................... [[31mERROR[0m in 2.78s]
[0m16:50:24.931268 [debug] [Thread-2 (]: Finished running node model.mini_project.kpi2
[0m16:50:24.931268 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:50:24.931268 [debug] [MainThread]: Connection 'create_JOB_PORTAL_KPI' was properly closed.
[0m16:50:24.931268 [debug] [MainThread]: Connection 'list_JOB_PORTAL' was properly closed.
[0m16:50:24.931268 [debug] [MainThread]: Connection 'list_JOB_PORTAL_PREP' was properly closed.
[0m16:50:24.931268 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was properly closed.
[0m16:50:24.931268 [debug] [MainThread]: Connection 'model.mini_project.prep_extradata' was properly closed.
[0m16:50:24.931268 [debug] [MainThread]: Connection 'model.mini_project.kpi2' was properly closed.
[0m16:50:24.931268 [info ] [MainThread]: 
[0m16:50:24.931268 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 40.67 seconds (40.67s).
[0m16:50:24.946885 [debug] [MainThread]: Command end result
[0m16:50:24.958182 [info ] [MainThread]: 
[0m16:50:24.958182 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:50:24.958182 [info ] [MainThread]: 
[0m16:50:24.958182 [error] [MainThread]:   Database Error in model kpi2 (models\crb\kpi2.sql)
  001003 (42000): SQL compilation error:
  syntax error line 54 at position 22 unexpected ';'.
  compiled Code at target\run\mini_project\models\crb\kpi2.sql
[0m16:50:24.958182 [info ] [MainThread]: 
[0m16:50:24.958182 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=1 SKIP=0 TOTAL=13
[0m16:50:24.958182 [debug] [MainThread]: Command `dbt run` failed at 16:50:24.958182 after 41.60 seconds
[0m16:50:24.958182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D66A152780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D66AF206E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D66AA8A870>]}
[0m16:50:24.958182 [debug] [MainThread]: Flushing usage events
[0m16:50:57.044884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002356A074D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023569E48D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002356A075040>]}


============================== 16:50:57.057525 | 5db8d30c-4185-4bec-b776-d37a0eb7074e ==============================
[0m16:50:57.057525 [info ] [MainThread]: Running with dbt=1.7.19
[0m16:50:57.057525 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\DasariUday\\venv\\.venv\\mini_project\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\DasariUday\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m tag:kpi', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:50:57.501142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5db8d30c-4185-4bec-b776-d37a0eb7074e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002356ADA2240>]}
[0m16:50:57.560848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5db8d30c-4185-4bec-b776-d37a0eb7074e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002356A393EF0>]}
[0m16:50:57.560848 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m16:50:57.570715 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m16:50:57.650391 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:50:57.650391 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:50:57.650391 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project.mart
[0m16:50:57.650391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5db8d30c-4185-4bec-b776-d37a0eb7074e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002356ADD0530>]}
[0m16:50:57.673855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5db8d30c-4185-4bec-b776-d37a0eb7074e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002356BEF8E30>]}
[0m16:50:57.673855 [info ] [MainThread]: Found 13 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m16:50:57.673855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5db8d30c-4185-4bec-b776-d37a0eb7074e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023569D01EB0>]}
[0m16:50:57.673855 [info ] [MainThread]: 
[0m16:50:57.673855 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:50:57.683202 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL'
[0m16:50:57.694458 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL"
[0m16:50:57.694458 [debug] [ThreadPool]: On list_JOB_PORTAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL"} */
show terse schemas in database JOB_PORTAL
    limit 10000
[0m16:50:57.694458 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:51:00.129400 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m16:51:00.131409 [debug] [ThreadPool]: On list_JOB_PORTAL: Close
[0m16:51:00.807285 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL_KPI'
[0m16:51:00.821398 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL_RAW'
[0m16:51:00.823318 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_KPI"
[0m16:51:00.837251 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_RAW"
[0m16:51:00.837251 [debug] [ThreadPool]: On list_JOB_PORTAL_KPI: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_KPI"} */
show terse objects in JOB_PORTAL.KPI limit 10000
[0m16:51:00.837251 [debug] [ThreadPool]: On list_JOB_PORTAL_RAW: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_RAW"} */
show terse objects in JOB_PORTAL.RAW limit 10000
[0m16:51:00.837251 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:51:00.837251 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:51:02.809930 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m16:51:02.809930 [debug] [ThreadPool]: On list_JOB_PORTAL_RAW: Close
[0m16:51:02.850237 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.0 seconds
[0m16:51:02.857948 [debug] [ThreadPool]: On list_JOB_PORTAL_KPI: Close
[0m16:51:03.510609 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JOB_PORTAL_KPI, now list_JOB_PORTAL_PREP)
[0m16:51:03.510609 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_PREP"
[0m16:51:03.510609 [debug] [ThreadPool]: On list_JOB_PORTAL_PREP: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_PREP"} */
show terse objects in JOB_PORTAL.PREP limit 10000
[0m16:51:03.510609 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:51:03.879032 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JOB_PORTAL_RAW, now list_MINI_PROJECT_RAW)
[0m16:51:03.879032 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m16:51:03.879032 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show terse objects in MINI_PROJECT.RAW limit 10000
[0m16:51:03.894917 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:51:05.414845 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m16:51:05.414845 [debug] [ThreadPool]: On list_JOB_PORTAL_PREP: Close
[0m16:51:05.641927 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m16:51:05.643938 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: Close
[0m16:51:06.295221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5db8d30c-4185-4bec-b776-d37a0eb7074e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002356AD00A40>]}
[0m16:51:06.295221 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m16:51:06.304817 [info ] [MainThread]: 
[0m16:51:06.304817 [debug] [Thread-1 (]: Began running node model.mini_project.kpi1
[0m16:51:06.304817 [debug] [Thread-2 (]: Began running node model.mini_project.kpi2
[0m16:51:06.304817 [info ] [Thread-1 (]: 1 of 5 START sql table model JOB_PORTAL.KPI.kpi1 ............................... [RUN]
[0m16:51:06.304817 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project.kpi1'
[0m16:51:06.304817 [info ] [Thread-2 (]: 2 of 5 START sql table model JOB_PORTAL.KPI.kpi2 ............................... [RUN]
[0m16:51:06.312091 [debug] [Thread-1 (]: Began compiling node model.mini_project.kpi1
[0m16:51:06.313596 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.mini_project.kpi2'
[0m16:51:06.317688 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.kpi1"
[0m16:51:06.317688 [debug] [Thread-2 (]: Began compiling node model.mini_project.kpi2
[0m16:51:06.326064 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.kpi2"
[0m16:51:06.328117 [debug] [Thread-1 (]: Timing info for model.mini_project.kpi1 (compile): 16:51:06.313596 => 16:51:06.328117
[0m16:51:06.329129 [debug] [Thread-2 (]: Timing info for model.mini_project.kpi2 (compile): 16:51:06.317688 => 16:51:06.329129
[0m16:51:06.329129 [debug] [Thread-1 (]: Began executing node model.mini_project.kpi1
[0m16:51:06.330157 [debug] [Thread-2 (]: Began executing node model.mini_project.kpi2
[0m16:51:06.359385 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.kpi1"
[0m16:51:06.360887 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.kpi2"
[0m16:51:06.360887 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.kpi1"
[0m16:51:06.360887 [debug] [Thread-1 (]: On model.mini_project.kpi1: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.kpi1"} */
create or replace transient table JOB_PORTAL.KPI.kpi1
         as
        (
WITH
  CTE_1 AS (
    SELECT
      MAX(PAYMENT_MONTH) AS EOP
    FROM
      JOB_PORTAL.PREP.prep_transaction
  ),
  CTE_2 AS (
    SELECT
      *
    FROM
      JOB_PORTAL.PREP.prep_transaction
      INNER JOIN CTE_1 AS CT ON 1 = 1
  ),
  CTE_3 AS (
    SELECT
      CUSTOMER_ID,
      MAX(PAYMENT_MONTH) AS LATEST,
      MIN(PAYMENT_MONTH) AS FIRST,
      DATEADD (MONTH, -3, EOP) AS L3M,
      EOP,
      CASE
        WHEN (FIRST <= L3M) THEN 0
        ELSE 1
      END AS IS_NEW,
      CASE
        WHEN (
          FIRST <= L3M
          AND LATEST < EOP
        ) THEN 1
        ELSE 0
      END AS IS_CHURN
    FROM
      CTE_2
    GROUP BY
      CUSTOMER_ID,
      EOP
  )
SELECT
  SUM(IS_CHURN) AS CHURNED_CUSTOMERS,
  SUM(IS_NEW) AS NEW_CUSTOMERS,
  EOP
FROM
  CTE_3
GROUP BY
  EOP
        );
[0m16:51:06.360887 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:51:06.360887 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.kpi2"
[0m16:51:06.370747 [debug] [Thread-2 (]: On model.mini_project.kpi2: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.kpi2"} */
create or replace transient table JOB_PORTAL.KPI.kpi2
         as
        (
 WITH customer_data AS (
    SELECT
        CUSTOMER_NAME,
        PRODUCT_ID,
        PRODUCT_FAMILY
    FROM
        JOB_PORTAL.PREP.prep_extradata
),
product_count AS (
    SELECT
        CUSTOMER_NAME,
        COUNT(DISTINCT PRODUCT_ID) AS product_count
    FROM
        customer_data
    GROUP BY
        CUSTOMER_NAME
),
product_churn AS (
    SELECT
        CUSTOMER_NAME,
        COUNT(DISTINCT PRODUCT_FAMILY) AS Product_Churn
    FROM
        customer_data
    GROUP BY
        CUSTOMER_NAME
),
ranked_customers AS (
    SELECT
        c.CUSTOMER_NAME,
        c.product_count,
        p.Product_Churn,
        (c.product_count-p.Product_Churn) AS Cross_Sell,
        DENSE_RANK() OVER (ORDER BY c.product_count-p.Product_Churn DESC) AS Cross_Sell_Rank,
        DENSE_RANK() OVER (ORDER BY p.Product_Churn DESC) AS Product_Churn_Rank
    FROM
        product_count c
    JOIN
        product_churn p ON c.CUSTOMER_NAME = p.CUSTOMER_NAME
)
SELECT
    CUSTOMER_NAME,
    product_count,
    Cross_Sell,
    Product_Churn,
    Cross_Sell_Rank,
    Product_Churn_Rank
FROM
    ranked_customers
ORDER BY
    Cross_Sell_Rank,
    Product_Churn_Rank
        );
[0m16:51:06.370747 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:51:08.908451 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m16:51:08.940423 [debug] [Thread-2 (]: Timing info for model.mini_project.kpi2 (execute): 16:51:06.360887 => 16:51:08.940423
[0m16:51:08.940423 [debug] [Thread-2 (]: On model.mini_project.kpi2: Close
[0m16:51:08.956139 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m16:51:08.956139 [debug] [Thread-1 (]: Timing info for model.mini_project.kpi1 (execute): 16:51:06.330157 => 16:51:08.956139
[0m16:51:08.971962 [debug] [Thread-1 (]: On model.mini_project.kpi1: Close
[0m16:51:09.616944 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5db8d30c-4185-4bec-b776-d37a0eb7074e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002356C348830>]}
[0m16:51:09.616944 [info ] [Thread-2 (]: 2 of 5 OK created sql table model JOB_PORTAL.KPI.kpi2 .......................... [[32mSUCCESS 1[0m in 3.30s]
[0m16:51:09.616944 [debug] [Thread-2 (]: Finished running node model.mini_project.kpi2
[0m16:51:09.616944 [debug] [Thread-2 (]: Began running node model.mini_project.kpi5
[0m16:51:09.616944 [info ] [Thread-2 (]: 3 of 5 START sql table model JOB_PORTAL.KPI.kpi5 ............................... [RUN]
[0m16:51:09.620382 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mini_project.kpi2, now model.mini_project.kpi5)
[0m16:51:09.620382 [debug] [Thread-2 (]: Began compiling node model.mini_project.kpi5
[0m16:51:09.624395 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.kpi5"
[0m16:51:09.624395 [debug] [Thread-2 (]: Timing info for model.mini_project.kpi5 (compile): 16:51:09.620382 => 16:51:09.624395
[0m16:51:09.624395 [debug] [Thread-2 (]: Began executing node model.mini_project.kpi5
[0m16:51:09.628414 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.kpi5"
[0m16:51:09.628414 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.kpi5"
[0m16:51:09.628414 [debug] [Thread-2 (]: On model.mini_project.kpi5: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.kpi5"} */
create or replace transient table JOB_PORTAL.KPI.kpi5
         as
        (
WITH CTE_1 AS(
  SELECT 
    CUSTOMER_ID, 
    MIN(PAYMENT_MONTH) AS FIRST_MONTH 
  FROM 
    JOB_PORTAL.PREP.prep_transaction 
  GROUP BY 
    CUSTOMER_ID
) 
SELECT 
  DISTINCT DATE_TRUNC('YEAR', FIRST_MONTH) AS FISCAL_YEAR, 
  (
    COUNT(CUSTOMER_ID)
  ) AS NEW_CUSTOMERS 
FROM 
  CTE_1 
GROUP BY 
  FISCAL_YEAR
        );
[0m16:51:09.631574 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:51:09.631574 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5db8d30c-4185-4bec-b776-d37a0eb7074e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002356C217FB0>]}
[0m16:51:09.631574 [info ] [Thread-1 (]: 1 of 5 OK created sql table model JOB_PORTAL.KPI.kpi1 .......................... [[32mSUCCESS 1[0m in 3.33s]
[0m16:51:09.635793 [debug] [Thread-1 (]: Finished running node model.mini_project.kpi1
[0m16:51:09.636587 [debug] [Thread-1 (]: Began running node model.mini_project.kpi6
[0m16:51:09.637203 [info ] [Thread-1 (]: 4 of 5 START sql table model JOB_PORTAL.KPI.kpi6 ............................... [RUN]
[0m16:51:09.638665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.kpi1, now model.mini_project.kpi6)
[0m16:51:09.639664 [debug] [Thread-1 (]: Began compiling node model.mini_project.kpi6
[0m16:51:09.640697 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.kpi6"
[0m16:51:09.640697 [debug] [Thread-1 (]: Timing info for model.mini_project.kpi6 (compile): 16:51:09.639664 => 16:51:09.640697
[0m16:51:09.640697 [debug] [Thread-1 (]: Began executing node model.mini_project.kpi6
[0m16:51:09.646899 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.kpi6"
[0m16:51:09.649204 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.kpi6"
[0m16:51:09.649204 [debug] [Thread-1 (]: On model.mini_project.kpi6: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.kpi6"} */
create or replace transient table JOB_PORTAL.KPI.kpi6
         as
        (
with
  cte_1 as (
    select
      product_id,
      sum(revenue) as revenue
    from
      JOB_PORTAL.PREP.prep_transaction
    where
      revenue_type = 1
    group by
      product_id
  ),
  cte_2 as (
    select
      product_id,
      revenue,
      dense_rank() over (
        order by
          revenue desc
      )
    from
      cte_1
  )
select
  *
from
  cte_2
        );
[0m16:51:09.650237 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:51:12.180899 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m16:51:12.180899 [debug] [Thread-1 (]: Timing info for model.mini_project.kpi6 (execute): 16:51:09.640697 => 16:51:12.180899
[0m16:51:12.180899 [debug] [Thread-1 (]: On model.mini_project.kpi6: Close
[0m16:51:12.272118 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m16:51:12.272118 [debug] [Thread-2 (]: Timing info for model.mini_project.kpi5 (execute): 16:51:09.624395 => 16:51:12.272118
[0m16:51:12.272118 [debug] [Thread-2 (]: On model.mini_project.kpi5: Close
[0m16:51:12.839732 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5db8d30c-4185-4bec-b776-d37a0eb7074e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002356C3491C0>]}
[0m16:51:12.839732 [info ] [Thread-1 (]: 4 of 5 OK created sql table model JOB_PORTAL.KPI.kpi6 .......................... [[32mSUCCESS 1[0m in 3.20s]
[0m16:51:12.839732 [debug] [Thread-1 (]: Finished running node model.mini_project.kpi6
[0m16:51:12.839732 [debug] [Thread-1 (]: Began running node model.mini_project.kpi7
[0m16:51:12.839732 [info ] [Thread-1 (]: 5 of 5 START sql table model JOB_PORTAL.KPI.kpi7 ............................... [RUN]
[0m16:51:12.839732 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.kpi6, now model.mini_project.kpi7)
[0m16:51:12.839732 [debug] [Thread-1 (]: Began compiling node model.mini_project.kpi7
[0m16:51:12.839732 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.kpi7"
[0m16:51:12.839732 [debug] [Thread-1 (]: Timing info for model.mini_project.kpi7 (compile): 16:51:12.839732 => 16:51:12.839732
[0m16:51:12.839732 [debug] [Thread-1 (]: Began executing node model.mini_project.kpi7
[0m16:51:12.839732 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.kpi7"
[0m16:51:12.839732 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.kpi7"
[0m16:51:12.839732 [debug] [Thread-1 (]: On model.mini_project.kpi7: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.kpi7"} */
create or replace transient table JOB_PORTAL.KPI.kpi7
         as
        (
with
  cte_1 as (
    select
      customer_id,
      sum(revenue) as revenue
    from
      JOB_PORTAL.PREP.prep_transaction
    where
      revenue_type = 1
    group by
      customer_id
  ),
  cte_2 as (
    select
      customer_id,
      revenue,
      dense_rank() over (
        order by
          revenue desc
      )
    from
      cte_1
  )
select
  *
from
  cte_2
        );
[0m16:51:12.855540 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:51:12.932834 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5db8d30c-4185-4bec-b776-d37a0eb7074e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002356C217DD0>]}
[0m16:51:12.932834 [info ] [Thread-2 (]: 3 of 5 OK created sql table model JOB_PORTAL.KPI.kpi5 .......................... [[32mSUCCESS 1[0m in 3.31s]
[0m16:51:12.948720 [debug] [Thread-2 (]: Finished running node model.mini_project.kpi5
[0m16:51:15.588966 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m16:51:15.588966 [debug] [Thread-1 (]: Timing info for model.mini_project.kpi7 (execute): 16:51:12.839732 => 16:51:15.588966
[0m16:51:15.588966 [debug] [Thread-1 (]: On model.mini_project.kpi7: Close
[0m16:51:16.267317 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5db8d30c-4185-4bec-b776-d37a0eb7074e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002356C1DEE10>]}
[0m16:51:16.267317 [info ] [Thread-1 (]: 5 of 5 OK created sql table model JOB_PORTAL.KPI.kpi7 .......................... [[32mSUCCESS 1[0m in 3.43s]
[0m16:51:16.267317 [debug] [Thread-1 (]: Finished running node model.mini_project.kpi7
[0m16:51:16.267317 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:51:16.267317 [debug] [MainThread]: Connection 'list_JOB_PORTAL' was properly closed.
[0m16:51:16.267317 [debug] [MainThread]: Connection 'list_JOB_PORTAL_PREP' was properly closed.
[0m16:51:16.267317 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was properly closed.
[0m16:51:16.267317 [debug] [MainThread]: Connection 'model.mini_project.kpi7' was properly closed.
[0m16:51:16.267317 [debug] [MainThread]: Connection 'model.mini_project.kpi5' was properly closed.
[0m16:51:16.267317 [info ] [MainThread]: 
[0m16:51:16.267317 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 18.59 seconds (18.59s).
[0m16:51:16.277904 [debug] [MainThread]: Command end result
[0m16:51:16.290739 [info ] [MainThread]: 
[0m16:51:16.291735 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:51:16.291735 [info ] [MainThread]: 
[0m16:51:16.292736 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m16:51:16.293737 [debug] [MainThread]: Command `dbt run` succeeded at 16:51:16.293737 after 19.38 seconds
[0m16:51:16.293737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023569E48D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002356C05FBF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023566178D40>]}
[0m16:51:16.293737 [debug] [MainThread]: Flushing usage events
[0m16:52:49.541264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002054CE47E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002054CE46000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002054CE45220>]}


============================== 16:52:49.559789 | 760f0ce9-5b90-4ea9-9a0d-8b97b00e6df9 ==============================
[0m16:52:49.559789 [info ] [MainThread]: Running with dbt=1.7.19
[0m16:52:49.559789 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\DasariUday\\venv\\.venv\\mini_project\\logs', 'profiles_dir': 'C:\\Users\\DasariUday\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m kpi2', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:52:50.027197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '760f0ce9-5b90-4ea9-9a0d-8b97b00e6df9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002054EC05EE0>]}
[0m16:52:50.094331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '760f0ce9-5b90-4ea9-9a0d-8b97b00e6df9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002054C3255E0>]}
[0m16:52:50.094331 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m16:52:50.106961 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m16:52:50.194790 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:52:50.194790 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:52:50.194790 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project.mart
[0m16:52:50.194790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '760f0ce9-5b90-4ea9-9a0d-8b97b00e6df9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002054D8DE720>]}
[0m16:52:50.216913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '760f0ce9-5b90-4ea9-9a0d-8b97b00e6df9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002054ECF8080>]}
[0m16:52:50.216913 [info ] [MainThread]: Found 13 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m16:52:50.216913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '760f0ce9-5b90-4ea9-9a0d-8b97b00e6df9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002054D1DA930>]}
[0m16:52:50.216913 [info ] [MainThread]: 
[0m16:52:50.216913 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:52:50.216913 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL'
[0m16:52:50.236013 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL"
[0m16:52:50.236013 [debug] [ThreadPool]: On list_JOB_PORTAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL"} */
show terse schemas in database JOB_PORTAL
    limit 10000
[0m16:52:50.236013 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:52:52.368261 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m16:52:52.368261 [debug] [ThreadPool]: On list_JOB_PORTAL: Close
[0m16:52:53.022796 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL_RAW'
[0m16:52:53.032557 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_RAW"
[0m16:52:53.032557 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL_KPI'
[0m16:52:53.032557 [debug] [ThreadPool]: On list_JOB_PORTAL_RAW: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_RAW"} */
show terse objects in JOB_PORTAL.RAW limit 10000
[0m16:52:53.034562 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_KPI"
[0m16:52:53.036567 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:52:53.036567 [debug] [ThreadPool]: On list_JOB_PORTAL_KPI: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_KPI"} */
show terse objects in JOB_PORTAL.KPI limit 10000
[0m16:52:53.036567 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:52:54.924833 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m16:52:54.924833 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m16:52:54.924833 [debug] [ThreadPool]: On list_JOB_PORTAL_RAW: Close
[0m16:52:54.941023 [debug] [ThreadPool]: On list_JOB_PORTAL_KPI: Close
[0m16:52:55.620817 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JOB_PORTAL_KPI, now list_MINI_PROJECT_RAW)
[0m16:52:55.620817 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m16:52:55.620817 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show terse objects in MINI_PROJECT.RAW limit 10000
[0m16:52:55.620817 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:52:55.946271 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JOB_PORTAL_RAW, now list_JOB_PORTAL_PREP)
[0m16:52:55.946271 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_PREP"
[0m16:52:55.946271 [debug] [ThreadPool]: On list_JOB_PORTAL_PREP: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_PREP"} */
show terse objects in JOB_PORTAL.PREP limit 10000
[0m16:52:55.946271 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:52:57.436612 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m16:52:57.451602 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: Close
[0m16:52:57.806549 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m16:52:57.806549 [debug] [ThreadPool]: On list_JOB_PORTAL_PREP: Close
[0m16:52:58.484089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '760f0ce9-5b90-4ea9-9a0d-8b97b00e6df9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002054DBC3FE0>]}
[0m16:52:58.485089 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m16:52:58.486091 [info ] [MainThread]: 
[0m16:52:58.486804 [debug] [Thread-1 (]: Began running node model.mini_project.kpi2
[0m16:52:58.486804 [info ] [Thread-1 (]: 1 of 1 START sql table model JOB_PORTAL.KPI.kpi2 ............................... [RUN]
[0m16:52:58.486804 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project.kpi2'
[0m16:52:58.492597 [debug] [Thread-1 (]: Began compiling node model.mini_project.kpi2
[0m16:52:58.497602 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.kpi2"
[0m16:52:58.497602 [debug] [Thread-1 (]: Timing info for model.mini_project.kpi2 (compile): 16:52:58.492597 => 16:52:58.497602
[0m16:52:58.497602 [debug] [Thread-1 (]: Began executing node model.mini_project.kpi2
[0m16:52:58.527719 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.kpi2"
[0m16:52:58.527719 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.kpi2"
[0m16:52:58.537592 [debug] [Thread-1 (]: On model.mini_project.kpi2: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.kpi2"} */
create or replace transient table JOB_PORTAL.KPI.kpi2
         as
        (
 WITH customer_data AS (
    SELECT
        CUSTOMER_NAME,
        PRODUCT_ID,
        PRODUCT_FAMILY
    FROM
        JOB_PORTAL.PREP.prep_fulldata
),
product_count AS (
    SELECT
        CUSTOMER_NAME,
        COUNT(DISTINCT PRODUCT_ID) AS product_count
    FROM
        customer_data
    GROUP BY
        CUSTOMER_NAME
),
product_churn AS (
    SELECT
        CUSTOMER_NAME,
        COUNT(DISTINCT PRODUCT_FAMILY) AS Product_Churn
    FROM
        customer_data
    GROUP BY
        CUSTOMER_NAME
),
ranked_customers AS (
    SELECT
        c.CUSTOMER_NAME,
        c.product_count,
        p.Product_Churn,
        (c.product_count-p.Product_Churn) AS Cross_Sell,
        DENSE_RANK() OVER (ORDER BY c.product_count-p.Product_Churn DESC) AS Cross_Sell_Rank,
        DENSE_RANK() OVER (ORDER BY p.Product_Churn DESC) AS Product_Churn_Rank
    FROM
        product_count c
    JOIN
        product_churn p ON c.CUSTOMER_NAME = p.CUSTOMER_NAME
)
SELECT
    CUSTOMER_NAME,
    product_count,
    Cross_Sell,
    Product_Churn,
    Cross_Sell_Rank,
    Product_Churn_Rank
FROM
    ranked_customers
ORDER BY
    Cross_Sell_Rank,
    Product_Churn_Rank
        );
[0m16:52:58.538601 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:53:01.222982 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m16:53:01.250996 [debug] [Thread-1 (]: Timing info for model.mini_project.kpi2 (execute): 16:52:58.503854 => 16:53:01.250996
[0m16:53:01.250996 [debug] [Thread-1 (]: On model.mini_project.kpi2: Close
[0m16:53:01.897980 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '760f0ce9-5b90-4ea9-9a0d-8b97b00e6df9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002054EF78740>]}
[0m16:53:01.897980 [info ] [Thread-1 (]: 1 of 1 OK created sql table model JOB_PORTAL.KPI.kpi2 .......................... [[32mSUCCESS 1[0m in 3.41s]
[0m16:53:01.897980 [debug] [Thread-1 (]: Finished running node model.mini_project.kpi2
[0m16:53:01.897980 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:53:01.897980 [debug] [MainThread]: Connection 'list_JOB_PORTAL' was properly closed.
[0m16:53:01.897980 [debug] [MainThread]: Connection 'list_JOB_PORTAL_PREP' was properly closed.
[0m16:53:01.897980 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was properly closed.
[0m16:53:01.897980 [debug] [MainThread]: Connection 'model.mini_project.kpi2' was properly closed.
[0m16:53:01.897980 [info ] [MainThread]: 
[0m16:53:01.897980 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.68 seconds (11.68s).
[0m16:53:01.913400 [debug] [MainThread]: Command end result
[0m16:53:01.925381 [info ] [MainThread]: 
[0m16:53:01.927751 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:53:01.927751 [info ] [MainThread]: 
[0m16:53:01.928765 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:53:01.929751 [debug] [MainThread]: Command `dbt run` succeeded at 16:53:01.929751 after 12.52 seconds
[0m16:53:01.930750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002054DA3CBF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002054EE53320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002054BD24200>]}
[0m16:53:01.930750 [debug] [MainThread]: Flushing usage events
[0m18:00:31.167964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210C2ECF560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210C2ECF110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210C2ECDA30>]}


============================== 18:00:31.180082 | 8e2d451d-e799-4067-b8c9-19790d3c0d39 ==============================
[0m18:00:31.180082 [info ] [MainThread]: Running with dbt=1.7.19
[0m18:00:31.180082 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\DasariUday\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\DasariUday\\venv\\.venv\\mini_project\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:00:31.566014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e2d451d-e799-4067-b8c9-19790d3c0d39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210C3B62330>]}
[0m18:00:31.623199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e2d451d-e799-4067-b8c9-19790d3c0d39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210C1D84050>]}
[0m18:00:31.625205 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m18:00:31.625205 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m18:00:31.706893 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:00:31.706893 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:00:31.722617 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project.mart
[0m18:00:31.722617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e2d451d-e799-4067-b8c9-19790d3c0d39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210C1D844A0>]}
[0m18:00:31.722617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e2d451d-e799-4067-b8c9-19790d3c0d39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210C4DBB980>]}
[0m18:00:31.722617 [info ] [MainThread]: Found 14 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m18:00:31.722617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e2d451d-e799-4067-b8c9-19790d3c0d39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210C4DBB5F0>]}
[0m18:00:31.736524 [info ] [MainThread]: 
[0m18:00:31.737522 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:00:31.739577 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL_KPI'
[0m18:00:31.741184 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_KPI"
[0m18:00:31.756371 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m18:00:31.757396 [debug] [ThreadPool]: On list_JOB_PORTAL_KPI: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_KPI"} */
show terse objects in JOB_PORTAL.KPI limit 10000
[0m18:00:31.759863 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m18:00:31.760913 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:31.760913 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show terse objects in MINI_PROJECT.RAW limit 10000
[0m18:00:31.762946 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:34.102946 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m18:00:34.102946 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: Close
[0m18:00:34.116041 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m18:00:34.116041 [debug] [ThreadPool]: On list_JOB_PORTAL_KPI: Close
[0m18:00:34.760185 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_RAW, now list_JOB_PORTAL_PREP)
[0m18:00:34.760185 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_PREP"
[0m18:00:34.760185 [debug] [ThreadPool]: On list_JOB_PORTAL_PREP: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_PREP"} */
show terse objects in JOB_PORTAL.PREP limit 10000
[0m18:00:34.760185 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:34.760185 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JOB_PORTAL_KPI, now list_JOB_PORTAL_RAW)
[0m18:00:34.775964 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_RAW"
[0m18:00:34.775964 [debug] [ThreadPool]: On list_JOB_PORTAL_RAW: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_RAW"} */
show terse objects in JOB_PORTAL.RAW limit 10000
[0m18:00:34.775964 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:36.625486 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m18:00:36.625486 [debug] [ThreadPool]: On list_JOB_PORTAL_PREP: Close
[0m18:00:36.661342 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m18:00:36.661342 [debug] [ThreadPool]: On list_JOB_PORTAL_RAW: Close
[0m18:00:37.431168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e2d451d-e799-4067-b8c9-19790d3c0d39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210C4DBB7A0>]}
[0m18:00:37.431168 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:00:37.431168 [info ] [MainThread]: 
[0m18:00:37.431168 [debug] [Thread-1 (]: Began running node model.mini_project.raw_customers
[0m18:00:37.431168 [debug] [Thread-2 (]: Began running node model.mini_project.raw_products
[0m18:00:37.431168 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project.raw_customers'
[0m18:00:37.431168 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.mini_project.raw_products'
[0m18:00:37.431168 [debug] [Thread-1 (]: Began compiling node model.mini_project.raw_customers
[0m18:00:37.431168 [debug] [Thread-2 (]: Began compiling node model.mini_project.raw_products
[0m18:00:37.453502 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.raw_customers"
[0m18:00:37.453502 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.raw_products"
[0m18:00:37.453502 [debug] [Thread-2 (]: Timing info for model.mini_project.raw_products (compile): 18:00:37.446959 => 18:00:37.453502
[0m18:00:37.453502 [debug] [Thread-2 (]: Began executing node model.mini_project.raw_products
[0m18:00:37.453502 [debug] [Thread-2 (]: Timing info for model.mini_project.raw_products (execute): 18:00:37.453502 => 18:00:37.453502
[0m18:00:37.461993 [debug] [Thread-2 (]: Finished running node model.mini_project.raw_products
[0m18:00:37.463004 [debug] [Thread-1 (]: Timing info for model.mini_project.raw_customers (compile): 18:00:37.431168 => 18:00:37.463004
[0m18:00:37.463787 [debug] [Thread-2 (]: Began running node model.mini_project.raw_transaction
[0m18:00:37.465337 [debug] [Thread-1 (]: Began executing node model.mini_project.raw_customers
[0m18:00:37.465337 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mini_project.raw_products, now model.mini_project.raw_transaction)
[0m18:00:37.466376 [debug] [Thread-1 (]: Timing info for model.mini_project.raw_customers (execute): 18:00:37.466376 => 18:00:37.466376
[0m18:00:37.466376 [debug] [Thread-2 (]: Began compiling node model.mini_project.raw_transaction
[0m18:00:37.467375 [debug] [Thread-1 (]: Finished running node model.mini_project.raw_customers
[0m18:00:37.470381 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.raw_transaction"
[0m18:00:37.470381 [debug] [Thread-1 (]: Began running node seed.mini_project.mapping
[0m18:00:37.470381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.raw_customers, now seed.mini_project.mapping)
[0m18:00:37.470381 [debug] [Thread-1 (]: Began compiling node seed.mini_project.mapping
[0m18:00:37.470381 [debug] [Thread-1 (]: Timing info for seed.mini_project.mapping (compile): 18:00:37.470381 => 18:00:37.470381
[0m18:00:37.470381 [debug] [Thread-1 (]: Began executing node seed.mini_project.mapping
[0m18:00:37.470381 [debug] [Thread-1 (]: Timing info for seed.mini_project.mapping (execute): 18:00:37.470381 => 18:00:37.470381
[0m18:00:37.470381 [debug] [Thread-1 (]: Finished running node seed.mini_project.mapping
[0m18:00:37.470381 [debug] [Thread-1 (]: Began running node model.mini_project.prep_products
[0m18:00:37.470381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.mini_project.mapping, now model.mini_project.prep_products)
[0m18:00:37.470381 [debug] [Thread-1 (]: Began compiling node model.mini_project.prep_products
[0m18:00:37.480737 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.prep_products"
[0m18:00:37.480737 [debug] [Thread-2 (]: Timing info for model.mini_project.raw_transaction (compile): 18:00:37.468376 => 18:00:37.480737
[0m18:00:37.480737 [debug] [Thread-2 (]: Began executing node model.mini_project.raw_transaction
[0m18:00:37.480737 [debug] [Thread-2 (]: Timing info for model.mini_project.raw_transaction (execute): 18:00:37.480737 => 18:00:37.480737
[0m18:00:37.480737 [debug] [Thread-2 (]: Finished running node model.mini_project.raw_transaction
[0m18:00:37.480737 [debug] [Thread-2 (]: Began running node model.mini_project.prep_customers
[0m18:00:37.480737 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mini_project.raw_transaction, now model.mini_project.prep_customers)
[0m18:00:37.480737 [debug] [Thread-2 (]: Began compiling node model.mini_project.prep_customers
[0m18:00:37.480737 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.prep_customers"
[0m18:00:37.480737 [debug] [Thread-2 (]: Timing info for model.mini_project.prep_customers (compile): 18:00:37.480737 => 18:00:37.480737
[0m18:00:37.480737 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_products (compile): 18:00:37.470381 => 18:00:37.480737
[0m18:00:37.480737 [debug] [Thread-2 (]: Began executing node model.mini_project.prep_customers
[0m18:00:37.480737 [debug] [Thread-1 (]: Began executing node model.mini_project.prep_products
[0m18:00:37.480737 [debug] [Thread-2 (]: Timing info for model.mini_project.prep_customers (execute): 18:00:37.480737 => 18:00:37.480737
[0m18:00:37.495398 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_products (execute): 18:00:37.480737 => 18:00:37.480737
[0m18:00:37.497388 [debug] [Thread-2 (]: Finished running node model.mini_project.prep_customers
[0m18:00:37.497388 [debug] [Thread-1 (]: Finished running node model.mini_project.prep_products
[0m18:00:37.497388 [debug] [Thread-2 (]: Began running node model.mini_project.prep_transaction
[0m18:00:37.497388 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mini_project.prep_customers, now model.mini_project.prep_transaction)
[0m18:00:37.497388 [debug] [Thread-2 (]: Began compiling node model.mini_project.prep_transaction
[0m18:00:37.497388 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.prep_transaction"
[0m18:00:37.497388 [debug] [Thread-2 (]: Timing info for model.mini_project.prep_transaction (compile): 18:00:37.497388 => 18:00:37.497388
[0m18:00:37.497388 [debug] [Thread-2 (]: Began executing node model.mini_project.prep_transaction
[0m18:00:37.497388 [debug] [Thread-2 (]: Timing info for model.mini_project.prep_transaction (execute): 18:00:37.497388 => 18:00:37.497388
[0m18:00:37.497388 [debug] [Thread-2 (]: Finished running node model.mini_project.prep_transaction
[0m18:00:37.497388 [debug] [Thread-1 (]: Began running node model.mini_project.churn_and_newcustomers
[0m18:00:37.497388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.prep_products, now model.mini_project.churn_and_newcustomers)
[0m18:00:37.497388 [debug] [Thread-1 (]: Began compiling node model.mini_project.churn_and_newcustomers
[0m18:00:37.513108 [debug] [Thread-2 (]: Began running node model.mini_project.customer_rank
[0m18:00:37.514102 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.churn_and_newcustomers"
[0m18:00:37.514102 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mini_project.prep_transaction, now model.mini_project.customer_rank)
[0m18:00:37.515084 [debug] [Thread-2 (]: Began compiling node model.mini_project.customer_rank
[0m18:00:37.518102 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.customer_rank"
[0m18:00:37.519840 [debug] [Thread-1 (]: Timing info for model.mini_project.churn_and_newcustomers (compile): 18:00:37.497388 => 18:00:37.519840
[0m18:00:37.520869 [debug] [Thread-1 (]: Began executing node model.mini_project.churn_and_newcustomers
[0m18:00:37.520869 [debug] [Thread-2 (]: Timing info for model.mini_project.customer_rank (compile): 18:00:37.515084 => 18:00:37.520869
[0m18:00:37.521843 [debug] [Thread-1 (]: Timing info for model.mini_project.churn_and_newcustomers (execute): 18:00:37.520869 => 18:00:37.521843
[0m18:00:37.521843 [debug] [Thread-2 (]: Began executing node model.mini_project.customer_rank
[0m18:00:37.522840 [debug] [Thread-1 (]: Finished running node model.mini_project.churn_and_newcustomers
[0m18:00:37.523841 [debug] [Thread-2 (]: Timing info for model.mini_project.customer_rank (execute): 18:00:37.522840 => 18:00:37.522840
[0m18:00:37.523841 [debug] [Thread-1 (]: Began running node model.mini_project.fiscal_year_logos
[0m18:00:37.524840 [debug] [Thread-2 (]: Finished running node model.mini_project.customer_rank
[0m18:00:37.525844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.churn_and_newcustomers, now model.mini_project.fiscal_year_logos)
[0m18:00:37.525844 [debug] [Thread-2 (]: Began running node model.mini_project.monthly_loss
[0m18:00:37.526841 [debug] [Thread-1 (]: Began compiling node model.mini_project.fiscal_year_logos
[0m18:00:37.527841 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mini_project.customer_rank, now model.mini_project.monthly_loss)
[0m18:00:37.531058 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.fiscal_year_logos"
[0m18:00:37.531058 [debug] [Thread-2 (]: Began compiling node model.mini_project.monthly_loss
[0m18:00:37.534026 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.monthly_loss"
[0m18:00:37.535024 [debug] [Thread-2 (]: Timing info for model.mini_project.monthly_loss (compile): 18:00:37.532026 => 18:00:37.535024
[0m18:00:37.536026 [debug] [Thread-2 (]: Began executing node model.mini_project.monthly_loss
[0m18:00:37.536026 [debug] [Thread-2 (]: Timing info for model.mini_project.monthly_loss (execute): 18:00:37.536026 => 18:00:37.536026
[0m18:00:37.537026 [debug] [Thread-2 (]: Finished running node model.mini_project.monthly_loss
[0m18:00:37.538025 [debug] [Thread-2 (]: Began running node model.mini_project.prep_fulldata
[0m18:00:37.538025 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mini_project.monthly_loss, now model.mini_project.prep_fulldata)
[0m18:00:37.539026 [debug] [Thread-2 (]: Began compiling node model.mini_project.prep_fulldata
[0m18:00:37.542025 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.prep_fulldata"
[0m18:00:37.543026 [debug] [Thread-1 (]: Timing info for model.mini_project.fiscal_year_logos (compile): 18:00:37.527841 => 18:00:37.542025
[0m18:00:37.543026 [debug] [Thread-1 (]: Began executing node model.mini_project.fiscal_year_logos
[0m18:00:37.543026 [debug] [Thread-1 (]: Timing info for model.mini_project.fiscal_year_logos (execute): 18:00:37.543026 => 18:00:37.543026
[0m18:00:37.544061 [debug] [Thread-1 (]: Finished running node model.mini_project.fiscal_year_logos
[0m18:00:37.545027 [debug] [Thread-1 (]: Began running node model.mini_project.product_rank
[0m18:00:37.546027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.fiscal_year_logos, now model.mini_project.product_rank)
[0m18:00:37.546027 [debug] [Thread-1 (]: Began compiling node model.mini_project.product_rank
[0m18:00:37.546027 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.product_rank"
[0m18:00:37.546027 [debug] [Thread-2 (]: Timing info for model.mini_project.prep_fulldata (compile): 18:00:37.539026 => 18:00:37.546027
[0m18:00:37.546027 [debug] [Thread-2 (]: Began executing node model.mini_project.prep_fulldata
[0m18:00:37.546027 [debug] [Thread-2 (]: Timing info for model.mini_project.prep_fulldata (execute): 18:00:37.546027 => 18:00:37.546027
[0m18:00:37.546027 [debug] [Thread-2 (]: Finished running node model.mini_project.prep_fulldata
[0m18:00:37.546027 [debug] [Thread-1 (]: Timing info for model.mini_project.product_rank (compile): 18:00:37.546027 => 18:00:37.546027
[0m18:00:37.546027 [debug] [Thread-1 (]: Began executing node model.mini_project.product_rank
[0m18:00:37.546027 [debug] [Thread-1 (]: Timing info for model.mini_project.product_rank (execute): 18:00:37.546027 => 18:00:37.546027
[0m18:00:37.546027 [debug] [Thread-1 (]: Finished running node model.mini_project.product_rank
[0m18:00:37.546027 [debug] [Thread-2 (]: Began running node model.mini_project.cross_sell_and_product_churn
[0m18:00:37.546027 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mini_project.prep_fulldata, now model.mini_project.cross_sell_and_product_churn)
[0m18:00:37.546027 [debug] [Thread-2 (]: Began compiling node model.mini_project.cross_sell_and_product_churn
[0m18:00:37.559532 [debug] [Thread-1 (]: Began running node model.mini_project.prep_extradata
[0m18:00:37.559532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.product_rank, now model.mini_project.prep_extradata)
[0m18:00:37.559532 [debug] [Thread-1 (]: Began compiling node model.mini_project.prep_extradata
[0m18:00:37.562178 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.prep_extradata"
[0m18:00:37.562178 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.cross_sell_and_product_churn"
[0m18:00:37.562178 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_extradata (compile): 18:00:37.559532 => 18:00:37.562178
[0m18:00:37.562178 [debug] [Thread-1 (]: Began executing node model.mini_project.prep_extradata
[0m18:00:37.562178 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_extradata (execute): 18:00:37.562178 => 18:00:37.562178
[0m18:00:37.562178 [debug] [Thread-1 (]: Finished running node model.mini_project.prep_extradata
[0m18:00:37.562178 [debug] [Thread-2 (]: Timing info for model.mini_project.cross_sell_and_product_churn (compile): 18:00:37.546027 => 18:00:37.562178
[0m18:00:37.562178 [debug] [Thread-2 (]: Began executing node model.mini_project.cross_sell_and_product_churn
[0m18:00:37.562178 [debug] [Thread-2 (]: Timing info for model.mini_project.cross_sell_and_product_churn (execute): 18:00:37.562178 => 18:00:37.562178
[0m18:00:37.569733 [debug] [Thread-2 (]: Finished running node model.mini_project.cross_sell_and_product_churn
[0m18:00:37.569733 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:00:37.569733 [debug] [MainThread]: Connection 'list_JOB_PORTAL_RAW' was properly closed.
[0m18:00:37.569733 [debug] [MainThread]: Connection 'list_JOB_PORTAL_PREP' was properly closed.
[0m18:00:37.569733 [debug] [MainThread]: Connection 'model.mini_project.prep_extradata' was properly closed.
[0m18:00:37.569733 [debug] [MainThread]: Connection 'model.mini_project.cross_sell_and_product_churn' was properly closed.
[0m18:00:37.569733 [debug] [MainThread]: Command end result
[0m18:00:37.995529 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m18:00:37.995529 [info ] [MainThread]: Building catalog
[0m18:00:37.995529 [debug] [ThreadPool]: Acquiring new snowflake connection 'JOB_PORTAL.information_schema'
[0m18:00:38.009467 [debug] [ThreadPool]: Acquiring new snowflake connection 'MINI_PROJECT.information_schema'
[0m18:00:38.015543 [debug] [ThreadPool]: Using snowflake connection "JOB_PORTAL.information_schema"
[0m18:00:38.028458 [debug] [ThreadPool]: Using snowflake connection "MINI_PROJECT.information_schema"
[0m18:00:38.030068 [debug] [ThreadPool]: On JOB_PORTAL.information_schema: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "JOB_PORTAL.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        coalesce(table_type, 'DYNAMIC TABLE') as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from JOB_PORTAL.INFORMATION_SCHEMA.tables
            where (
                (
                    upper("table_schema") = upper('KPI')
                    and upper("table_name") = upper('cross_sell_and_product_churn')
                )
             or 
                (
                    upper("table_schema") = upper('PREP')
                    and upper("table_name") = upper('prep_products')
                )
             or 
                (
                    upper("table_schema") = upper('KPI')
                    and upper("table_name") = upper('churn_and_newcustomers')
                )
             or 
                (
                    upper("table_schema") = upper('PREP')
                    and upper("table_name") = upper('prep_transaction')
                )
             or 
                (
                    upper("table_schema") = upper('PREP')
                    and upper("table_name") = upper('prep_extradata')
                )
             or 
                (
                    upper("table_schema") = upper('KPI')
                    and upper("table_name") = upper('monthly_loss')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('raw_products')
                )
             or 
                (
                    upper("table_schema") = upper('KPI')
                    and upper("table_name") = upper('product_rank')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('raw_transaction')
                )
             or 
                (
                    upper("table_schema") = upper('PREP')
                    and upper("table_name") = upper('prep_fulldata')
                )
             or 
                (
                    upper("table_schema") = upper('PREP')
                    and upper("table_name") = upper('prep_customers')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('raw_customers')
                )
             or 
                (
                    upper("table_schema") = upper('KPI')
                    and upper("table_name") = upper('customer_rank')
                )
             or 
                (
                    upper("table_schema") = upper('KPI')
                    and upper("table_name") = upper('fiscal_year_logos')
                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from JOB_PORTAL.INFORMATION_SCHEMA.columns
            where (
                (
                    upper("table_schema") = upper('KPI')
                    and upper("table_name") = upper('cross_sell_and_product_churn')
                )
             or 
                (
                    upper("table_schema") = upper('PREP')
                    and upper("table_name") = upper('prep_products')
                )
             or 
                (
                    upper("table_schema") = upper('KPI')
                    and upper("table_name") = upper('churn_and_newcustomers')
                )
             or 
                (
                    upper("table_schema") = upper('PREP')
                    and upper("table_name") = upper('prep_transaction')
                )
             or 
                (
                    upper("table_schema") = upper('PREP')
                    and upper("table_name") = upper('prep_extradata')
                )
             or 
                (
                    upper("table_schema") = upper('KPI')
                    and upper("table_name") = upper('monthly_loss')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('raw_products')
                )
             or 
                (
                    upper("table_schema") = upper('KPI')
                    and upper("table_name") = upper('product_rank')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('raw_transaction')
                )
             or 
                (
                    upper("table_schema") = upper('PREP')
                    and upper("table_name") = upper('prep_fulldata')
                )
             or 
                (
                    upper("table_schema") = upper('PREP')
                    and upper("table_name") = upper('prep_customers')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('raw_customers')
                )
             or 
                (
                    upper("table_schema") = upper('KPI')
                    and upper("table_name") = upper('customer_rank')
                )
             or 
                (
                    upper("table_schema") = upper('KPI')
                    and upper("table_name") = upper('fiscal_year_logos')
                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m18:00:38.030068 [debug] [ThreadPool]: On MINI_PROJECT.information_schema: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "MINI_PROJECT.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        coalesce(table_type, 'DYNAMIC TABLE') as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from MINI_PROJECT.INFORMATION_SCHEMA.tables
            where (
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('Customers')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('mapping')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('Products')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('Transaction')
                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from MINI_PROJECT.INFORMATION_SCHEMA.columns
            where (
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('Customers')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('mapping')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('Products')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('Transaction')
                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m18:00:38.030068 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:38.030068 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:42.480829 [debug] [ThreadPool]: SQL status: SUCCESS 26 in 4.0 seconds
[0m18:00:42.480829 [debug] [ThreadPool]: On MINI_PROJECT.information_schema: Close
[0m18:00:42.766167 [debug] [ThreadPool]: SQL status: SUCCESS 57 in 5.0 seconds
[0m18:00:42.766167 [debug] [ThreadPool]: On JOB_PORTAL.information_schema: Close
[0m18:00:43.444976 [info ] [MainThread]: Catalog written to C:\Users\DasariUday\venv\.venv\mini_project\target\catalog.json
[0m18:00:43.444976 [debug] [MainThread]: Command `dbt docs generate` succeeded at 18:00:43.444976 after 12.44 seconds
[0m18:00:43.444976 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m18:00:43.444976 [debug] [MainThread]: Connection 'JOB_PORTAL.information_schema' was properly closed.
[0m18:00:43.444976 [debug] [MainThread]: Connection 'MINI_PROJECT.information_schema' was properly closed.
[0m18:00:43.444976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210C2CFE0F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210C2CFE9F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210C2D25C10>]}
[0m18:00:43.444976 [debug] [MainThread]: Flushing usage events
[0m18:01:54.311635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0038151C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0031F3FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A003815AC0>]}


============================== 18:01:54.316479 | 9ecda1dd-e239-4f3a-b1d7-403800bb95a2 ==============================
[0m18:01:54.316479 [info ] [MainThread]: Running with dbt=1.7.19
[0m18:01:54.316479 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\DasariUday\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\DasariUday\\venv\\.venv\\mini_project\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt docs serve', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:01:54.722860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ecda1dd-e239-4f3a-b1d7-403800bb95a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0056457C0>]}
[0m18:01:54.770908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ecda1dd-e239-4f3a-b1d7-403800bb95a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0036DDCA0>]}
[0m18:05:15.682136 [error] [MainThread]: Encountered an error:

[0m18:05:15.755903 [error] [MainThread]: Traceback (most recent call last):
  File "c:\Users\DasariUday\venv\.venv\Lib\site-packages\dbt\cli\requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\DasariUday\venv\.venv\Lib\site-packages\dbt\cli\requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\DasariUday\venv\.venv\Lib\site-packages\dbt\cli\requires.py", line 169, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\DasariUday\venv\.venv\Lib\site-packages\dbt\cli\requires.py", line 198, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\DasariUday\venv\.venv\Lib\site-packages\dbt\cli\requires.py", line 245, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\DasariUday\venv\.venv\Lib\site-packages\dbt\cli\main.py", line 325, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "c:\Users\DasariUday\venv\.venv\Lib\site-packages\dbt\task\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Users\DasariUday\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\DasariUday\AppData\Local\Programs\Python\Python312\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\DasariUday\AppData\Local\Programs\Python\Python312\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m18:05:15.755903 [debug] [MainThread]: Command `dbt docs serve` failed at 18:05:15.755903 after 201.58 seconds
[0m18:05:15.755903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0038154C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A003815400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A004499B20>]}
[0m18:05:15.755903 [debug] [MainThread]: Flushing usage events
[0m18:45:01.998687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002244D6C5A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002244D2DBB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002244D6C6300>]}


============================== 18:45:02.004550 | b1f50f88-5e7e-40bf-88fb-6c248cf3580a ==============================
[0m18:45:02.004550 [info ] [MainThread]: Running with dbt=1.7.19
[0m18:45:02.005550 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'c:\\Users\\DasariUday\\venv\\.venv\\mini_project\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\DasariUday\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:45:02.124960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1f50f88-5e7e-40bf-88fb-6c248cf3580a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002244D716FF0>]}
[0m18:45:02.126958 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m18:45:02.128964 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m18:45:02.129962 [debug] [MainThread]: Command `cli deps` succeeded at 18:45:02.129962 after 0.28 seconds
[0m18:45:02.130960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022446FA6CC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002244D51E030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002244D51CAA0>]}
[0m18:45:02.130960 [debug] [MainThread]: Flushing usage events
[0m19:06:36.791948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0CC1FE5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0CC1FEE70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0CC1FEDE0>]}


============================== 19:06:36.811139 | 6f4f3e5d-3405-4294-80a0-5366395886b5 ==============================
[0m19:06:36.811139 [info ] [MainThread]: Running with dbt=1.7.19
[0m19:06:36.811139 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\DasariUday\\venv\\.venv\\mini_project\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\DasariUday\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m prep_customers', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:06:37.308726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f4f3e5d-3405-4294-80a0-5366395886b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0CC1D55B0>]}
[0m19:06:37.356091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f4f3e5d-3405-4294-80a0-5366395886b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0CB0B86B0>]}
[0m19:06:37.356091 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m19:06:37.371848 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m19:06:37.458408 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:06:37.458408 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:06:37.458408 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project.mart
[0m19:06:37.474374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f4f3e5d-3405-4294-80a0-5366395886b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0CE0AC890>]}
[0m19:06:37.492727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f4f3e5d-3405-4294-80a0-5366395886b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0CE0DB3B0>]}
[0m19:06:37.492727 [info ] [MainThread]: Found 1 seed, 15 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m19:06:37.492727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f4f3e5d-3405-4294-80a0-5366395886b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0CCFEA330>]}
[0m19:06:37.509833 [info ] [MainThread]: 
[0m19:06:37.510865 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:06:37.512013 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL'
[0m19:06:37.526377 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL"
[0m19:06:37.526377 [debug] [ThreadPool]: On list_JOB_PORTAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL"} */
show terse schemas in database JOB_PORTAL
    limit 10000
[0m19:06:37.526377 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:06:39.730890 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m19:06:39.730890 [debug] [ThreadPool]: On list_JOB_PORTAL: Close
[0m19:06:40.394292 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL_KPI'
[0m19:06:40.394292 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_KPI"
[0m19:06:40.394292 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m19:06:40.394292 [debug] [ThreadPool]: On list_JOB_PORTAL_KPI: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_KPI"} */
show terse objects in JOB_PORTAL.KPI limit 10000
[0m19:06:40.410314 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m19:06:40.410314 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:06:40.410314 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show terse objects in MINI_PROJECT.RAW limit 10000
[0m19:06:40.410314 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:06:42.204732 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m19:06:42.204732 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: Close
[0m19:06:42.838609 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m19:06:42.840618 [debug] [ThreadPool]: On list_JOB_PORTAL_KPI: Close
[0m19:06:43.392997 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_RAW, now list_JOB_PORTAL_PREP)
[0m19:06:43.392997 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_PREP"
[0m19:06:43.392997 [debug] [ThreadPool]: On list_JOB_PORTAL_PREP: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_PREP"} */
show terse objects in JOB_PORTAL.PREP limit 10000
[0m19:06:43.392997 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:06:43.501463 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JOB_PORTAL_KPI, now list_JOB_PORTAL_RAW)
[0m19:06:43.505429 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_RAW"
[0m19:06:43.506428 [debug] [ThreadPool]: On list_JOB_PORTAL_RAW: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_RAW"} */
show terse objects in JOB_PORTAL.RAW limit 10000
[0m19:06:43.506428 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:06:45.198574 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m19:06:45.198574 [debug] [ThreadPool]: On list_JOB_PORTAL_PREP: Close
[0m19:06:45.263425 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m19:06:45.266421 [debug] [ThreadPool]: On list_JOB_PORTAL_RAW: Close
[0m19:06:45.896520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f4f3e5d-3405-4294-80a0-5366395886b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0CCE96C00>]}
[0m19:06:45.896520 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m19:06:45.896520 [info ] [MainThread]: 
[0m19:06:45.916040 [debug] [Thread-1 (]: Began running node model.mini_project.prep_customers
[0m19:06:45.916040 [info ] [Thread-1 (]: 1 of 1 START sql table model JOB_PORTAL.PREP.prep_customers .................... [RUN]
[0m19:06:45.918177 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project.prep_customers'
[0m19:06:45.918177 [debug] [Thread-1 (]: Began compiling node model.mini_project.prep_customers
[0m19:06:45.920141 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.prep_customers"
[0m19:06:45.920141 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_customers (compile): 19:06:45.918177 => 19:06:45.920141
[0m19:06:45.920141 [debug] [Thread-1 (]: Began executing node model.mini_project.prep_customers
[0m19:06:45.958910 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.prep_customers"
[0m19:06:45.966098 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.prep_customers"
[0m19:06:45.968155 [debug] [Thread-1 (]: On model.mini_project.prep_customers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.prep_customers"} */
create or replace transient table JOB_PORTAL.PREP.prep_customers
         as
        (
WITH CTE_1 AS(
    SELECT DISTINCT
    LOWER(TRIM(COMPANY)) AS COMPANY,
    CUSTOMER_ID::NUMBER AS CUSTOMER_ID,
    LOWER(
        REGEXP_REPLACE(
            TRIM(REGEXP_SUBSTR(CUSTOMERNAME, '^[^(]+')), 
            ',', 
            ''
        )
    ) AS CUSTOMERNAME,  --  name without commas

    
FROM JOB_PORTAL.RAW.raw_customers
)
SELECT
    C.COMPANY,
    C.CUSTOMER_ID,
    T.customer_id,
    C.CUSTOMERNAME,
    T.country
FROM CTE_1 C LEFT JOIN MINI_PROJECT.RAW.Mapping T ON C.CUSTOMER_ID = T.CUSTOMER_ID
        );
[0m19:06:45.968155 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:06:48.009092 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00d0-0004-bde4-0005-d1530001c19a
[0m19:06:48.009092 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002025 (42S21): SQL compilation error:
duplicate column name 'CUSTOMER_ID'
[0m19:06:48.009092 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_customers (execute): 19:06:45.920141 => 19:06:48.009092
[0m19:06:48.009092 [debug] [Thread-1 (]: On model.mini_project.prep_customers: Close
[0m19:06:48.697003 [debug] [Thread-1 (]: Database Error in model prep_customers (models\prep\prep_customers.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'CUSTOMER_ID'
  compiled Code at target\run\mini_project\models\prep\prep_customers.sql
[0m19:06:48.698007 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f4f3e5d-3405-4294-80a0-5366395886b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0CE451460>]}
[0m19:06:48.698007 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model JOB_PORTAL.PREP.prep_customers ........... [[31mERROR[0m in 2.78s]
[0m19:06:48.699004 [debug] [Thread-1 (]: Finished running node model.mini_project.prep_customers
[0m19:06:48.701972 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:06:48.701972 [debug] [MainThread]: Connection 'list_JOB_PORTAL' was properly closed.
[0m19:06:48.701972 [debug] [MainThread]: Connection 'list_JOB_PORTAL_RAW' was properly closed.
[0m19:06:48.703007 [debug] [MainThread]: Connection 'list_JOB_PORTAL_PREP' was properly closed.
[0m19:06:48.703332 [debug] [MainThread]: Connection 'model.mini_project.prep_customers' was properly closed.
[0m19:06:48.703738 [info ] [MainThread]: 
[0m19:06:48.704423 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.19 seconds (11.19s).
[0m19:06:48.705613 [debug] [MainThread]: Command end result
[0m19:06:48.714483 [info ] [MainThread]: 
[0m19:06:48.715514 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:06:48.716514 [info ] [MainThread]: 
[0m19:06:48.716514 [error] [MainThread]:   Database Error in model prep_customers (models\prep\prep_customers.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'CUSTOMER_ID'
  compiled Code at target\run\mini_project\models\prep\prep_customers.sql
[0m19:06:48.717514 [info ] [MainThread]: 
[0m19:06:48.718481 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:06:48.719480 [debug] [MainThread]: Command `dbt run` failed at 19:06:48.719480 after 12.11 seconds
[0m19:06:48.720486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0CC09EC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0CC0DEF00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0CBF58EF0>]}
[0m19:06:48.720486 [debug] [MainThread]: Flushing usage events
[0m19:07:10.348775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201B5054EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201B5054D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201B5055100>]}


============================== 19:07:10.348775 | 8f028a51-08f5-4304-9652-a030c8cca357 ==============================
[0m19:07:10.348775 [info ] [MainThread]: Running with dbt=1.7.19
[0m19:07:10.357226 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\DasariUday\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\DasariUday\\venv\\.venv\\mini_project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m prep_customers', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:07:10.807637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f028a51-08f5-4304-9652-a030c8cca357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201B50AE4B0>]}
[0m19:07:10.865032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f028a51-08f5-4304-9652-a030c8cca357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201B5365670>]}
[0m19:07:10.867037 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m19:07:10.875365 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m19:07:10.957429 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:07:10.957429 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:07:10.957429 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project.mart
[0m19:07:10.973297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f028a51-08f5-4304-9652-a030c8cca357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201B6EEC890>]}
[0m19:07:10.979321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f028a51-08f5-4304-9652-a030c8cca357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201B6F18AA0>]}
[0m19:07:10.979321 [info ] [MainThread]: Found 1 seed, 15 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m19:07:10.979321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f028a51-08f5-4304-9652-a030c8cca357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201B5D630E0>]}
[0m19:07:10.979321 [info ] [MainThread]: 
[0m19:07:10.990994 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:07:10.992607 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL'
[0m19:07:11.006260 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL"
[0m19:07:11.007710 [debug] [ThreadPool]: On list_JOB_PORTAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL"} */
show terse schemas in database JOB_PORTAL
    limit 10000
[0m19:07:11.007710 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:07:13.171425 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m19:07:13.171425 [debug] [ThreadPool]: On list_JOB_PORTAL: Close
[0m19:07:13.848320 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL_RAW'
[0m19:07:13.865756 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m19:07:13.873691 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_RAW"
[0m19:07:13.875700 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m19:07:13.875700 [debug] [ThreadPool]: On list_JOB_PORTAL_RAW: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_RAW"} */
show terse objects in JOB_PORTAL.RAW limit 10000
[0m19:07:13.875700 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show terse objects in MINI_PROJECT.RAW limit 10000
[0m19:07:13.875700 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:07:13.875700 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:07:15.679869 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m19:07:15.695040 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: Close
[0m19:07:15.743978 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m19:07:15.743978 [debug] [ThreadPool]: On list_JOB_PORTAL_RAW: Close
[0m19:07:16.342963 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_RAW, now list_JOB_PORTAL_PREP)
[0m19:07:16.358795 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_PREP"
[0m19:07:16.358795 [debug] [ThreadPool]: On list_JOB_PORTAL_PREP: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_PREP"} */
show terse objects in JOB_PORTAL.PREP limit 10000
[0m19:07:16.358795 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:07:16.390708 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JOB_PORTAL_RAW, now list_JOB_PORTAL_KPI)
[0m19:07:16.408780 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_KPI"
[0m19:07:16.408780 [debug] [ThreadPool]: On list_JOB_PORTAL_KPI: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_KPI"} */
show terse objects in JOB_PORTAL.KPI limit 10000
[0m19:07:16.410787 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:07:18.105857 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m19:07:18.105857 [debug] [ThreadPool]: On list_JOB_PORTAL_PREP: Close
[0m19:07:18.219572 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m19:07:18.219572 [debug] [ThreadPool]: On list_JOB_PORTAL_KPI: Close
[0m19:07:19.383214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f028a51-08f5-4304-9652-a030c8cca357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201B6E5DB50>]}
[0m19:07:19.383214 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m19:07:19.383214 [info ] [MainThread]: 
[0m19:07:19.383214 [debug] [Thread-1 (]: Began running node model.mini_project.prep_customers
[0m19:07:19.383214 [info ] [Thread-1 (]: 1 of 1 START sql table model JOB_PORTAL.PREP.prep_customers .................... [RUN]
[0m19:07:19.383214 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project.prep_customers'
[0m19:07:19.395277 [debug] [Thread-1 (]: Began compiling node model.mini_project.prep_customers
[0m19:07:19.403958 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.prep_customers"
[0m19:07:19.405558 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_customers (compile): 19:07:19.395277 => 19:07:19.404959
[0m19:07:19.407051 [debug] [Thread-1 (]: Began executing node model.mini_project.prep_customers
[0m19:07:19.434653 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.prep_customers"
[0m19:07:19.434653 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.prep_customers"
[0m19:07:19.434653 [debug] [Thread-1 (]: On model.mini_project.prep_customers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.prep_customers"} */
create or replace transient table JOB_PORTAL.PREP.prep_customers
         as
        (
WITH CTE_1 AS(
    SELECT DISTINCT
    LOWER(TRIM(COMPANY)) AS COMPANY,
    CUSTOMER_ID::NUMBER AS CUSTOMER_ID,
    LOWER(
        REGEXP_REPLACE(
            TRIM(REGEXP_SUBSTR(CUSTOMERNAME, '^[^(]+')), 
            ',', 
            ''
        )
    ) AS CUSTOMERNAME,  --  name without commas

    
FROM JOB_PORTAL.RAW.raw_customers
)
SELECT
    C.COMPANY,
    C.CUSTOMER_ID,
    C.CUSTOMERNAME,
    T.country
FROM CTE_1 C LEFT JOIN MINI_PROJECT.RAW.Mapping T ON C.CUSTOMER_ID = T.CUSTOMER_ID
        );
[0m19:07:19.434653 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:07:22.023273 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:07:22.063445 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_customers (execute): 19:07:19.407051 => 19:07:22.062452
[0m19:07:22.063445 [debug] [Thread-1 (]: On model.mini_project.prep_customers: Close
[0m19:07:22.708626 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f028a51-08f5-4304-9652-a030c8cca357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201B7289070>]}
[0m19:07:22.709669 [info ] [Thread-1 (]: 1 of 1 OK created sql table model JOB_PORTAL.PREP.prep_customers ............... [[32mSUCCESS 1[0m in 3.33s]
[0m19:07:22.710922 [debug] [Thread-1 (]: Finished running node model.mini_project.prep_customers
[0m19:07:22.713232 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:07:22.713232 [debug] [MainThread]: Connection 'list_JOB_PORTAL' was properly closed.
[0m19:07:22.713232 [debug] [MainThread]: Connection 'list_JOB_PORTAL_KPI' was properly closed.
[0m19:07:22.714233 [debug] [MainThread]: Connection 'list_JOB_PORTAL_PREP' was properly closed.
[0m19:07:22.714233 [debug] [MainThread]: Connection 'model.mini_project.prep_customers' was properly closed.
[0m19:07:22.714233 [info ] [MainThread]: 
[0m19:07:22.715233 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.72 seconds (11.72s).
[0m19:07:22.716528 [debug] [MainThread]: Command end result
[0m19:07:22.721781 [info ] [MainThread]: 
[0m19:07:22.721781 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:07:22.728734 [info ] [MainThread]: 
[0m19:07:22.728734 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:07:22.729824 [debug] [MainThread]: Command `dbt run` succeeded at 19:07:22.729824 after 12.50 seconds
[0m19:07:22.730866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201B5054C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201B5054DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201B5055850>]}
[0m19:07:22.730866 [debug] [MainThread]: Flushing usage events
[0m19:28:10.146432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FFE2B4DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FFDF40E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FFE2B4F80>]}


============================== 19:28:10.148439 | 650cf1d7-f8ad-48e7-9313-487b4aa8201a ==============================
[0m19:28:10.148439 [info ] [MainThread]: Running with dbt=1.7.19
[0m19:28:10.150445 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\DasariUday\\.dbt', 'log_path': 'C:\\Users\\DasariUday\\venv\\.venv\\mini_project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:28:10.520141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '650cf1d7-f8ad-48e7-9313-487b4aa8201a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FFECEE870>]}
[0m19:28:10.583631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '650cf1d7-f8ad-48e7-9313-487b4aa8201a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FFEFD3650>]}
[0m19:28:10.583631 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m19:28:10.601186 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m19:28:10.679277 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m19:28:10.679277 [debug] [MainThread]: Partial parsing: added file: mini_project://models\mart\nrr_and_drr.sql
[0m19:28:10.806389 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two models with the name "nrr_and_drr".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for ref("nrr_and_drr").
  
  To fix this, change the name of one of these resources:
  - model.mini_project.nrr_and_drr (models\mart\nrr_and_drr.sql)
  - model.mini_project.nrr_and_drr (models\crb\nrr_and_drr.sql)
[0m19:28:10.806389 [debug] [MainThread]: Command `dbt run` failed at 19:28:10.806389 after 0.81 seconds
[0m19:28:10.806389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FFE2B50D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FFEF73AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FF7B97FB0>]}
[0m19:28:10.806389 [debug] [MainThread]: Flushing usage events
[0m19:28:31.246079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A2B55A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A2B54B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A2B54D70>]}


============================== 19:28:31.246079 | 658302f6-fcf5-4f68-9d74-f41643baba4d ==============================
[0m19:28:31.246079 [info ] [MainThread]: Running with dbt=1.7.19
[0m19:28:31.246079 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\DasariUday\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\DasariUday\\venv\\.venv\\mini_project\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:28:31.657475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '658302f6-fcf5-4f68-9d74-f41643baba4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A374CB30>]}
[0m19:28:31.715672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '658302f6-fcf5-4f68-9d74-f41643baba4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A38070E0>]}
[0m19:28:31.715672 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m19:28:31.715672 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m19:28:31.817114 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m19:28:31.817114 [debug] [MainThread]: Partial parsing: added file: mini_project://models\mart\mart_nrr_and_drr.sql
[0m19:28:31.965400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '658302f6-fcf5-4f68-9d74-f41643baba4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A4CAF830>]}
[0m19:28:31.993127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '658302f6-fcf5-4f68-9d74-f41643baba4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A49EFAD0>]}
[0m19:28:31.993127 [info ] [MainThread]: Found 1 seed, 22 models, 4 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m19:28:31.993127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '658302f6-fcf5-4f68-9d74-f41643baba4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A4BC6090>]}
[0m19:28:32.006875 [info ] [MainThread]: 
[0m19:28:32.006875 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:28:32.006875 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL'
[0m19:28:32.024080 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL"
[0m19:28:32.025673 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL'
[0m19:28:32.026304 [debug] [ThreadPool]: On list_JOB_PORTAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL"} */
show terse schemas in database JOB_PORTAL
    limit 10000
[0m19:28:32.028967 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL"
[0m19:28:32.029956 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:28:32.029956 [debug] [ThreadPool]: On list_JOB_PORTAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL"} */
show terse schemas in database JOB_PORTAL
    limit 10000
[0m19:28:32.029956 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:28:34.180064 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m19:28:34.181193 [debug] [ThreadPool]: On list_JOB_PORTAL: Close
[0m19:28:34.189344 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m19:28:34.190344 [debug] [ThreadPool]: On list_JOB_PORTAL: Close
[0m19:28:34.790575 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL"
[0m19:28:34.790575 [debug] [ThreadPool]: On list_JOB_PORTAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL"} */
show terse schemas in database JOB_PORTAL
    limit 10000
[0m19:28:34.790575 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:28:34.854360 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL"
[0m19:28:34.854360 [debug] [ThreadPool]: On list_JOB_PORTAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL"} */
show terse schemas in database JOB_PORTAL
    limit 10000
[0m19:28:34.854360 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:28:36.628693 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m19:28:36.628693 [debug] [ThreadPool]: On list_JOB_PORTAL: Close
[0m19:28:36.660440 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m19:28:36.662447 [debug] [ThreadPool]: On list_JOB_PORTAL: Close
[0m19:28:37.322012 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JOB_PORTAL, now create_JOB_PORTAL_KPI)
[0m19:28:37.322012 [debug] [ThreadPool]: Creating schema "database: "JOB_PORTAL"
schema: "KPI"
"
[0m19:28:37.322012 [debug] [ThreadPool]: Using snowflake connection "create_JOB_PORTAL_KPI"
[0m19:28:37.322012 [debug] [ThreadPool]: On create_JOB_PORTAL_KPI: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "create_JOB_PORTAL_KPI"} */
create schema if not exists JOB_PORTAL.KPI
[0m19:28:37.322012 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:28:39.048899 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:28:39.064587 [debug] [ThreadPool]: On create_JOB_PORTAL_KPI: Close
[0m19:28:39.689611 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m19:28:39.705702 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL_KPI'
[0m19:28:39.709719 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m19:28:39.713734 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_KPI"
[0m19:28:39.713734 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show terse objects in MINI_PROJECT.RAW limit 10000
[0m19:28:39.713734 [debug] [ThreadPool]: On list_JOB_PORTAL_KPI: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_KPI"} */
show terse objects in JOB_PORTAL.KPI limit 10000
[0m19:28:39.713734 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:28:39.715741 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:28:41.492650 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m19:28:41.492650 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 2.0 seconds
[0m19:28:41.494658 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: Close
[0m19:28:41.496407 [debug] [ThreadPool]: On list_JOB_PORTAL_KPI: Close
[0m19:28:42.124359 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JOB_PORTAL_KPI, now list_JOB_PORTAL_PREP)
[0m19:28:42.124359 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_PREP"
[0m19:28:42.124359 [debug] [ThreadPool]: On list_JOB_PORTAL_PREP: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_PREP"} */
show terse objects in JOB_PORTAL.PREP limit 10000
[0m19:28:42.124359 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:28:42.140444 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_RAW, now list_JOB_PORTAL_RAW)
[0m19:28:42.143798 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_RAW"
[0m19:28:42.143798 [debug] [ThreadPool]: On list_JOB_PORTAL_RAW: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_RAW"} */
show terse objects in JOB_PORTAL.RAW limit 10000
[0m19:28:42.143798 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:28:43.894332 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m19:28:43.895945 [debug] [ThreadPool]: On list_JOB_PORTAL_RAW: Close
[0m19:28:43.903699 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m19:28:43.905702 [debug] [ThreadPool]: On list_JOB_PORTAL_PREP: Close
[0m19:28:44.541996 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JOB_PORTAL_PREP, now list_JOB_PORTAL_MART)
[0m19:28:44.541996 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_MART"
[0m19:28:44.541996 [debug] [ThreadPool]: On list_JOB_PORTAL_MART: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_MART"} */
show terse objects in JOB_PORTAL.MART limit 10000
[0m19:28:44.541996 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:28:46.355025 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:28:46.355025 [debug] [ThreadPool]: On list_JOB_PORTAL_MART: Close
[0m19:28:46.984981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '658302f6-fcf5-4f68-9d74-f41643baba4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A29DB1A0>]}
[0m19:28:46.984981 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m19:28:46.984981 [info ] [MainThread]: 
[0m19:28:47.000730 [debug] [Thread-1 (]: Began running node model.mini_project.raw_customers
[0m19:28:47.000730 [debug] [Thread-2 (]: Began running node model.mini_project.raw_products
[0m19:28:47.000730 [info ] [Thread-1 (]: 1 of 22 START sql table model JOB_PORTAL.RAW.raw_customers ..................... [RUN]
[0m19:28:47.003717 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project.raw_customers'
[0m19:28:47.003717 [debug] [Thread-1 (]: Began compiling node model.mini_project.raw_customers
[0m19:28:47.008559 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.raw_customers"
[0m19:28:47.000730 [info ] [Thread-2 (]: 2 of 22 START sql table model JOB_PORTAL.RAW.raw_products ...................... [RUN]
[0m19:28:47.008559 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.mini_project.raw_products'
[0m19:28:47.008559 [debug] [Thread-2 (]: Began compiling node model.mini_project.raw_products
[0m19:28:47.017575 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.raw_products"
[0m19:28:47.018511 [debug] [Thread-1 (]: Timing info for model.mini_project.raw_customers (compile): 19:28:47.003717 => 19:28:47.018511
[0m19:28:47.018511 [debug] [Thread-1 (]: Began executing node model.mini_project.raw_customers
[0m19:28:47.034097 [debug] [Thread-2 (]: Timing info for model.mini_project.raw_products (compile): 19:28:47.008559 => 19:28:47.034097
[0m19:28:47.049236 [debug] [Thread-2 (]: Began executing node model.mini_project.raw_products
[0m19:28:47.051288 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.raw_customers"
[0m19:28:47.054539 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.raw_products"
[0m19:28:47.057058 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.raw_customers"
[0m19:28:47.057058 [debug] [Thread-1 (]: On model.mini_project.raw_customers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.raw_customers"} */
create or replace transient table JOB_PORTAL.RAW.raw_customers
         as
        (
SELECT 
    * 
FROM 
    MINI_PROJECT.RAW.Customers 
    WHERE CUSTOMER_ID 
          IS NOT NULL
        );
[0m19:28:47.058085 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:28:47.060053 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.raw_products"
[0m19:28:47.060053 [debug] [Thread-2 (]: On model.mini_project.raw_products: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.raw_products"} */
create or replace transient table JOB_PORTAL.RAW.raw_products
         as
        (
SELECT 
     *
FROM 
     MINI_PROJECT.RAW.Products 
     WHERE PRODUCT_ID 
           IS NOT NULL
        );
[0m19:28:47.061053 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:28:50.317111 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:28:50.332983 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:28:50.352998 [debug] [Thread-1 (]: Timing info for model.mini_project.raw_customers (execute): 19:28:47.021882 => 19:28:50.352998
[0m19:28:50.352998 [debug] [Thread-2 (]: Timing info for model.mini_project.raw_products (execute): 19:28:47.052533 => 19:28:50.352998
[0m19:28:50.352998 [debug] [Thread-1 (]: On model.mini_project.raw_customers: Close
[0m19:28:50.352998 [debug] [Thread-2 (]: On model.mini_project.raw_products: Close
[0m19:28:51.012033 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '658302f6-fcf5-4f68-9d74-f41643baba4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A4ECCC20>]}
[0m19:28:51.018128 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '658302f6-fcf5-4f68-9d74-f41643baba4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A4ECF620>]}
[0m19:28:51.018128 [info ] [Thread-2 (]: 2 of 22 OK created sql table model JOB_PORTAL.RAW.raw_products ................. [[32mSUCCESS 1[0m in 4.00s]
[0m19:28:51.024266 [debug] [Thread-2 (]: Finished running node model.mini_project.raw_products
[0m19:28:51.018128 [info ] [Thread-1 (]: 1 of 22 OK created sql table model JOB_PORTAL.RAW.raw_customers ................ [[32mSUCCESS 1[0m in 4.01s]
[0m19:28:51.027876 [debug] [Thread-2 (]: Began running node model.mini_project.raw_transaction
[0m19:28:51.034214 [debug] [Thread-1 (]: Finished running node model.mini_project.raw_customers
[0m19:28:51.038613 [debug] [Thread-1 (]: Began running node model.mini_project.prep_products
[0m19:28:51.036099 [info ] [Thread-2 (]: 3 of 22 START sql table model JOB_PORTAL.RAW.raw_transaction ................... [RUN]
[0m19:28:51.040288 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mini_project.raw_products, now model.mini_project.raw_transaction)
[0m19:28:51.040288 [debug] [Thread-2 (]: Began compiling node model.mini_project.raw_transaction
[0m19:28:51.040288 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.raw_transaction"
[0m19:28:51.040288 [info ] [Thread-1 (]: 4 of 22 START sql table model JOB_PORTAL.PREP.prep_products .................... [RUN]
[0m19:28:51.040288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.raw_customers, now model.mini_project.prep_products)
[0m19:28:51.047081 [debug] [Thread-1 (]: Began compiling node model.mini_project.prep_products
[0m19:28:51.050120 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.prep_products"
[0m19:28:51.051091 [debug] [Thread-2 (]: Timing info for model.mini_project.raw_transaction (compile): 19:28:51.040288 => 19:28:51.051091
[0m19:28:51.051091 [debug] [Thread-2 (]: Began executing node model.mini_project.raw_transaction
[0m19:28:51.055020 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.raw_transaction"
[0m19:28:51.056853 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_products (compile): 19:28:51.047081 => 19:28:51.055806
[0m19:28:51.056853 [debug] [Thread-1 (]: Began executing node model.mini_project.prep_products
[0m19:28:51.060878 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.prep_products"
[0m19:28:51.061876 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.raw_transaction"
[0m19:28:51.062846 [debug] [Thread-2 (]: On model.mini_project.raw_transaction: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.raw_transaction"} */
create or replace transient table JOB_PORTAL.RAW.raw_transaction
         as
        (
SELECT 
     *
FROM 
    MINI_PROJECT.RAW.Transaction 
    WHERE CUSTOMER_ID 
          IS NOT NULL
        );
[0m19:28:51.062846 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:28:51.064844 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.prep_products"
[0m19:28:51.064844 [debug] [Thread-1 (]: On model.mini_project.prep_products: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.prep_products"} */
create or replace transient table JOB_PORTAL.PREP.prep_products
         as
        (
SELECT 
    PRODUCT_ID::VARCHAR AS PRODUCT_ID,
    LOWER(TRIM(PRODUCT_FAMILY)) AS PRODUCT_FAMILY,
    LOWER(TRIM(PRODUCT_SUB_FAMILY)) AS PRODUCT_SUB_FAMILY
FROM JOB_PORTAL.RAW.raw_products
        );
[0m19:28:51.064844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:54.106754 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:28:54.108764 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_products (execute): 19:28:51.056853 => 19:28:54.108764
[0m19:28:54.110771 [debug] [Thread-1 (]: On model.mini_project.prep_products: Close
[0m19:28:54.135212 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:28:54.135212 [debug] [Thread-2 (]: Timing info for model.mini_project.raw_transaction (execute): 19:28:51.052121 => 19:28:54.135212
[0m19:28:54.135212 [debug] [Thread-2 (]: On model.mini_project.raw_transaction: Close
[0m19:28:54.737184 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '658302f6-fcf5-4f68-9d74-f41643baba4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A4CAFE90>]}
[0m19:28:54.737184 [info ] [Thread-1 (]: 4 of 22 OK created sql table model JOB_PORTAL.PREP.prep_products ............... [[32mSUCCESS 1[0m in 3.70s]
[0m19:28:54.737184 [debug] [Thread-1 (]: Finished running node model.mini_project.prep_products
[0m19:28:54.737184 [debug] [Thread-1 (]: Began running node model.mini_project.prep_customers
[0m19:28:54.748940 [info ] [Thread-1 (]: 5 of 22 START sql table model JOB_PORTAL.PREP.prep_customers ................... [RUN]
[0m19:28:54.748940 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.prep_products, now model.mini_project.prep_customers)
[0m19:28:54.748940 [debug] [Thread-1 (]: Began compiling node model.mini_project.prep_customers
[0m19:28:54.753709 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.prep_customers"
[0m19:28:54.753709 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_customers (compile): 19:28:54.748940 => 19:28:54.753709
[0m19:28:54.755716 [debug] [Thread-1 (]: Began executing node model.mini_project.prep_customers
[0m19:28:54.757723 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.prep_customers"
[0m19:28:54.759730 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.prep_customers"
[0m19:28:54.759730 [debug] [Thread-1 (]: On model.mini_project.prep_customers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.prep_customers"} */
create or replace transient table JOB_PORTAL.PREP.prep_customers
         as
        (
WITH CTE_1 AS(
    SELECT DISTINCT
    LOWER(TRIM(COMPANY)) AS COMPANY,
    CUSTOMER_ID::NUMBER AS CUSTOMER_ID,
    LOWER(
        REGEXP_REPLACE(
            TRIM(REGEXP_SUBSTR(CUSTOMERNAME, '^[^(]+')), 
            ',', 
            ''
        )
    ) AS CUSTOMERNAME,  --  name without commas

    
FROM JOB_PORTAL.RAW.raw_customers
)
SELECT
    C.COMPANY,
    C.CUSTOMER_ID,
    C.CUSTOMERNAME,
    T.country
FROM CTE_1 C LEFT JOIN MINI_PROJECT.RAW.Mapping T ON C.CUSTOMER_ID = T.CUSTOMER_ID
        );
[0m19:28:54.759730 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:54.793090 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '658302f6-fcf5-4f68-9d74-f41643baba4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A4A4F380>]}
[0m19:28:54.793090 [info ] [Thread-2 (]: 3 of 22 OK created sql table model JOB_PORTAL.RAW.raw_transaction .............. [[32mSUCCESS 1[0m in 3.75s]
[0m19:28:54.793090 [debug] [Thread-2 (]: Finished running node model.mini_project.raw_transaction
[0m19:28:54.793090 [debug] [Thread-2 (]: Began running node model.mini_project.prep_transaction
[0m19:28:54.793090 [info ] [Thread-2 (]: 6 of 22 START sql table model JOB_PORTAL.PREP.prep_transaction ................. [RUN]
[0m19:28:54.793090 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mini_project.raw_transaction, now model.mini_project.prep_transaction)
[0m19:28:54.793090 [debug] [Thread-2 (]: Began compiling node model.mini_project.prep_transaction
[0m19:28:54.793090 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.prep_transaction"
[0m19:28:54.793090 [debug] [Thread-2 (]: Timing info for model.mini_project.prep_transaction (compile): 19:28:54.793090 => 19:28:54.793090
[0m19:28:54.793090 [debug] [Thread-2 (]: Began executing node model.mini_project.prep_transaction
[0m19:28:54.806801 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.prep_transaction"
[0m19:28:54.808809 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.prep_transaction"
[0m19:28:54.810171 [debug] [Thread-2 (]: On model.mini_project.prep_transaction: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.prep_transaction"} */
create or replace transient table JOB_PORTAL.PREP.prep_transaction
         as
        (
    SELECT DISTINCT
        CUSTOMER_ID::NUMBER AS CUSTOMER_ID,
        PRODUCT_ID::VARCHAR AS PRODUCT_ID,
        TO_DATE(PAYMENT_MONTH) AS PAYMENT_MONTH,
        REVENUE_TYPE::NUMBER AS REVENUE_TYPE,
        REVENUE::NUMBER(38,2) AS REVENUE,
        QUANTITY::NUMBER AS QUANTITY,
        LOWER(TRIM(COMPANIES)) AS COMPANIES
    FROM JOB_PORTAL.RAW.raw_transaction
        );
[0m19:28:54.811211 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:28:57.466336 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:28:57.466336 [debug] [Thread-2 (]: Timing info for model.mini_project.prep_transaction (execute): 19:28:54.793090 => 19:28:57.466336
[0m19:28:57.466336 [debug] [Thread-2 (]: On model.mini_project.prep_transaction: Close
[0m19:28:57.568330 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:28:57.578984 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_customers (execute): 19:28:54.755716 => 19:28:57.578984
[0m19:28:57.578984 [debug] [Thread-1 (]: On model.mini_project.prep_customers: Close
[0m19:28:58.110076 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '658302f6-fcf5-4f68-9d74-f41643baba4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A4A99E50>]}
[0m19:28:58.110076 [info ] [Thread-2 (]: 6 of 22 OK created sql table model JOB_PORTAL.PREP.prep_transaction ............ [[32mSUCCESS 1[0m in 3.32s]
[0m19:28:58.110076 [debug] [Thread-2 (]: Finished running node model.mini_project.prep_transaction
[0m19:28:58.110076 [debug] [Thread-2 (]: Began running node model.mini_project.churn_and_newcustomers
[0m19:28:58.110076 [info ] [Thread-2 (]: 7 of 22 START sql table model JOB_PORTAL.KPI.churn_and_newcustomers ............ [RUN]
[0m19:28:58.110076 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mini_project.prep_transaction, now model.mini_project.churn_and_newcustomers)
[0m19:28:58.110076 [debug] [Thread-2 (]: Began compiling node model.mini_project.churn_and_newcustomers
[0m19:28:58.130331 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.churn_and_newcustomers"
[0m19:28:58.132467 [debug] [Thread-2 (]: Timing info for model.mini_project.churn_and_newcustomers (compile): 19:28:58.110076 => 19:28:58.132467
[0m19:28:58.132467 [debug] [Thread-2 (]: Began executing node model.mini_project.churn_and_newcustomers
[0m19:28:58.132467 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.churn_and_newcustomers"
[0m19:28:58.132467 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.churn_and_newcustomers"
[0m19:28:58.132467 [debug] [Thread-2 (]: On model.mini_project.churn_and_newcustomers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.churn_and_newcustomers"} */
create or replace transient table JOB_PORTAL.KPI.churn_and_newcustomers
         as
        (
WITH
  CTE_1 AS (
    SELECT
      MAX(PAYMENT_MONTH) AS EOP
    FROM
      JOB_PORTAL.PREP.prep_transaction
  ),
  CTE_2 AS (
    SELECT
      *
    FROM
      JOB_PORTAL.PREP.prep_transaction
      INNER JOIN CTE_1 AS CT ON 1 = 1
  ),
  CTE_3 AS (
    SELECT
      CUSTOMER_ID,
      MAX(PAYMENT_MONTH) AS LATEST,
      MIN(PAYMENT_MONTH) AS FIRST,
      DATEADD (MONTH, -3, EOP) AS L3M,
      EOP,
      CASE
        WHEN (FIRST <= L3M) THEN 0
        ELSE 1
      END AS IS_NEW,
      CASE
        WHEN (
          FIRST <= L3M
          AND LATEST < EOP
        ) THEN 1
        ELSE 0
      END AS IS_CHURN
    FROM
      CTE_2
    GROUP BY
      CUSTOMER_ID,
      EOP
  )
SELECT
  SUM(IS_CHURN) AS CHURNED_CUSTOMERS,
  SUM(IS_NEW) AS NEW_CUSTOMERS,
  EOP
FROM
  CTE_3
GROUP BY
  EOP
        );
[0m19:28:58.132467 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:28:58.236192 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '658302f6-fcf5-4f68-9d74-f41643baba4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A4CA6E40>]}
[0m19:28:58.236192 [info ] [Thread-1 (]: 5 of 22 OK created sql table model JOB_PORTAL.PREP.prep_customers .............. [[32mSUCCESS 1[0m in 3.49s]
[0m19:28:58.236192 [debug] [Thread-1 (]: Finished running node model.mini_project.prep_customers
[0m19:28:58.236192 [debug] [Thread-1 (]: Began running node model.mini_project.fiscal_year_logos
[0m19:28:58.236192 [info ] [Thread-1 (]: 8 of 22 START sql table model JOB_PORTAL.KPI.fiscal_year_logos ................. [RUN]
[0m19:28:58.236192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.prep_customers, now model.mini_project.fiscal_year_logos)
[0m19:28:58.236192 [debug] [Thread-1 (]: Began compiling node model.mini_project.fiscal_year_logos
[0m19:28:58.245952 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.fiscal_year_logos"
[0m19:28:58.247958 [debug] [Thread-1 (]: Timing info for model.mini_project.fiscal_year_logos (compile): 19:28:58.243945 => 19:28:58.247958
[0m19:28:58.247958 [debug] [Thread-1 (]: Began executing node model.mini_project.fiscal_year_logos
[0m19:28:58.247958 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.fiscal_year_logos"
[0m19:28:58.247958 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.fiscal_year_logos"
[0m19:28:58.247958 [debug] [Thread-1 (]: On model.mini_project.fiscal_year_logos: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.fiscal_year_logos"} */
create or replace transient table JOB_PORTAL.KPI.fiscal_year_logos
         as
        (
WITH CTE_1 AS(
  SELECT 
    CUSTOMER_ID, 
    MIN(PAYMENT_MONTH) AS FIRST_MONTH 
  FROM 
    JOB_PORTAL.PREP.prep_transaction 
  GROUP BY 
    CUSTOMER_ID
) 
SELECT 
  DISTINCT DATE_TRUNC('YEAR', FIRST_MONTH) AS FISCAL_YEAR, 
  (
    COUNT(CUSTOMER_ID)
  ) AS NEW_CUSTOMERS 
FROM 
  CTE_1 
GROUP BY 
  FISCAL_YEAR
        );
[0m19:28:58.247958 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:29:00.668331 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:29:00.668331 [debug] [Thread-2 (]: Timing info for model.mini_project.churn_and_newcustomers (execute): 19:28:58.132467 => 19:29:00.668331
[0m19:29:00.668331 [debug] [Thread-2 (]: On model.mini_project.churn_and_newcustomers: Close
[0m19:29:00.739416 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:29:00.739416 [debug] [Thread-1 (]: Timing info for model.mini_project.fiscal_year_logos (execute): 19:28:58.247958 => 19:29:00.739416
[0m19:29:00.739416 [debug] [Thread-1 (]: On model.mini_project.fiscal_year_logos: Close
[0m19:29:01.314358 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '658302f6-fcf5-4f68-9d74-f41643baba4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A4E99F70>]}
[0m19:29:01.314358 [info ] [Thread-2 (]: 7 of 22 OK created sql table model JOB_PORTAL.KPI.churn_and_newcustomers ....... [[32mSUCCESS 1[0m in 3.20s]
[0m19:29:01.314358 [debug] [Thread-2 (]: Finished running node model.mini_project.churn_and_newcustomers
[0m19:29:01.314358 [debug] [Thread-2 (]: Began running node model.mini_project.monthly_loss
[0m19:29:01.314358 [info ] [Thread-2 (]: 9 of 22 START sql table model JOB_PORTAL.KPI.monthly_loss ...................... [RUN]
[0m19:29:01.314358 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mini_project.churn_and_newcustomers, now model.mini_project.monthly_loss)
[0m19:29:01.314358 [debug] [Thread-2 (]: Began compiling node model.mini_project.monthly_loss
[0m19:29:01.314358 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.monthly_loss"
[0m19:29:01.314358 [debug] [Thread-2 (]: Timing info for model.mini_project.monthly_loss (compile): 19:29:01.314358 => 19:29:01.314358
[0m19:29:01.314358 [debug] [Thread-2 (]: Began executing node model.mini_project.monthly_loss
[0m19:29:01.314358 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.monthly_loss"
[0m19:29:01.314358 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.monthly_loss"
[0m19:29:01.314358 [debug] [Thread-2 (]: On model.mini_project.monthly_loss: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.monthly_loss"} */
create or replace transient table JOB_PORTAL.KPI.monthly_loss
         as
        (
WITH revenue_loss AS(
  SELECT 
    payment_month, 
    SUM(revenue) AS this_month_revenue, 
    LAG (
      SUM(revenue)
    ) OVER (
      ORDER BY 
        payment_month
    ) AS previous_month_revenue 
  FROM 
    JOB_PORTAL.PREP.prep_transaction 
  where 
    revenue_type = 1 
  GROUP BY 
    payment_month
) 
SELECT 
  PAYMENT_MONTH, 
  this_month_revenue, 
  PREVIOUS_MONTH_REVENUE, 
  This_month_revenue - PREVIOUS_MONTH_REVENUE AS MONTHLY_LOSS 
FROM 
  revenue_loss 
where 
  monthly_loss < 0 
ORDER BY 
  payment_month;
[0m19:29:01.314358 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:29:01.379968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '658302f6-fcf5-4f68-9d74-f41643baba4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A4E69880>]}
[0m19:29:01.381979 [info ] [Thread-1 (]: 8 of 22 OK created sql table model JOB_PORTAL.KPI.fiscal_year_logos ............ [[32mSUCCESS 1[0m in 3.14s]
[0m19:29:01.383578 [debug] [Thread-1 (]: Finished running node model.mini_project.fiscal_year_logos
[0m19:29:01.383578 [debug] [Thread-1 (]: Began running node model.mini_project.nrr_and_drr
[0m19:29:01.383578 [info ] [Thread-1 (]: 10 of 22 START sql table model JOB_PORTAL.KPI.nrr_and_drr ...................... [RUN]
[0m19:29:01.383578 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.fiscal_year_logos, now model.mini_project.nrr_and_drr)
[0m19:29:01.383578 [debug] [Thread-1 (]: Began compiling node model.mini_project.nrr_and_drr
[0m19:29:01.383578 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.nrr_and_drr"
[0m19:29:01.383578 [debug] [Thread-1 (]: Timing info for model.mini_project.nrr_and_drr (compile): 19:29:01.383578 => 19:29:01.383578
[0m19:29:01.383578 [debug] [Thread-1 (]: Began executing node model.mini_project.nrr_and_drr
[0m19:29:01.383578 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.nrr_and_drr"
[0m19:29:01.396658 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.nrr_and_drr"
[0m19:29:01.396658 [debug] [Thread-1 (]: On model.mini_project.nrr_and_drr: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.nrr_and_drr"} */
create or replace transient table JOB_PORTAL.KPI.nrr_and_drr
         as
        (with prev as (
    select
        customer_id,
        revenue,
        lag(revenue) over (partition by customer_id order by PAYMENT_MONTH) as previous_revenue
    from JOB_PORTAL.PREP.prep_transaction
),
transactions AS (
 SELECT
        customer_id,
        SUM(revenue) AS total_revenue,  
        sum(previous_revenue) as prev_total_revenue,
        CASE WHEN total_revenue > prev_total_revenue THEN total_revenue-prev_total_revenue ELSE 0 END AS expansion_revenue,  
        CASE WHEN total_revenue < prev_total_revenue THEN prev_total_revenue-total_revenue ELSE 0 END AS contraction_revenue  
    FROM prev
    GROUP BY 1
)
SELECT
    customer_id,
    total_revenue,
    prev_total_revenue,
    expansion_revenue,
    contraction_revenue,
    CASE
        WHEN total_revenue = 0 THEN 0
        ELSE (((total_revenue)+(expansion_revenue - contraction_revenue)) / total_revenue)*100
    END AS net_revenue_retention_in_percentage,
    CASE
        WHEN total_revenue = 0 THEN 0
        ELSE (((total_revenue)-(expansion_revenue - contraction_revenue)) / total_revenue)*100
    END AS gross_revenue_retention_in_percentage
FROM transactions
        );
[0m19:29:01.397705 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:29:03.284207 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01bb00e7-0004-c0bd-0005-d15300018c7e
[0m19:29:03.284207 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 31 at position 15 unexpected ';'.
[0m19:29:03.286589 [debug] [Thread-2 (]: Timing info for model.mini_project.monthly_loss (execute): 19:29:01.314358 => 19:29:03.286589
[0m19:29:03.286589 [debug] [Thread-2 (]: On model.mini_project.monthly_loss: Close
[0m19:29:03.691439 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:29:03.693163 [debug] [Thread-1 (]: Timing info for model.mini_project.nrr_and_drr (execute): 19:29:01.383578 => 19:29:03.693163
[0m19:29:03.695174 [debug] [Thread-1 (]: On model.mini_project.nrr_and_drr: Close
[0m19:29:03.954583 [debug] [Thread-2 (]: Database Error in model monthly_loss (models\crb\monthly_loss.sql)
  001003 (42000): SQL compilation error:
  syntax error line 31 at position 15 unexpected ';'.
  compiled Code at target\run\mini_project\models\crb\monthly_loss.sql
[0m19:29:03.954583 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '658302f6-fcf5-4f68-9d74-f41643baba4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A4B84920>]}
[0m19:29:03.954583 [error] [Thread-2 (]: 9 of 22 ERROR creating sql table model JOB_PORTAL.KPI.monthly_loss ............. [[31mERROR[0m in 2.64s]
[0m19:29:03.954583 [debug] [Thread-2 (]: Finished running node model.mini_project.monthly_loss
[0m19:29:03.954583 [debug] [Thread-2 (]: Began running node model.mini_project.product_rank
[0m19:29:03.954583 [info ] [Thread-2 (]: 11 of 22 START sql table model JOB_PORTAL.KPI.product_rank ..................... [RUN]
[0m19:29:03.954583 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mini_project.monthly_loss, now model.mini_project.product_rank)
[0m19:29:03.954583 [debug] [Thread-2 (]: Began compiling node model.mini_project.product_rank
[0m19:29:03.966444 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.product_rank"
[0m19:29:03.968452 [debug] [Thread-2 (]: Timing info for model.mini_project.product_rank (compile): 19:29:03.954583 => 19:29:03.968452
[0m19:29:03.969584 [debug] [Thread-2 (]: Began executing node model.mini_project.product_rank
[0m19:29:03.973178 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.product_rank"
[0m19:29:03.974729 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.product_rank"
[0m19:29:03.974729 [debug] [Thread-2 (]: On model.mini_project.product_rank: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.product_rank"} */
create or replace transient table JOB_PORTAL.KPI.product_rank
         as
        (
with
  cte_1 as (
    select
      product_id,
      sum(revenue) as revenue
    from
      JOB_PORTAL.PREP.prep_transaction
    where
      revenue_type = 1
    group by
      product_id
  ),
  cte_2 as (
    select
      product_id,
      revenue,
      dense_rank() over (
        order by
          revenue desc
      )
    from
      cte_1
  )
select
  *
from
  cte_2
        );
[0m19:29:03.974729 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:29:04.340573 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '658302f6-fcf5-4f68-9d74-f41643baba4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A4E98410>]}
[0m19:29:04.340573 [info ] [Thread-1 (]: 10 of 22 OK created sql table model JOB_PORTAL.KPI.nrr_and_drr ................. [[32mSUCCESS 1[0m in 2.95s]
[0m19:29:04.342321 [debug] [Thread-1 (]: Finished running node model.mini_project.nrr_and_drr
[0m19:29:04.342321 [debug] [Thread-1 (]: Began running node model.mini_project.customer_rank
[0m19:29:04.342321 [info ] [Thread-1 (]: 12 of 22 START sql table model JOB_PORTAL.KPI.customer_rank .................... [RUN]
[0m19:29:04.342321 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.nrr_and_drr, now model.mini_project.customer_rank)
[0m19:29:04.342321 [debug] [Thread-1 (]: Began compiling node model.mini_project.customer_rank
[0m19:29:04.342321 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.customer_rank"
[0m19:29:04.342321 [debug] [Thread-1 (]: Timing info for model.mini_project.customer_rank (compile): 19:29:04.342321 => 19:29:04.342321
[0m19:29:04.342321 [debug] [Thread-1 (]: Began executing node model.mini_project.customer_rank
[0m19:29:04.342321 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.customer_rank"
[0m19:29:04.342321 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.customer_rank"
[0m19:29:04.342321 [debug] [Thread-1 (]: On model.mini_project.customer_rank: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.customer_rank"} */
create or replace transient table JOB_PORTAL.KPI.customer_rank
         as
        (
with
  cte_1 as (
    select
      T.customer_id,
      c.customername,
      c.country,
      sum(T.revenue) as revenue
    from
      JOB_PORTAL.PREP.prep_transaction T
      LEFT JOIN JOB_PORTAL.PREP.prep_customers c on T.customer_id = c.customer_id
    where
      T.revenue_type = 1
    group by
      T.customer_id,
      c.customername,
      c.country
  ),
  cte_2 as (
    select
      customer_id,
      customername,
      country,
      revenue,
      dense_rank() over (
        order by
          revenue desc
      )
    from
      cte_1
  )
select
  *
from
  cte_2
        );
[0m19:29:04.342321 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:29:06.907561 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:29:06.907561 [debug] [Thread-2 (]: Timing info for model.mini_project.product_rank (execute): 19:29:03.969584 => 19:29:06.907561
[0m19:29:06.907561 [debug] [Thread-2 (]: On model.mini_project.product_rank: Close
[0m19:29:07.152457 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:29:07.154731 [debug] [Thread-1 (]: Timing info for model.mini_project.customer_rank (execute): 19:29:04.342321 => 19:29:07.154731
[0m19:29:07.155698 [debug] [Thread-1 (]: On model.mini_project.customer_rank: Close
[0m19:29:07.569859 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '658302f6-fcf5-4f68-9d74-f41643baba4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A50B86E0>]}
[0m19:29:07.571143 [info ] [Thread-2 (]: 11 of 22 OK created sql table model JOB_PORTAL.KPI.product_rank ................ [[32mSUCCESS 1[0m in 3.62s]
[0m19:29:07.572286 [debug] [Thread-2 (]: Finished running node model.mini_project.product_rank
[0m19:29:07.572286 [debug] [Thread-2 (]: Began running node model.mini_project.prep_fulldata
[0m19:29:07.572286 [info ] [Thread-2 (]: 13 of 22 START sql table model JOB_PORTAL.PREP.prep_fulldata ................... [RUN]
[0m19:29:07.573551 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mini_project.product_rank, now model.mini_project.prep_fulldata)
[0m19:29:07.574547 [debug] [Thread-2 (]: Began compiling node model.mini_project.prep_fulldata
[0m19:29:07.577546 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.prep_fulldata"
[0m19:29:07.580114 [debug] [Thread-2 (]: Timing info for model.mini_project.prep_fulldata (compile): 19:29:07.574547 => 19:29:07.580114
[0m19:29:07.581154 [debug] [Thread-2 (]: Began executing node model.mini_project.prep_fulldata
[0m19:29:07.583152 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.prep_fulldata"
[0m19:29:07.585120 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.prep_fulldata"
[0m19:29:07.586120 [debug] [Thread-2 (]: On model.mini_project.prep_fulldata: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.prep_fulldata"} */
create or replace transient table JOB_PORTAL.PREP.prep_fulldata
         as
        (
WITH CTE_1 AS(
    SELECT DISTINCT
        ST.CUSTOMER_ID,
        ST.PRODUCT_ID,
        ST.PAYMENT_MONTH,
        ST.REVENUE,
        ST.REVENUE_TYPE,
        ST.QUANTITY,
        CUST.COMPANY AS CUSTOMER_COMPANY,
        CUST.CUSTOMERNAME AS CUSTOMER_NAME,
        PROD.PRODUCT_FAMILY,
        PROD.PRODUCT_SUB_FAMILY
    FROM JOB_PORTAL.PREP.prep_transaction ST
    LEFT JOIN JOB_PORTAL.PREP.prep_customers CUST ON ST.CUSTOMER_ID = CUST.CUSTOMER_ID
    LEFT JOIN JOB_PORTAL.PREP.prep_products PROD ON ST.PRODUCT_ID = PROD.PRODUCT_ID
)
SELECT
     *
FROM
    CTE_1
    WHERE REVENUE_TYPE = 1
        );
[0m19:29:07.586471 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:29:07.809232 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '658302f6-fcf5-4f68-9d74-f41643baba4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A50B7A70>]}
[0m19:29:07.810231 [info ] [Thread-1 (]: 12 of 22 OK created sql table model JOB_PORTAL.KPI.customer_rank ............... [[32mSUCCESS 1[0m in 3.47s]
[0m19:29:07.812166 [debug] [Thread-1 (]: Finished running node model.mini_project.customer_rank
[0m19:29:07.812166 [debug] [Thread-1 (]: Began running node model.mini_project.mart_churn_and_newcustomers
[0m19:29:07.813331 [info ] [Thread-1 (]: 14 of 22 START sql table model JOB_PORTAL.MART.mart_churn_and_newcustomers ..... [RUN]
[0m19:29:07.814295 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.customer_rank, now model.mini_project.mart_churn_and_newcustomers)
[0m19:29:07.815296 [debug] [Thread-1 (]: Began compiling node model.mini_project.mart_churn_and_newcustomers
[0m19:29:07.819812 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.mart_churn_and_newcustomers"
[0m19:29:07.821572 [debug] [Thread-1 (]: Timing info for model.mini_project.mart_churn_and_newcustomers (compile): 19:29:07.816295 => 19:29:07.821572
[0m19:29:07.822475 [debug] [Thread-1 (]: Began executing node model.mini_project.mart_churn_and_newcustomers
[0m19:29:07.826206 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.mart_churn_and_newcustomers"
[0m19:29:07.826206 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.mart_churn_and_newcustomers"
[0m19:29:07.826206 [debug] [Thread-1 (]: On model.mini_project.mart_churn_and_newcustomers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.mart_churn_and_newcustomers"} */
create or replace transient table JOB_PORTAL.MART.mart_churn_and_newcustomers
         as
        (
SELECT
     *
FROM
    JOB_PORTAL.KPI.churn_and_newcustomers
        );
[0m19:29:07.826206 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:29:10.304720 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:29:10.307724 [debug] [Thread-1 (]: Timing info for model.mini_project.mart_churn_and_newcustomers (execute): 19:29:07.823303 => 19:29:10.307724
[0m19:29:10.307724 [debug] [Thread-1 (]: On model.mini_project.mart_churn_and_newcustomers: Close
[0m19:29:10.545015 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:29:10.547016 [debug] [Thread-2 (]: Timing info for model.mini_project.prep_fulldata (execute): 19:29:07.581154 => 19:29:10.547016
[0m19:29:10.548016 [debug] [Thread-2 (]: On model.mini_project.prep_fulldata: Close
[0m19:29:10.942855 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '658302f6-fcf5-4f68-9d74-f41643baba4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A4FB28A0>]}
[0m19:29:10.942855 [info ] [Thread-1 (]: 14 of 22 OK created sql table model JOB_PORTAL.MART.mart_churn_and_newcustomers  [[32mSUCCESS 1[0m in 3.13s]
[0m19:29:10.942855 [debug] [Thread-1 (]: Finished running node model.mini_project.mart_churn_and_newcustomers
[0m19:29:10.942855 [debug] [Thread-1 (]: Began running node model.mini_project.mart_fiscal_year_logos
[0m19:29:10.942855 [info ] [Thread-1 (]: 15 of 22 START sql table model JOB_PORTAL.MART.mart_fiscal_year_logos .......... [RUN]
[0m19:29:10.942855 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.mart_churn_and_newcustomers, now model.mini_project.mart_fiscal_year_logos)
[0m19:29:10.942855 [debug] [Thread-1 (]: Began compiling node model.mini_project.mart_fiscal_year_logos
[0m19:29:10.958083 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.mart_fiscal_year_logos"
[0m19:29:10.960082 [debug] [Thread-1 (]: Timing info for model.mini_project.mart_fiscal_year_logos (compile): 19:29:10.942855 => 19:29:10.960082
[0m19:29:10.960082 [debug] [Thread-1 (]: Began executing node model.mini_project.mart_fiscal_year_logos
[0m19:29:10.963081 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.mart_fiscal_year_logos"
[0m19:29:10.965083 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.mart_fiscal_year_logos"
[0m19:29:10.965083 [debug] [Thread-1 (]: On model.mini_project.mart_fiscal_year_logos: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.mart_fiscal_year_logos"} */
create or replace transient table JOB_PORTAL.MART.mart_fiscal_year_logos
         as
        (
SELECT
     *
FROM
    JOB_PORTAL.KPI.fiscal_year_logos
        );
[0m19:29:10.966082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:29:11.185279 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '658302f6-fcf5-4f68-9d74-f41643baba4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A50B84A0>]}
[0m19:29:11.186281 [info ] [Thread-2 (]: 13 of 22 OK created sql table model JOB_PORTAL.PREP.prep_fulldata .............. [[32mSUCCESS 1[0m in 3.61s]
[0m19:29:11.187234 [debug] [Thread-2 (]: Finished running node model.mini_project.prep_fulldata
[0m19:29:11.188273 [debug] [Thread-2 (]: Began running node model.mini_project.mart_monthly_loss
[0m19:29:11.189242 [info ] [Thread-2 (]: 16 of 22 SKIP relation MART.mart_monthly_loss .................................. [[33mSKIP[0m]
[0m19:29:11.189768 [debug] [Thread-2 (]: Finished running node model.mini_project.mart_monthly_loss
[0m19:29:11.189768 [debug] [Thread-2 (]: Began running node model.mini_project.mart_nrr_and_drr
[0m19:29:11.189768 [info ] [Thread-2 (]: 17 of 22 START sql table model JOB_PORTAL.MART.mart_nrr_and_drr ................ [RUN]
[0m19:29:11.189768 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mini_project.prep_fulldata, now model.mini_project.mart_nrr_and_drr)
[0m19:29:11.193442 [debug] [Thread-2 (]: Began compiling node model.mini_project.mart_nrr_and_drr
[0m19:29:11.198485 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.mart_nrr_and_drr"
[0m19:29:11.198485 [debug] [Thread-2 (]: Timing info for model.mini_project.mart_nrr_and_drr (compile): 19:29:11.193442 => 19:29:11.198485
[0m19:29:11.198485 [debug] [Thread-2 (]: Began executing node model.mini_project.mart_nrr_and_drr
[0m19:29:11.198485 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.mart_nrr_and_drr"
[0m19:29:11.198485 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.mart_nrr_and_drr"
[0m19:29:11.198485 [debug] [Thread-2 (]: On model.mini_project.mart_nrr_and_drr: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.mart_nrr_and_drr"} */
create or replace transient table JOB_PORTAL.MART.mart_nrr_and_drr
         as
        (
SELECT
     *
FROM
    JOB_PORTAL.KPI.nrr_and_drr
        );
[0m19:29:11.206571 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:29:13.542321 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:29:13.542321 [debug] [Thread-1 (]: Timing info for model.mini_project.mart_fiscal_year_logos (execute): 19:29:10.961082 => 19:29:13.542321
[0m19:29:13.542321 [debug] [Thread-1 (]: On model.mini_project.mart_fiscal_year_logos: Close
[0m19:29:13.866363 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:29:13.874449 [debug] [Thread-2 (]: Timing info for model.mini_project.mart_nrr_and_drr (execute): 19:29:11.198485 => 19:29:13.874449
[0m19:29:13.876938 [debug] [Thread-2 (]: On model.mini_project.mart_nrr_and_drr: Close
[0m19:29:14.190704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '658302f6-fcf5-4f68-9d74-f41643baba4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A50EB770>]}
[0m19:29:14.190704 [info ] [Thread-1 (]: 15 of 22 OK created sql table model JOB_PORTAL.MART.mart_fiscal_year_logos ..... [[32mSUCCESS 1[0m in 3.25s]
[0m19:29:14.190704 [debug] [Thread-1 (]: Finished running node model.mini_project.mart_fiscal_year_logos
[0m19:29:14.190704 [debug] [Thread-1 (]: Began running node model.mini_project.mart_product_rank
[0m19:29:14.190704 [info ] [Thread-1 (]: 18 of 22 START sql table model JOB_PORTAL.MART.mart_product_rank ............... [RUN]
[0m19:29:14.204446 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.mart_fiscal_year_logos, now model.mini_project.mart_product_rank)
[0m19:29:14.204446 [debug] [Thread-1 (]: Began compiling node model.mini_project.mart_product_rank
[0m19:29:14.206452 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.mart_product_rank"
[0m19:29:14.206452 [debug] [Thread-1 (]: Timing info for model.mini_project.mart_product_rank (compile): 19:29:14.204446 => 19:29:14.206452
[0m19:29:14.206452 [debug] [Thread-1 (]: Began executing node model.mini_project.mart_product_rank
[0m19:29:14.206452 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.mart_product_rank"
[0m19:29:14.206452 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.mart_product_rank"
[0m19:29:14.206452 [debug] [Thread-1 (]: On model.mini_project.mart_product_rank: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.mart_product_rank"} */
create or replace transient table JOB_PORTAL.MART.mart_product_rank
         as
        (
SELECT
     *
FROM
    JOB_PORTAL.KPI.product_rank
        );
[0m19:29:14.206452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:29:14.528169 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '658302f6-fcf5-4f68-9d74-f41643baba4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A50C7AD0>]}
[0m19:29:14.528169 [info ] [Thread-2 (]: 17 of 22 OK created sql table model JOB_PORTAL.MART.mart_nrr_and_drr ........... [[32mSUCCESS 1[0m in 3.34s]
[0m19:29:14.528169 [debug] [Thread-2 (]: Finished running node model.mini_project.mart_nrr_and_drr
[0m19:29:14.528169 [debug] [Thread-2 (]: Began running node model.mini_project.mart_customer_rank
[0m19:29:14.528169 [info ] [Thread-2 (]: 19 of 22 START sql table model JOB_PORTAL.MART.mart_customer_rank .............. [RUN]
[0m19:29:14.528169 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mini_project.mart_nrr_and_drr, now model.mini_project.mart_customer_rank)
[0m19:29:14.528169 [debug] [Thread-2 (]: Began compiling node model.mini_project.mart_customer_rank
[0m19:29:14.536113 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.mart_customer_rank"
[0m19:29:14.536113 [debug] [Thread-2 (]: Timing info for model.mini_project.mart_customer_rank (compile): 19:29:14.528169 => 19:29:14.536113
[0m19:29:14.536113 [debug] [Thread-2 (]: Began executing node model.mini_project.mart_customer_rank
[0m19:29:14.536113 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.mart_customer_rank"
[0m19:29:14.536113 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.mart_customer_rank"
[0m19:29:14.536113 [debug] [Thread-2 (]: On model.mini_project.mart_customer_rank: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.mart_customer_rank"} */
create or replace transient table JOB_PORTAL.MART.mart_customer_rank
         as
        (
SELECT
     *
FROM
    JOB_PORTAL.KPI.customer_rank
        );
[0m19:29:14.536113 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:29:16.710477 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:29:16.714527 [debug] [Thread-1 (]: Timing info for model.mini_project.mart_product_rank (execute): 19:29:14.206452 => 19:29:16.714527
[0m19:29:16.715522 [debug] [Thread-1 (]: On model.mini_project.mart_product_rank: Close
[0m19:29:17.063315 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:29:17.078468 [debug] [Thread-2 (]: Timing info for model.mini_project.mart_customer_rank (execute): 19:29:14.536113 => 19:29:17.078468
[0m19:29:17.078468 [debug] [Thread-2 (]: On model.mini_project.mart_customer_rank: Close
[0m19:29:17.350300 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '658302f6-fcf5-4f68-9d74-f41643baba4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A50EB7D0>]}
[0m19:29:17.350300 [info ] [Thread-1 (]: 18 of 22 OK created sql table model JOB_PORTAL.MART.mart_product_rank .......... [[32mSUCCESS 1[0m in 3.16s]
[0m19:29:17.350300 [debug] [Thread-1 (]: Finished running node model.mini_project.mart_product_rank
[0m19:29:17.350300 [debug] [Thread-1 (]: Began running node model.mini_project.cross_sell_and_product_churn
[0m19:29:17.350300 [info ] [Thread-1 (]: 20 of 22 START sql table model JOB_PORTAL.KPI.cross_sell_and_product_churn ..... [RUN]
[0m19:29:17.350300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.mart_product_rank, now model.mini_project.cross_sell_and_product_churn)
[0m19:29:17.350300 [debug] [Thread-1 (]: Began compiling node model.mini_project.cross_sell_and_product_churn
[0m19:29:17.365415 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.cross_sell_and_product_churn"
[0m19:29:17.366415 [debug] [Thread-1 (]: Timing info for model.mini_project.cross_sell_and_product_churn (compile): 19:29:17.350300 => 19:29:17.366415
[0m19:29:17.367382 [debug] [Thread-1 (]: Began executing node model.mini_project.cross_sell_and_product_churn
[0m19:29:17.370415 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.cross_sell_and_product_churn"
[0m19:29:17.373414 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.cross_sell_and_product_churn"
[0m19:29:17.374416 [debug] [Thread-1 (]: On model.mini_project.cross_sell_and_product_churn: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.cross_sell_and_product_churn"} */
create or replace transient table JOB_PORTAL.KPI.cross_sell_and_product_churn
         as
        (
 WITH customer_data AS (
    SELECT
        CUSTOMER_NAME,
        PRODUCT_ID,
        PRODUCT_FAMILY,
        PAYMENT_MONTH
    FROM
        JOB_PORTAL.PREP.prep_fulldata
),
max_payment_month AS (
    SELECT
        MAX(PAYMENT_MONTH) AS max_payment_month
    FROM
        JOB_PORTAL.PREP.prep_fulldata
),
full_table AS (
    SELECT
        c.CUSTOMER_NAME,
        c.PRODUCT_ID,
        c.PRODUCT_FAMILY,
        c.PAYMENT_MONTH,
        m.max_payment_month
    FROM
        customer_data c
    JOIN
        max_payment_month m ON 1=1
),
product_count AS (
    SELECT
        CUSTOMER_NAME,
        COUNT(DISTINCT PRODUCT_ID) AS product_count
    FROM
        customer_data
    GROUP BY
        CUSTOMER_NAME
),
product_churn AS (
    SELECT
        CUSTOMER_NAME,
        COUNT(DISTINCT CASE WHEN PAYMENT_MONTH < DATEADD(MONTH,-3,max_payment_month) THEN PRODUCT_ID END) AS Product_Churn
    FROM
        full_table
    GROUP BY
        CUSTOMER_NAME
),
ranked_customers AS (
    SELECT
        c.CUSTOMER_NAME,
        c.product_count,
        p.Product_Churn,
        (c.product_count-p.Product_Churn) AS Cross_Sell,
        DENSE_RANK() OVER (ORDER BY c.product_count-p.Product_Churn DESC) AS Cross_Sell_Rank,
        DENSE_RANK() OVER (ORDER BY p.Product_Churn DESC) AS Product_Churn_Rank
    FROM
        product_count c
    JOIN
        product_churn p ON c.CUSTOMER_NAME = p.CUSTOMER_NAME
)
SELECT
    CUSTOMER_NAME,
    product_count,
    Cross_Sell,
    Product_Churn,
    Cross_Sell_Rank,
    Product_Churn_Rank
FROM
    ranked_customers
ORDER BY
    Cross_Sell_Rank,
    Product_Churn_Rank
        );
[0m19:29:17.374416 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:29:17.741277 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '658302f6-fcf5-4f68-9d74-f41643baba4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A4E91070>]}
[0m19:29:17.741277 [info ] [Thread-2 (]: 19 of 22 OK created sql table model JOB_PORTAL.MART.mart_customer_rank ......... [[32mSUCCESS 1[0m in 3.21s]
[0m19:29:17.741277 [debug] [Thread-2 (]: Finished running node model.mini_project.mart_customer_rank
[0m19:29:17.741277 [debug] [Thread-2 (]: Began running node model.mini_project.prep_extradata
[0m19:29:17.741277 [info ] [Thread-2 (]: 21 of 22 START sql table model JOB_PORTAL.PREP.prep_extradata .................. [RUN]
[0m19:29:17.741277 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mini_project.mart_customer_rank, now model.mini_project.prep_extradata)
[0m19:29:17.741277 [debug] [Thread-2 (]: Began compiling node model.mini_project.prep_extradata
[0m19:29:17.741277 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.prep_extradata"
[0m19:29:17.741277 [debug] [Thread-2 (]: Timing info for model.mini_project.prep_extradata (compile): 19:29:17.741277 => 19:29:17.741277
[0m19:29:17.741277 [debug] [Thread-2 (]: Began executing node model.mini_project.prep_extradata
[0m19:29:17.741277 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.prep_extradata"
[0m19:29:17.741277 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.prep_extradata"
[0m19:29:17.757392 [debug] [Thread-2 (]: On model.mini_project.prep_extradata: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.prep_extradata"} */
create or replace transient table JOB_PORTAL.PREP.prep_extradata
         as
        (SELECT CUSTOMER_ID, 
PRODUCT_ID, 
LAG(PAYMENT_MONTH) OVER(
  PARTITION BY CUSTOMER_ID 
  ORDER BY 
    PAYMENT_MONTH
) AS LAST_MONTH, 
PAYMENT_MONTH, 
REVENUE, 
SUM(REVENUE) OVER(
  PARTITION BY PAYMENT_MONTH 
  ORDER BY 
    PAYMENT_MONTH
) AS MONTH_REVENUE, 
CUSTOMER_NAME, 
PRODUCT_FAMILY, 
PRODUCT_SUB_FAMILY, 
LAG(PRODUCT_FAMILY) OVER(
  PARTITION BY CUSTOMER_ID, 
  PAYMENT_MONTH 
  ORDER BY 
    PAYMENT_MONTH
) AS LAST_PRODUCT, 
LAG(PRODUCT_SUB_FAMILY) OVER(
  PARTITION BY CUSTOMER_ID, 
  PAYMENT_MONTH 
  ORDER BY 
    PAYMENT_MONTH
) AS LAST_PRODUCT_SUB 
FROM 
  JOB_PORTAL.PREP.prep_fulldata 
ORDER BY 
  CUSTOMER_ID, 
  PAYMENT_MONTH
        );
[0m19:29:17.757392 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:29:19.892382 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:29:19.896384 [debug] [Thread-1 (]: Timing info for model.mini_project.cross_sell_and_product_churn (execute): 19:29:17.367382 => 19:29:19.896384
[0m19:29:19.897370 [debug] [Thread-1 (]: On model.mini_project.cross_sell_and_product_churn: Close
[0m19:29:20.547020 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '658302f6-fcf5-4f68-9d74-f41643baba4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A510E540>]}
[0m19:29:20.548466 [info ] [Thread-1 (]: 20 of 22 OK created sql table model JOB_PORTAL.KPI.cross_sell_and_product_churn  [[32mSUCCESS 1[0m in 3.20s]
[0m19:29:20.549700 [debug] [Thread-1 (]: Finished running node model.mini_project.cross_sell_and_product_churn
[0m19:29:20.550548 [debug] [Thread-1 (]: Began running node model.mini_project.mart_cross_sell_and_product_churn
[0m19:29:20.550548 [info ] [Thread-1 (]: 22 of 22 START sql table model JOB_PORTAL.MART.mart_cross_sell_and_product_churn  [RUN]
[0m19:29:20.551821 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.cross_sell_and_product_churn, now model.mini_project.mart_cross_sell_and_product_churn)
[0m19:29:20.551821 [debug] [Thread-1 (]: Began compiling node model.mini_project.mart_cross_sell_and_product_churn
[0m19:29:20.555783 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.mart_cross_sell_and_product_churn"
[0m19:29:20.556987 [debug] [Thread-1 (]: Timing info for model.mini_project.mart_cross_sell_and_product_churn (compile): 19:29:20.552855 => 19:29:20.556987
[0m19:29:20.558009 [debug] [Thread-1 (]: Began executing node model.mini_project.mart_cross_sell_and_product_churn
[0m19:29:20.560007 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.mart_cross_sell_and_product_churn"
[0m19:29:20.562007 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.mart_cross_sell_and_product_churn"
[0m19:29:20.562007 [debug] [Thread-1 (]: On model.mini_project.mart_cross_sell_and_product_churn: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.mart_cross_sell_and_product_churn"} */
create or replace transient table JOB_PORTAL.MART.mart_cross_sell_and_product_churn
         as
        (
SELECT
     *
FROM
    JOB_PORTAL.KPI.cross_sell_and_product_churn
        );
[0m19:29:20.562976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:29:20.709749 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:29:20.716210 [debug] [Thread-2 (]: Timing info for model.mini_project.prep_extradata (execute): 19:29:17.741277 => 19:29:20.715803
[0m19:29:20.717303 [debug] [Thread-2 (]: On model.mini_project.prep_extradata: Close
[0m19:29:21.368601 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '658302f6-fcf5-4f68-9d74-f41643baba4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A4AF4380>]}
[0m19:29:21.368601 [info ] [Thread-2 (]: 21 of 22 OK created sql table model JOB_PORTAL.PREP.prep_extradata ............. [[32mSUCCESS 1[0m in 3.63s]
[0m19:29:21.369573 [debug] [Thread-2 (]: Finished running node model.mini_project.prep_extradata
[0m19:29:23.202363 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:29:23.202363 [debug] [Thread-1 (]: Timing info for model.mini_project.mart_cross_sell_and_product_churn (execute): 19:29:20.558009 => 19:29:23.202363
[0m19:29:23.202363 [debug] [Thread-1 (]: On model.mini_project.mart_cross_sell_and_product_churn: Close
[0m19:29:23.852697 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '658302f6-fcf5-4f68-9d74-f41643baba4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A510EC60>]}
[0m19:29:23.852697 [info ] [Thread-1 (]: 22 of 22 OK created sql table model JOB_PORTAL.MART.mart_cross_sell_and_product_churn  [[32mSUCCESS 1[0m in 3.30s]
[0m19:29:23.852697 [debug] [Thread-1 (]: Finished running node model.mini_project.mart_cross_sell_and_product_churn
[0m19:29:23.867998 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:29:23.867998 [debug] [MainThread]: Connection 'list_JOB_PORTAL' was properly closed.
[0m19:29:23.867998 [debug] [MainThread]: Connection 'create_JOB_PORTAL_KPI' was properly closed.
[0m19:29:23.867998 [debug] [MainThread]: Connection 'list_JOB_PORTAL_RAW' was properly closed.
[0m19:29:23.867998 [debug] [MainThread]: Connection 'list_JOB_PORTAL_MART' was properly closed.
[0m19:29:23.867998 [debug] [MainThread]: Connection 'model.mini_project.mart_cross_sell_and_product_churn' was properly closed.
[0m19:29:23.867998 [debug] [MainThread]: Connection 'model.mini_project.prep_extradata' was properly closed.
[0m19:29:23.867998 [info ] [MainThread]: 
[0m19:29:23.867998 [info ] [MainThread]: Finished running 22 table models in 0 hours 0 minutes and 51.86 seconds (51.86s).
[0m19:29:23.875528 [debug] [MainThread]: Command end result
[0m19:29:23.886768 [info ] [MainThread]: 
[0m19:29:23.887761 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:29:23.888762 [info ] [MainThread]: 
[0m19:29:23.889658 [error] [MainThread]:   Database Error in model monthly_loss (models\crb\monthly_loss.sql)
  001003 (42000): SQL compilation error:
  syntax error line 31 at position 15 unexpected ';'.
  compiled Code at target\run\mini_project\models\crb\monthly_loss.sql
[0m19:29:23.891319 [info ] [MainThread]: 
[0m19:29:23.892541 [info ] [MainThread]: Done. PASS=20 WARN=0 ERROR=1 SKIP=1 TOTAL=22
[0m19:29:23.893572 [debug] [MainThread]: Command `dbt run` failed at 19:29:23.893572 after 52.77 seconds
[0m19:29:23.893572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A38A0E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A2A48980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A2B54B90>]}
[0m19:29:23.894570 [debug] [MainThread]: Flushing usage events
[0m19:29:33.536221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B234F4F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B234F4E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B234F5100>]}


============================== 19:29:33.536221 | 4f676da5-299b-4a74-aabe-cc40a7ca3faa ==============================
[0m19:29:33.536221 [info ] [MainThread]: Running with dbt=1.7.19
[0m19:29:33.536221 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\DasariUday\\.dbt', 'log_path': 'C:\\Users\\DasariUday\\venv\\.venv\\mini_project\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:29:33.954833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f676da5-299b-4a74-aabe-cc40a7ca3faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B23370EC0>]}
[0m19:29:34.013101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f676da5-299b-4a74-aabe-cc40a7ca3faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B252A6120>]}
[0m19:29:34.014397 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m19:29:34.022993 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m19:29:34.122716 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:29:34.123714 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:29:34.130255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f676da5-299b-4a74-aabe-cc40a7ca3faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B24110D70>]}
[0m19:29:34.143890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f676da5-299b-4a74-aabe-cc40a7ca3faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B25324110>]}
[0m19:29:34.143890 [info ] [MainThread]: Found 1 seed, 22 models, 4 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m19:29:34.144890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f676da5-299b-4a74-aabe-cc40a7ca3faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B242000E0>]}
[0m19:29:34.147585 [info ] [MainThread]: 
[0m19:29:34.148835 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:29:34.150758 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL'
[0m19:29:34.165252 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL"
[0m19:29:34.166249 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL'
[0m19:29:34.166249 [debug] [ThreadPool]: On list_JOB_PORTAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL"} */
show terse schemas in database JOB_PORTAL
    limit 10000
[0m19:29:34.168463 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL"
[0m19:29:34.169462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:29:34.169462 [debug] [ThreadPool]: On list_JOB_PORTAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL"} */
show terse schemas in database JOB_PORTAL
    limit 10000
[0m19:29:34.172495 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:29:36.044653 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m19:29:36.044653 [debug] [ThreadPool]: On list_JOB_PORTAL: Close
[0m19:29:36.077255 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m19:29:36.077255 [debug] [ThreadPool]: On list_JOB_PORTAL: Close
[0m19:29:36.693946 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL"
[0m19:29:36.693946 [debug] [ThreadPool]: On list_JOB_PORTAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL"} */
show terse schemas in database JOB_PORTAL
    limit 10000
[0m19:29:36.693946 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:29:36.726346 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL"
[0m19:29:36.726346 [debug] [ThreadPool]: On list_JOB_PORTAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL"} */
show terse schemas in database JOB_PORTAL
    limit 10000
[0m19:29:36.726346 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:29:38.718608 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m19:29:38.718608 [debug] [ThreadPool]: On list_JOB_PORTAL: Close
[0m19:29:38.731894 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m19:29:38.731894 [debug] [ThreadPool]: On list_JOB_PORTAL: Close
[0m19:29:39.424383 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m19:29:39.424383 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JOB_PORTAL_MART'
[0m19:29:39.440207 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m19:29:39.446702 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_MART"
[0m19:29:39.446702 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show terse objects in MINI_PROJECT.RAW limit 10000
[0m19:29:39.446702 [debug] [ThreadPool]: On list_JOB_PORTAL_MART: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_MART"} */
show terse objects in JOB_PORTAL.MART limit 10000
[0m19:29:39.446702 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:29:39.446702 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:29:41.209474 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m19:29:41.209474 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: Close
[0m19:29:41.235850 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m19:29:41.251173 [debug] [ThreadPool]: On list_JOB_PORTAL_MART: Close
[0m19:29:41.875291 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_RAW, now list_JOB_PORTAL_RAW)
[0m19:29:41.890378 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_RAW"
[0m19:29:41.890378 [debug] [ThreadPool]: On list_JOB_PORTAL_RAW: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_RAW"} */
show terse objects in JOB_PORTAL.RAW limit 10000
[0m19:29:41.890378 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:29:41.890378 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JOB_PORTAL_MART, now list_JOB_PORTAL_KPI)
[0m19:29:41.907518 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_KPI"
[0m19:29:41.907518 [debug] [ThreadPool]: On list_JOB_PORTAL_KPI: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_KPI"} */
show terse objects in JOB_PORTAL.KPI limit 10000
[0m19:29:41.907518 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:29:43.605861 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m19:29:43.605861 [debug] [ThreadPool]: On list_JOB_PORTAL_RAW: Close
[0m19:29:43.872966 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m19:29:43.872966 [debug] [ThreadPool]: On list_JOB_PORTAL_KPI: Close
[0m19:29:44.237539 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JOB_PORTAL_RAW, now list_JOB_PORTAL_PREP)
[0m19:29:44.237539 [debug] [ThreadPool]: Using snowflake connection "list_JOB_PORTAL_PREP"
[0m19:29:44.237539 [debug] [ThreadPool]: On list_JOB_PORTAL_PREP: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_JOB_PORTAL_PREP"} */
show terse objects in JOB_PORTAL.PREP limit 10000
[0m19:29:44.237539 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:29:46.009748 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m19:29:46.011626 [debug] [ThreadPool]: On list_JOB_PORTAL_PREP: Close
[0m19:29:46.654654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f676da5-299b-4a74-aabe-cc40a7ca3faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B254F83B0>]}
[0m19:29:46.654654 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m19:29:46.654654 [info ] [MainThread]: 
[0m19:29:46.668917 [debug] [Thread-1 (]: Began running node model.mini_project.raw_customers
[0m19:29:46.668917 [debug] [Thread-2 (]: Began running node model.mini_project.raw_products
[0m19:29:46.668917 [info ] [Thread-1 (]: 1 of 22 START sql table model JOB_PORTAL.RAW.raw_customers ..................... [RUN]
[0m19:29:46.668917 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project.raw_customers'
[0m19:29:46.668917 [info ] [Thread-2 (]: 2 of 22 START sql table model JOB_PORTAL.RAW.raw_products ...................... [RUN]
[0m19:29:46.668917 [debug] [Thread-1 (]: Began compiling node model.mini_project.raw_customers
[0m19:29:46.668917 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.mini_project.raw_products'
[0m19:29:46.684873 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.raw_customers"
[0m19:29:46.684873 [debug] [Thread-2 (]: Began compiling node model.mini_project.raw_products
[0m19:29:46.691515 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.raw_products"
[0m19:29:46.695351 [debug] [Thread-1 (]: Timing info for model.mini_project.raw_customers (compile): 19:29:46.668917 => 19:29:46.691515
[0m19:29:46.695351 [debug] [Thread-1 (]: Began executing node model.mini_project.raw_customers
[0m19:29:46.700725 [debug] [Thread-2 (]: Timing info for model.mini_project.raw_products (compile): 19:29:46.684873 => 19:29:46.700725
[0m19:29:46.716766 [debug] [Thread-2 (]: Began executing node model.mini_project.raw_products
[0m19:29:46.716766 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.raw_customers"
[0m19:29:46.729779 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.raw_products"
[0m19:29:46.729779 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.raw_customers"
[0m19:29:46.729779 [debug] [Thread-1 (]: On model.mini_project.raw_customers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.raw_customers"} */
create or replace transient table JOB_PORTAL.RAW.raw_customers
         as
        (
SELECT 
    * 
FROM 
    MINI_PROJECT.RAW.Customers 
    WHERE CUSTOMER_ID 
          IS NOT NULL
        );
[0m19:29:46.732543 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:29:46.732543 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.raw_products"
[0m19:29:46.732543 [debug] [Thread-2 (]: On model.mini_project.raw_products: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.raw_products"} */
create or replace transient table JOB_PORTAL.RAW.raw_products
         as
        (
SELECT 
     *
FROM 
     MINI_PROJECT.RAW.Products 
     WHERE PRODUCT_ID 
           IS NOT NULL
        );
[0m19:29:46.732543 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:29:49.347100 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:29:49.375985 [debug] [Thread-1 (]: Timing info for model.mini_project.raw_customers (execute): 19:29:46.695351 => 19:29:49.375985
[0m19:29:49.375985 [debug] [Thread-1 (]: On model.mini_project.raw_customers: Close
[0m19:29:49.394516 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:29:49.394516 [debug] [Thread-2 (]: Timing info for model.mini_project.raw_products (execute): 19:29:46.716766 => 19:29:49.394516
[0m19:29:49.394516 [debug] [Thread-2 (]: On model.mini_project.raw_products: Close
[0m19:29:50.026669 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f676da5-299b-4a74-aabe-cc40a7ca3faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B257061E0>]}
[0m19:29:50.026669 [info ] [Thread-1 (]: 1 of 22 OK created sql table model JOB_PORTAL.RAW.raw_customers ................ [[32mSUCCESS 1[0m in 3.36s]
[0m19:29:50.026669 [debug] [Thread-1 (]: Finished running node model.mini_project.raw_customers
[0m19:29:50.045700 [debug] [Thread-1 (]: Began running node model.mini_project.raw_transaction
[0m19:29:50.045700 [info ] [Thread-1 (]: 3 of 22 START sql table model JOB_PORTAL.RAW.raw_transaction ................... [RUN]
[0m19:29:50.053581 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.raw_customers, now model.mini_project.raw_transaction)
[0m19:29:50.055938 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f676da5-299b-4a74-aabe-cc40a7ca3faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B25705B50>]}
[0m19:29:50.057964 [debug] [Thread-1 (]: Began compiling node model.mini_project.raw_transaction
[0m19:29:50.062574 [info ] [Thread-2 (]: 2 of 22 OK created sql table model JOB_PORTAL.RAW.raw_products ................. [[32mSUCCESS 1[0m in 3.39s]
[0m19:29:50.062574 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.raw_transaction"
[0m19:29:50.073851 [debug] [Thread-2 (]: Finished running node model.mini_project.raw_products
[0m19:29:50.073851 [debug] [Thread-2 (]: Began running node model.mini_project.prep_customers
[0m19:29:50.073851 [info ] [Thread-2 (]: 4 of 22 START sql table model JOB_PORTAL.PREP.prep_customers ................... [RUN]
[0m19:29:50.078969 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mini_project.raw_products, now model.mini_project.prep_customers)
[0m19:29:50.078969 [debug] [Thread-2 (]: Began compiling node model.mini_project.prep_customers
[0m19:29:50.078969 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.prep_customers"
[0m19:29:50.078969 [debug] [Thread-1 (]: Timing info for model.mini_project.raw_transaction (compile): 19:29:50.062574 => 19:29:50.078969
[0m19:29:50.078969 [debug] [Thread-1 (]: Began executing node model.mini_project.raw_transaction
[0m19:29:50.078969 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.raw_transaction"
[0m19:29:50.089699 [debug] [Thread-2 (]: Timing info for model.mini_project.prep_customers (compile): 19:29:50.078969 => 19:29:50.089699
[0m19:29:50.089699 [debug] [Thread-2 (]: Began executing node model.mini_project.prep_customers
[0m19:29:50.089699 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.prep_customers"
[0m19:29:50.089699 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.raw_transaction"
[0m19:29:50.089699 [debug] [Thread-1 (]: On model.mini_project.raw_transaction: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.raw_transaction"} */
create or replace transient table JOB_PORTAL.RAW.raw_transaction
         as
        (
SELECT 
     *
FROM 
    MINI_PROJECT.RAW.Transaction 
    WHERE CUSTOMER_ID 
          IS NOT NULL
        );
[0m19:29:50.095679 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:29:50.095679 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.prep_customers"
[0m19:29:50.097913 [debug] [Thread-2 (]: On model.mini_project.prep_customers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.prep_customers"} */
create or replace transient table JOB_PORTAL.PREP.prep_customers
         as
        (
WITH CTE_1 AS(
    SELECT DISTINCT
    LOWER(TRIM(COMPANY)) AS COMPANY,
    CUSTOMER_ID::NUMBER AS CUSTOMER_ID,
    LOWER(
        REGEXP_REPLACE(
            TRIM(REGEXP_SUBSTR(CUSTOMERNAME, '^[^(]+')), 
            ',', 
            ''
        )
    ) AS CUSTOMERNAME,  --  name without commas

    
FROM JOB_PORTAL.RAW.raw_customers
)
SELECT
    C.COMPANY,
    C.CUSTOMER_ID,
    C.CUSTOMERNAME,
    T.country
FROM CTE_1 C LEFT JOIN MINI_PROJECT.RAW.Mapping T ON C.CUSTOMER_ID = T.CUSTOMER_ID
        );
[0m19:29:50.097913 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:29:52.643613 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:29:52.643613 [debug] [Thread-2 (]: Timing info for model.mini_project.prep_customers (execute): 19:29:50.089699 => 19:29:52.643613
[0m19:29:52.656434 [debug] [Thread-2 (]: On model.mini_project.prep_customers: Close
[0m19:29:52.719963 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:29:52.719963 [debug] [Thread-1 (]: Timing info for model.mini_project.raw_transaction (execute): 19:29:50.078969 => 19:29:52.719963
[0m19:29:52.719963 [debug] [Thread-1 (]: On model.mini_project.raw_transaction: Close
[0m19:29:53.287727 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f676da5-299b-4a74-aabe-cc40a7ca3faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B257EFB60>]}
[0m19:29:53.289734 [info ] [Thread-2 (]: 4 of 22 OK created sql table model JOB_PORTAL.PREP.prep_customers .............. [[32mSUCCESS 1[0m in 3.21s]
[0m19:29:53.289734 [debug] [Thread-2 (]: Finished running node model.mini_project.prep_customers
[0m19:29:53.289734 [debug] [Thread-2 (]: Began running node model.mini_project.prep_products
[0m19:29:53.289734 [info ] [Thread-2 (]: 5 of 22 START sql table model JOB_PORTAL.PREP.prep_products .................... [RUN]
[0m19:29:53.289734 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mini_project.prep_customers, now model.mini_project.prep_products)
[0m19:29:53.289734 [debug] [Thread-2 (]: Began compiling node model.mini_project.prep_products
[0m19:29:53.289734 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.prep_products"
[0m19:29:53.289734 [debug] [Thread-2 (]: Timing info for model.mini_project.prep_products (compile): 19:29:53.289734 => 19:29:53.289734
[0m19:29:53.289734 [debug] [Thread-2 (]: Began executing node model.mini_project.prep_products
[0m19:29:53.299361 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.prep_products"
[0m19:29:53.299361 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.prep_products"
[0m19:29:53.299361 [debug] [Thread-2 (]: On model.mini_project.prep_products: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.prep_products"} */
create or replace transient table JOB_PORTAL.PREP.prep_products
         as
        (
SELECT 
    PRODUCT_ID::VARCHAR AS PRODUCT_ID,
    LOWER(TRIM(PRODUCT_FAMILY)) AS PRODUCT_FAMILY,
    LOWER(TRIM(PRODUCT_SUB_FAMILY)) AS PRODUCT_SUB_FAMILY
FROM JOB_PORTAL.RAW.raw_products
        );
[0m19:29:53.299361 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:29:53.363812 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f676da5-299b-4a74-aabe-cc40a7ca3faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B257A9700>]}
[0m19:29:53.363812 [info ] [Thread-1 (]: 3 of 22 OK created sql table model JOB_PORTAL.RAW.raw_transaction .............. [[32mSUCCESS 1[0m in 3.32s]
[0m19:29:53.363812 [debug] [Thread-1 (]: Finished running node model.mini_project.raw_transaction
[0m19:29:53.363812 [debug] [Thread-1 (]: Began running node model.mini_project.prep_transaction
[0m19:29:53.363812 [info ] [Thread-1 (]: 6 of 22 START sql table model JOB_PORTAL.PREP.prep_transaction ................. [RUN]
[0m19:29:53.363812 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.raw_transaction, now model.mini_project.prep_transaction)
[0m19:29:53.363812 [debug] [Thread-1 (]: Began compiling node model.mini_project.prep_transaction
[0m19:29:53.379848 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.prep_transaction"
[0m19:29:53.379848 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_transaction (compile): 19:29:53.363812 => 19:29:53.379848
[0m19:29:53.379848 [debug] [Thread-1 (]: Began executing node model.mini_project.prep_transaction
[0m19:29:53.427395 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.prep_transaction"
[0m19:29:53.427395 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.prep_transaction"
[0m19:29:53.427395 [debug] [Thread-1 (]: On model.mini_project.prep_transaction: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.prep_transaction"} */
create or replace transient table JOB_PORTAL.PREP.prep_transaction
         as
        (
    SELECT DISTINCT
        CUSTOMER_ID::NUMBER AS CUSTOMER_ID,
        PRODUCT_ID::VARCHAR AS PRODUCT_ID,
        TO_DATE(PAYMENT_MONTH) AS PAYMENT_MONTH,
        REVENUE_TYPE::NUMBER AS REVENUE_TYPE,
        REVENUE::NUMBER(38,2) AS REVENUE,
        QUANTITY::NUMBER AS QUANTITY,
        LOWER(TRIM(COMPANIES)) AS COMPANIES
    FROM JOB_PORTAL.RAW.raw_transaction
        );
[0m19:29:53.427395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:29:56.027840 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:29:56.027840 [debug] [Thread-1 (]: Timing info for model.mini_project.prep_transaction (execute): 19:29:53.379848 => 19:29:56.027840
[0m19:29:56.027840 [debug] [Thread-1 (]: On model.mini_project.prep_transaction: Close
[0m19:29:56.121380 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:29:56.121380 [debug] [Thread-2 (]: Timing info for model.mini_project.prep_products (execute): 19:29:53.289734 => 19:29:56.121380
[0m19:29:56.121380 [debug] [Thread-2 (]: On model.mini_project.prep_products: Close
[0m19:29:56.701619 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f676da5-299b-4a74-aabe-cc40a7ca3faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B2581F410>]}
[0m19:29:56.701619 [info ] [Thread-1 (]: 6 of 22 OK created sql table model JOB_PORTAL.PREP.prep_transaction ............ [[32mSUCCESS 1[0m in 3.34s]
[0m19:29:56.701619 [debug] [Thread-1 (]: Finished running node model.mini_project.prep_transaction
[0m19:29:56.701619 [debug] [Thread-1 (]: Began running node model.mini_project.churn_and_newcustomers
[0m19:29:56.701619 [info ] [Thread-1 (]: 7 of 22 START sql table model JOB_PORTAL.KPI.churn_and_newcustomers ............ [RUN]
[0m19:29:56.701619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.prep_transaction, now model.mini_project.churn_and_newcustomers)
[0m19:29:56.701619 [debug] [Thread-1 (]: Began compiling node model.mini_project.churn_and_newcustomers
[0m19:29:56.701619 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.churn_and_newcustomers"
[0m19:29:56.717422 [debug] [Thread-1 (]: Timing info for model.mini_project.churn_and_newcustomers (compile): 19:29:56.701619 => 19:29:56.717422
[0m19:29:56.717422 [debug] [Thread-1 (]: Began executing node model.mini_project.churn_and_newcustomers
[0m19:29:56.717422 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.churn_and_newcustomers"
[0m19:29:56.717422 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.churn_and_newcustomers"
[0m19:29:56.717422 [debug] [Thread-1 (]: On model.mini_project.churn_and_newcustomers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.churn_and_newcustomers"} */
create or replace transient table JOB_PORTAL.KPI.churn_and_newcustomers
         as
        (
WITH
  CTE_1 AS (
    SELECT
      MAX(PAYMENT_MONTH) AS EOP
    FROM
      JOB_PORTAL.PREP.prep_transaction
  ),
  CTE_2 AS (
    SELECT
      *
    FROM
      JOB_PORTAL.PREP.prep_transaction
      INNER JOIN CTE_1 AS CT ON 1 = 1
  ),
  CTE_3 AS (
    SELECT
      CUSTOMER_ID,
      MAX(PAYMENT_MONTH) AS LATEST,
      MIN(PAYMENT_MONTH) AS FIRST,
      DATEADD (MONTH, -3, EOP) AS L3M,
      EOP,
      CASE
        WHEN (FIRST <= L3M) THEN 0
        ELSE 1
      END AS IS_NEW,
      CASE
        WHEN (
          FIRST <= L3M
          AND LATEST < EOP
        ) THEN 1
        ELSE 0
      END AS IS_CHURN
    FROM
      CTE_2
    GROUP BY
      CUSTOMER_ID,
      EOP
  )
SELECT
  SUM(IS_CHURN) AS CHURNED_CUSTOMERS,
  SUM(IS_NEW) AS NEW_CUSTOMERS,
  EOP
FROM
  CTE_3
GROUP BY
  EOP
        );
[0m19:29:56.717422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:29:56.765834 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f676da5-299b-4a74-aabe-cc40a7ca3faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B258247A0>]}
[0m19:29:56.765834 [info ] [Thread-2 (]: 5 of 22 OK created sql table model JOB_PORTAL.PREP.prep_products ............... [[32mSUCCESS 1[0m in 3.48s]
[0m19:29:56.765834 [debug] [Thread-2 (]: Finished running node model.mini_project.prep_products
[0m19:29:56.765834 [debug] [Thread-2 (]: Began running node model.mini_project.customer_rank
[0m19:29:56.765834 [info ] [Thread-2 (]: 8 of 22 START sql table model JOB_PORTAL.KPI.customer_rank ..................... [RUN]
[0m19:29:56.765834 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mini_project.prep_products, now model.mini_project.customer_rank)
[0m19:29:56.765834 [debug] [Thread-2 (]: Began compiling node model.mini_project.customer_rank
[0m19:29:56.778858 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.customer_rank"
[0m19:29:56.780863 [debug] [Thread-2 (]: Timing info for model.mini_project.customer_rank (compile): 19:29:56.765834 => 19:29:56.780863
[0m19:29:56.780863 [debug] [Thread-2 (]: Began executing node model.mini_project.customer_rank
[0m19:29:56.781869 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.customer_rank"
[0m19:29:56.781869 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.customer_rank"
[0m19:29:56.781869 [debug] [Thread-2 (]: On model.mini_project.customer_rank: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.customer_rank"} */
create or replace transient table JOB_PORTAL.KPI.customer_rank
         as
        (
with
  cte_1 as (
    select
      T.customer_id,
      c.customername,
      c.country,
      sum(T.revenue) as revenue
    from
      JOB_PORTAL.PREP.prep_transaction T
      LEFT JOIN JOB_PORTAL.PREP.prep_customers c on T.customer_id = c.customer_id
    where
      T.revenue_type = 1
    group by
      T.customer_id,
      c.customername,
      c.country
  ),
  cte_2 as (
    select
      customer_id,
      customername,
      country,
      revenue,
      dense_rank() over (
        order by
          revenue desc
      )
    from
      cte_1
  )
select
  *
from
  cte_2
        );
[0m19:29:56.781869 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:29:59.137472 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:29:59.137472 [debug] [Thread-1 (]: Timing info for model.mini_project.churn_and_newcustomers (execute): 19:29:56.717422 => 19:29:59.137472
[0m19:29:59.137472 [debug] [Thread-1 (]: On model.mini_project.churn_and_newcustomers: Close
[0m19:29:59.250343 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:29:59.252370 [debug] [Thread-2 (]: Timing info for model.mini_project.customer_rank (execute): 19:29:56.781869 => 19:29:59.252370
[0m19:29:59.252370 [debug] [Thread-2 (]: On model.mini_project.customer_rank: Close
[0m19:29:59.785841 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f676da5-299b-4a74-aabe-cc40a7ca3faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B256CDD60>]}
[0m19:29:59.785841 [info ] [Thread-1 (]: 7 of 22 OK created sql table model JOB_PORTAL.KPI.churn_and_newcustomers ....... [[32mSUCCESS 1[0m in 3.08s]
[0m19:29:59.785841 [debug] [Thread-1 (]: Finished running node model.mini_project.churn_and_newcustomers
[0m19:29:59.785841 [debug] [Thread-1 (]: Began running node model.mini_project.fiscal_year_logos
[0m19:29:59.785841 [info ] [Thread-1 (]: 9 of 22 START sql table model JOB_PORTAL.KPI.fiscal_year_logos ................. [RUN]
[0m19:29:59.785841 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.churn_and_newcustomers, now model.mini_project.fiscal_year_logos)
[0m19:29:59.785841 [debug] [Thread-1 (]: Began compiling node model.mini_project.fiscal_year_logos
[0m19:29:59.799285 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.fiscal_year_logos"
[0m19:29:59.799285 [debug] [Thread-1 (]: Timing info for model.mini_project.fiscal_year_logos (compile): 19:29:59.785841 => 19:29:59.799285
[0m19:29:59.799285 [debug] [Thread-1 (]: Began executing node model.mini_project.fiscal_year_logos
[0m19:29:59.799285 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.fiscal_year_logos"
[0m19:29:59.799285 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.fiscal_year_logos"
[0m19:29:59.799285 [debug] [Thread-1 (]: On model.mini_project.fiscal_year_logos: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.fiscal_year_logos"} */
create or replace transient table JOB_PORTAL.KPI.fiscal_year_logos
         as
        (
WITH CTE_1 AS(
  SELECT 
    CUSTOMER_ID, 
    MIN(PAYMENT_MONTH) AS FIRST_MONTH 
  FROM 
    JOB_PORTAL.PREP.prep_transaction 
  GROUP BY 
    CUSTOMER_ID
) 
SELECT 
  DISTINCT DATE_TRUNC('YEAR', FIRST_MONTH) AS FISCAL_YEAR, 
  (
    COUNT(CUSTOMER_ID)
  ) AS NEW_CUSTOMERS 
FROM 
  CTE_1 
GROUP BY 
  FISCAL_YEAR
        );
[0m19:29:59.799285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:29:59.921590 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f676da5-299b-4a74-aabe-cc40a7ca3faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B252D9220>]}
[0m19:29:59.921590 [info ] [Thread-2 (]: 8 of 22 OK created sql table model JOB_PORTAL.KPI.customer_rank ................ [[32mSUCCESS 1[0m in 3.16s]
[0m19:29:59.921590 [debug] [Thread-2 (]: Finished running node model.mini_project.customer_rank
[0m19:29:59.921590 [debug] [Thread-2 (]: Began running node model.mini_project.monthly_loss
[0m19:29:59.921590 [info ] [Thread-2 (]: 10 of 22 START sql table model JOB_PORTAL.KPI.monthly_loss ..................... [RUN]
[0m19:29:59.921590 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mini_project.customer_rank, now model.mini_project.monthly_loss)
[0m19:29:59.921590 [debug] [Thread-2 (]: Began compiling node model.mini_project.monthly_loss
[0m19:29:59.928353 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.monthly_loss"
[0m19:29:59.928353 [debug] [Thread-2 (]: Timing info for model.mini_project.monthly_loss (compile): 19:29:59.921590 => 19:29:59.928353
[0m19:29:59.928353 [debug] [Thread-2 (]: Began executing node model.mini_project.monthly_loss
[0m19:29:59.928353 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.monthly_loss"
[0m19:29:59.928353 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.monthly_loss"
[0m19:29:59.928353 [debug] [Thread-2 (]: On model.mini_project.monthly_loss: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.monthly_loss"} */
create or replace transient table JOB_PORTAL.KPI.monthly_loss
         as
        (
WITH revenue_loss AS(
  SELECT 
    payment_month, 
    SUM(revenue) AS this_month_revenue, 
    LAG (
      SUM(revenue)
    ) OVER (
      ORDER BY 
        payment_month
    ) AS previous_month_revenue 
  FROM 
    JOB_PORTAL.PREP.prep_transaction 
  where 
    revenue_type = 1 
  GROUP BY 
    payment_month
) 
SELECT 
  PAYMENT_MONTH, 
  this_month_revenue, 
  PREVIOUS_MONTH_REVENUE, 
  This_month_revenue - PREVIOUS_MONTH_REVENUE AS MONTHLY_LOSS 
FROM 
  revenue_loss 
where 
  monthly_loss < 0 
ORDER BY 
  payment_month
        );
[0m19:29:59.928353 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:30:02.153472 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:30:02.153472 [debug] [Thread-1 (]: Timing info for model.mini_project.fiscal_year_logos (execute): 19:29:59.799285 => 19:30:02.153472
[0m19:30:02.153472 [debug] [Thread-1 (]: On model.mini_project.fiscal_year_logos: Close
[0m19:30:02.185844 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:30:02.197900 [debug] [Thread-2 (]: Timing info for model.mini_project.monthly_loss (execute): 19:29:59.928353 => 19:30:02.197900
[0m19:30:02.197900 [debug] [Thread-2 (]: On model.mini_project.monthly_loss: Close
[0m19:30:02.861535 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f676da5-299b-4a74-aabe-cc40a7ca3faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B252DBFE0>]}
[0m19:30:02.861535 [info ] [Thread-2 (]: 10 of 22 OK created sql table model JOB_PORTAL.KPI.monthly_loss ................ [[32mSUCCESS 1[0m in 2.94s]
[0m19:30:02.862503 [debug] [Thread-2 (]: Finished running node model.mini_project.monthly_loss
[0m19:30:02.863534 [debug] [Thread-2 (]: Began running node model.mini_project.nrr_and_drr
[0m19:30:02.863534 [info ] [Thread-2 (]: 11 of 22 START sql table model JOB_PORTAL.KPI.nrr_and_drr ...................... [RUN]
[0m19:30:02.864502 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mini_project.monthly_loss, now model.mini_project.nrr_and_drr)
[0m19:30:02.865534 [debug] [Thread-2 (]: Began compiling node model.mini_project.nrr_and_drr
[0m19:30:02.868480 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.nrr_and_drr"
[0m19:30:02.869476 [debug] [Thread-2 (]: Timing info for model.mini_project.nrr_and_drr (compile): 19:30:02.865534 => 19:30:02.869476
[0m19:30:02.870477 [debug] [Thread-2 (]: Began executing node model.mini_project.nrr_and_drr
[0m19:30:02.872476 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.nrr_and_drr"
[0m19:30:02.875525 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.nrr_and_drr"
[0m19:30:02.876596 [debug] [Thread-2 (]: On model.mini_project.nrr_and_drr: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.nrr_and_drr"} */
create or replace transient table JOB_PORTAL.KPI.nrr_and_drr
         as
        (with prev as (
    select
        customer_id,
        revenue,
        lag(revenue) over (partition by customer_id order by PAYMENT_MONTH) as previous_revenue
    from JOB_PORTAL.PREP.prep_transaction
),
transactions AS (
 SELECT
        customer_id,
        SUM(revenue) AS total_revenue,  
        sum(previous_revenue) as prev_total_revenue,
        CASE WHEN total_revenue > prev_total_revenue THEN total_revenue-prev_total_revenue ELSE 0 END AS expansion_revenue,  
        CASE WHEN total_revenue < prev_total_revenue THEN prev_total_revenue-total_revenue ELSE 0 END AS contraction_revenue  
    FROM prev
    GROUP BY 1
)
SELECT
    customer_id,
    total_revenue,
    prev_total_revenue,
    expansion_revenue,
    contraction_revenue,
    CASE
        WHEN total_revenue = 0 THEN 0
        ELSE (((total_revenue)+(expansion_revenue - contraction_revenue)) / total_revenue)*100
    END AS net_revenue_retention_in_percentage,
    CASE
        WHEN total_revenue = 0 THEN 0
        ELSE (((total_revenue)-(expansion_revenue - contraction_revenue)) / total_revenue)*100
    END AS gross_revenue_retention_in_percentage
FROM transactions
        );
[0m19:30:02.876596 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:30:03.050167 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f676da5-299b-4a74-aabe-cc40a7ca3faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B256B0AD0>]}
[0m19:30:03.051166 [info ] [Thread-1 (]: 9 of 22 OK created sql table model JOB_PORTAL.KPI.fiscal_year_logos ............ [[32mSUCCESS 1[0m in 3.26s]
[0m19:30:03.052113 [debug] [Thread-1 (]: Finished running node model.mini_project.fiscal_year_logos
[0m19:30:03.053152 [debug] [Thread-1 (]: Began running node model.mini_project.product_rank
[0m19:30:03.053152 [info ] [Thread-1 (]: 12 of 22 START sql table model JOB_PORTAL.KPI.product_rank ..................... [RUN]
[0m19:30:03.054119 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.fiscal_year_logos, now model.mini_project.product_rank)
[0m19:30:03.054119 [debug] [Thread-1 (]: Began compiling node model.mini_project.product_rank
[0m19:30:03.058102 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.product_rank"
[0m19:30:03.059562 [debug] [Thread-1 (]: Timing info for model.mini_project.product_rank (compile): 19:30:03.055152 => 19:30:03.059562
[0m19:30:03.060614 [debug] [Thread-1 (]: Began executing node model.mini_project.product_rank
[0m19:30:03.064226 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.product_rank"
[0m19:30:03.066224 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.product_rank"
[0m19:30:03.066224 [debug] [Thread-1 (]: On model.mini_project.product_rank: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.product_rank"} */
create or replace transient table JOB_PORTAL.KPI.product_rank
         as
        (
with
  cte_1 as (
    select
      product_id,
      sum(revenue) as revenue
    from
      JOB_PORTAL.PREP.prep_transaction
    where
      revenue_type = 1
    group by
      product_id
  ),
  cte_2 as (
    select
      product_id,
      revenue,
      dense_rank() over (
        order by
          revenue desc
      )
    from
      cte_1
  )
select
  *
from
  cte_2
        );
[0m19:30:03.066224 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:30:05.413308 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:30:05.415023 [debug] [Thread-2 (]: Timing info for model.mini_project.nrr_and_drr (execute): 19:30:02.870477 => 19:30:05.415023
[0m19:30:05.415023 [debug] [Thread-2 (]: On model.mini_project.nrr_and_drr: Close
[0m19:30:05.711160 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:30:05.718697 [debug] [Thread-1 (]: Timing info for model.mini_project.product_rank (execute): 19:30:03.060614 => 19:30:05.717698
[0m19:30:05.719699 [debug] [Thread-1 (]: On model.mini_project.product_rank: Close
[0m19:30:06.054477 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f676da5-299b-4a74-aabe-cc40a7ca3faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B25672F60>]}
[0m19:30:06.054477 [info ] [Thread-2 (]: 11 of 22 OK created sql table model JOB_PORTAL.KPI.nrr_and_drr ................. [[32mSUCCESS 1[0m in 3.19s]
[0m19:30:06.054477 [debug] [Thread-2 (]: Finished running node model.mini_project.nrr_and_drr
[0m19:30:06.054477 [debug] [Thread-2 (]: Began running node model.mini_project.prep_fulldata
[0m19:30:06.054477 [info ] [Thread-2 (]: 13 of 22 START sql table model JOB_PORTAL.PREP.prep_fulldata ................... [RUN]
[0m19:30:06.054477 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mini_project.nrr_and_drr, now model.mini_project.prep_fulldata)
[0m19:30:06.054477 [debug] [Thread-2 (]: Began compiling node model.mini_project.prep_fulldata
[0m19:30:06.065346 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.prep_fulldata"
[0m19:30:06.067351 [debug] [Thread-2 (]: Timing info for model.mini_project.prep_fulldata (compile): 19:30:06.054477 => 19:30:06.067351
[0m19:30:06.067351 [debug] [Thread-2 (]: Began executing node model.mini_project.prep_fulldata
[0m19:30:06.072504 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.prep_fulldata"
[0m19:30:06.074995 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.prep_fulldata"
[0m19:30:06.074995 [debug] [Thread-2 (]: On model.mini_project.prep_fulldata: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.prep_fulldata"} */
create or replace transient table JOB_PORTAL.PREP.prep_fulldata
         as
        (
WITH CTE_1 AS(
    SELECT DISTINCT
        ST.CUSTOMER_ID,
        ST.PRODUCT_ID,
        ST.PAYMENT_MONTH,
        ST.REVENUE,
        ST.REVENUE_TYPE,
        ST.QUANTITY,
        CUST.COMPANY AS CUSTOMER_COMPANY,
        CUST.CUSTOMERNAME AS CUSTOMER_NAME,
        PROD.PRODUCT_FAMILY,
        PROD.PRODUCT_SUB_FAMILY
    FROM JOB_PORTAL.PREP.prep_transaction ST
    LEFT JOIN JOB_PORTAL.PREP.prep_customers CUST ON ST.CUSTOMER_ID = CUST.CUSTOMER_ID
    LEFT JOIN JOB_PORTAL.PREP.prep_products PROD ON ST.PRODUCT_ID = PROD.PRODUCT_ID
)
SELECT
     *
FROM
    CTE_1
    WHERE REVENUE_TYPE = 1
        );
[0m19:30:06.074995 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:30:06.382379 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f676da5-299b-4a74-aabe-cc40a7ca3faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B2571AE40>]}
[0m19:30:06.385368 [info ] [Thread-1 (]: 12 of 22 OK created sql table model JOB_PORTAL.KPI.product_rank ................ [[32mSUCCESS 1[0m in 3.33s]
[0m19:30:06.390148 [debug] [Thread-1 (]: Finished running node model.mini_project.product_rank
[0m19:30:06.392081 [debug] [Thread-1 (]: Began running node model.mini_project.mart_churn_and_newcustomers
[0m19:30:06.392081 [info ] [Thread-1 (]: 14 of 22 START sql table model JOB_PORTAL.MART.mart_churn_and_newcustomers ..... [RUN]
[0m19:30:06.392897 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.product_rank, now model.mini_project.mart_churn_and_newcustomers)
[0m19:30:06.393923 [debug] [Thread-1 (]: Began compiling node model.mini_project.mart_churn_and_newcustomers
[0m19:30:06.397860 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.mart_churn_and_newcustomers"
[0m19:30:06.399827 [debug] [Thread-1 (]: Timing info for model.mini_project.mart_churn_and_newcustomers (compile): 19:30:06.393923 => 19:30:06.398859
[0m19:30:06.399827 [debug] [Thread-1 (]: Began executing node model.mini_project.mart_churn_and_newcustomers
[0m19:30:06.402828 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.mart_churn_and_newcustomers"
[0m19:30:06.404477 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.mart_churn_and_newcustomers"
[0m19:30:06.405475 [debug] [Thread-1 (]: On model.mini_project.mart_churn_and_newcustomers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.mart_churn_and_newcustomers"} */
create or replace transient table JOB_PORTAL.MART.mart_churn_and_newcustomers
         as
        (
SELECT
     *
FROM
    JOB_PORTAL.KPI.churn_and_newcustomers
        );
[0m19:30:06.405475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:30:08.833602 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:30:08.833602 [debug] [Thread-1 (]: Timing info for model.mini_project.mart_churn_and_newcustomers (execute): 19:30:06.400859 => 19:30:08.833602
[0m19:30:08.833602 [debug] [Thread-1 (]: On model.mini_project.mart_churn_and_newcustomers: Close
[0m19:30:09.044527 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:30:09.060424 [debug] [Thread-2 (]: Timing info for model.mini_project.prep_fulldata (execute): 19:30:06.067351 => 19:30:09.060424
[0m19:30:09.060424 [debug] [Thread-2 (]: On model.mini_project.prep_fulldata: Close
[0m19:30:09.496825 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f676da5-299b-4a74-aabe-cc40a7ca3faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B2571BF20>]}
[0m19:30:09.497784 [info ] [Thread-1 (]: 14 of 22 OK created sql table model JOB_PORTAL.MART.mart_churn_and_newcustomers  [[32mSUCCESS 1[0m in 3.10s]
[0m19:30:09.499795 [debug] [Thread-1 (]: Finished running node model.mini_project.mart_churn_and_newcustomers
[0m19:30:09.500824 [debug] [Thread-1 (]: Began running node model.mini_project.mart_customer_rank
[0m19:30:09.501823 [info ] [Thread-1 (]: 15 of 22 START sql table model JOB_PORTAL.MART.mart_customer_rank .............. [RUN]
[0m19:30:09.502823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.mart_churn_and_newcustomers, now model.mini_project.mart_customer_rank)
[0m19:30:09.503824 [debug] [Thread-1 (]: Began compiling node model.mini_project.mart_customer_rank
[0m19:30:09.508825 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.mart_customer_rank"
[0m19:30:09.510825 [debug] [Thread-1 (]: Timing info for model.mini_project.mart_customer_rank (compile): 19:30:09.503824 => 19:30:09.510825
[0m19:30:09.511788 [debug] [Thread-1 (]: Began executing node model.mini_project.mart_customer_rank
[0m19:30:09.517654 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.mart_customer_rank"
[0m19:30:09.518657 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.mart_customer_rank"
[0m19:30:09.519648 [debug] [Thread-1 (]: On model.mini_project.mart_customer_rank: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.mart_customer_rank"} */
create or replace transient table JOB_PORTAL.MART.mart_customer_rank
         as
        (
SELECT
     *
FROM
    JOB_PORTAL.KPI.customer_rank
        );
[0m19:30:09.519648 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:30:09.706624 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f676da5-299b-4a74-aabe-cc40a7ca3faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B254B0530>]}
[0m19:30:09.706624 [info ] [Thread-2 (]: 13 of 22 OK created sql table model JOB_PORTAL.PREP.prep_fulldata .............. [[32mSUCCESS 1[0m in 3.65s]
[0m19:30:09.706624 [debug] [Thread-2 (]: Finished running node model.mini_project.prep_fulldata
[0m19:30:09.706624 [debug] [Thread-2 (]: Began running node model.mini_project.mart_monthly_loss
[0m19:30:09.712639 [info ] [Thread-2 (]: 16 of 22 START sql table model JOB_PORTAL.MART.mart_monthly_loss ............... [RUN]
[0m19:30:09.713426 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mini_project.prep_fulldata, now model.mini_project.mart_monthly_loss)
[0m19:30:09.713426 [debug] [Thread-2 (]: Began compiling node model.mini_project.mart_monthly_loss
[0m19:30:09.713426 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.mart_monthly_loss"
[0m19:30:09.713426 [debug] [Thread-2 (]: Timing info for model.mini_project.mart_monthly_loss (compile): 19:30:09.713426 => 19:30:09.713426
[0m19:30:09.713426 [debug] [Thread-2 (]: Began executing node model.mini_project.mart_monthly_loss
[0m19:30:09.713426 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.mart_monthly_loss"
[0m19:30:09.713426 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.mart_monthly_loss"
[0m19:30:09.713426 [debug] [Thread-2 (]: On model.mini_project.mart_monthly_loss: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.mart_monthly_loss"} */
create or replace transient table JOB_PORTAL.MART.mart_monthly_loss
         as
        (
SELECT
     *
FROM
    JOB_PORTAL.KPI.monthly_loss
        );
[0m19:30:09.713426 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:30:12.359847 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:30:12.359847 [debug] [Thread-2 (]: Timing info for model.mini_project.mart_monthly_loss (execute): 19:30:09.713426 => 19:30:12.359847
[0m19:30:12.359847 [debug] [Thread-2 (]: On model.mini_project.mart_monthly_loss: Close
[0m19:30:12.424638 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:30:12.440375 [debug] [Thread-1 (]: Timing info for model.mini_project.mart_customer_rank (execute): 19:30:09.512824 => 19:30:12.440375
[0m19:30:12.440375 [debug] [Thread-1 (]: On model.mini_project.mart_customer_rank: Close
[0m19:30:13.018025 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f676da5-299b-4a74-aabe-cc40a7ca3faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B254B3D70>]}
[0m19:30:13.018025 [info ] [Thread-2 (]: 16 of 22 OK created sql table model JOB_PORTAL.MART.mart_monthly_loss .......... [[32mSUCCESS 1[0m in 3.30s]
[0m19:30:13.018025 [debug] [Thread-2 (]: Finished running node model.mini_project.mart_monthly_loss
[0m19:30:13.018025 [debug] [Thread-2 (]: Began running node model.mini_project.mart_fiscal_year_logos
[0m19:30:13.018025 [info ] [Thread-2 (]: 17 of 22 START sql table model JOB_PORTAL.MART.mart_fiscal_year_logos .......... [RUN]
[0m19:30:13.018025 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mini_project.mart_monthly_loss, now model.mini_project.mart_fiscal_year_logos)
[0m19:30:13.018025 [debug] [Thread-2 (]: Began compiling node model.mini_project.mart_fiscal_year_logos
[0m19:30:13.030064 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.mart_fiscal_year_logos"
[0m19:30:13.030064 [debug] [Thread-2 (]: Timing info for model.mini_project.mart_fiscal_year_logos (compile): 19:30:13.018025 => 19:30:13.030064
[0m19:30:13.030064 [debug] [Thread-2 (]: Began executing node model.mini_project.mart_fiscal_year_logos
[0m19:30:13.030064 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.mart_fiscal_year_logos"
[0m19:30:13.030064 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.mart_fiscal_year_logos"
[0m19:30:13.030064 [debug] [Thread-2 (]: On model.mini_project.mart_fiscal_year_logos: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.mart_fiscal_year_logos"} */
create or replace transient table JOB_PORTAL.MART.mart_fiscal_year_logos
         as
        (
SELECT
     *
FROM
    JOB_PORTAL.KPI.fiscal_year_logos
        );
[0m19:30:13.030064 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:30:13.101002 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f676da5-299b-4a74-aabe-cc40a7ca3faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B257FA570>]}
[0m19:30:13.101736 [info ] [Thread-1 (]: 15 of 22 OK created sql table model JOB_PORTAL.MART.mart_customer_rank ......... [[32mSUCCESS 1[0m in 3.60s]
[0m19:30:13.103244 [debug] [Thread-1 (]: Finished running node model.mini_project.mart_customer_rank
[0m19:30:13.104289 [debug] [Thread-1 (]: Began running node model.mini_project.mart_nrr_and_drr
[0m19:30:13.105290 [info ] [Thread-1 (]: 18 of 22 START sql table model JOB_PORTAL.MART.mart_nrr_and_drr ................ [RUN]
[0m19:30:13.106252 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.mart_customer_rank, now model.mini_project.mart_nrr_and_drr)
[0m19:30:13.107286 [debug] [Thread-1 (]: Began compiling node model.mini_project.mart_nrr_and_drr
[0m19:30:13.112290 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.mart_nrr_and_drr"
[0m19:30:13.113293 [debug] [Thread-1 (]: Timing info for model.mini_project.mart_nrr_and_drr (compile): 19:30:13.108290 => 19:30:13.113293
[0m19:30:13.114253 [debug] [Thread-1 (]: Began executing node model.mini_project.mart_nrr_and_drr
[0m19:30:13.119253 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.mart_nrr_and_drr"
[0m19:30:13.119253 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.mart_nrr_and_drr"
[0m19:30:13.119253 [debug] [Thread-1 (]: On model.mini_project.mart_nrr_and_drr: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.mart_nrr_and_drr"} */
create or replace transient table JOB_PORTAL.MART.mart_nrr_and_drr
         as
        (
SELECT
     *
FROM
    JOB_PORTAL.KPI.nrr_and_drr
        );
[0m19:30:13.119253 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:30:15.474024 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:30:15.474024 [debug] [Thread-2 (]: Timing info for model.mini_project.mart_fiscal_year_logos (execute): 19:30:13.030064 => 19:30:15.474024
[0m19:30:15.474024 [debug] [Thread-2 (]: On model.mini_project.mart_fiscal_year_logos: Close
[0m19:30:15.505378 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:30:15.505378 [debug] [Thread-1 (]: Timing info for model.mini_project.mart_nrr_and_drr (execute): 19:30:13.114253 => 19:30:15.505378
[0m19:30:15.505378 [debug] [Thread-1 (]: On model.mini_project.mart_nrr_and_drr: Close
[0m19:30:16.148647 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f676da5-299b-4a74-aabe-cc40a7ca3faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B234F5D30>]}
[0m19:30:16.148647 [info ] [Thread-2 (]: 17 of 22 OK created sql table model JOB_PORTAL.MART.mart_fiscal_year_logos ..... [[32mSUCCESS 1[0m in 3.13s]
[0m19:30:16.148647 [debug] [Thread-2 (]: Finished running node model.mini_project.mart_fiscal_year_logos
[0m19:30:16.148647 [debug] [Thread-2 (]: Began running node model.mini_project.mart_product_rank
[0m19:30:16.148647 [info ] [Thread-2 (]: 19 of 22 START sql table model JOB_PORTAL.MART.mart_product_rank ............... [RUN]
[0m19:30:16.148647 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mini_project.mart_fiscal_year_logos, now model.mini_project.mart_product_rank)
[0m19:30:16.148647 [debug] [Thread-2 (]: Began compiling node model.mini_project.mart_product_rank
[0m19:30:16.155592 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.mart_product_rank"
[0m19:30:16.158112 [debug] [Thread-2 (]: Timing info for model.mini_project.mart_product_rank (compile): 19:30:16.148647 => 19:30:16.156837
[0m19:30:16.159112 [debug] [Thread-2 (]: Began executing node model.mini_project.mart_product_rank
[0m19:30:16.163658 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.mart_product_rank"
[0m19:30:16.164911 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f676da5-299b-4a74-aabe-cc40a7ca3faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B253C6360>]}
[0m19:30:16.166927 [info ] [Thread-1 (]: 18 of 22 OK created sql table model JOB_PORTAL.MART.mart_nrr_and_drr ........... [[32mSUCCESS 1[0m in 3.06s]
[0m19:30:16.168907 [debug] [Thread-1 (]: Finished running node model.mini_project.mart_nrr_and_drr
[0m19:30:16.168907 [debug] [Thread-1 (]: Began running node model.mini_project.cross_sell_and_product_churn
[0m19:30:16.171658 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.mart_product_rank"
[0m19:30:16.169908 [info ] [Thread-1 (]: 20 of 22 START sql table model JOB_PORTAL.KPI.cross_sell_and_product_churn ..... [RUN]
[0m19:30:16.176406 [debug] [Thread-2 (]: On model.mini_project.mart_product_rank: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.mart_product_rank"} */
create or replace transient table JOB_PORTAL.MART.mart_product_rank
         as
        (
SELECT
     *
FROM
    JOB_PORTAL.KPI.product_rank
        );
[0m19:30:16.177405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.mart_nrr_and_drr, now model.mini_project.cross_sell_and_product_churn)
[0m19:30:16.177405 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:30:16.178404 [debug] [Thread-1 (]: Began compiling node model.mini_project.cross_sell_and_product_churn
[0m19:30:16.182433 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.cross_sell_and_product_churn"
[0m19:30:16.184432 [debug] [Thread-1 (]: Timing info for model.mini_project.cross_sell_and_product_churn (compile): 19:30:16.179349 => 19:30:16.184432
[0m19:30:16.185433 [debug] [Thread-1 (]: Began executing node model.mini_project.cross_sell_and_product_churn
[0m19:30:16.190086 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.cross_sell_and_product_churn"
[0m19:30:16.193104 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.cross_sell_and_product_churn"
[0m19:30:16.194106 [debug] [Thread-1 (]: On model.mini_project.cross_sell_and_product_churn: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.cross_sell_and_product_churn"} */
create or replace transient table JOB_PORTAL.KPI.cross_sell_and_product_churn
         as
        (
 WITH customer_data AS (
    SELECT
        CUSTOMER_NAME,
        PRODUCT_ID,
        PRODUCT_FAMILY,
        PAYMENT_MONTH
    FROM
        JOB_PORTAL.PREP.prep_fulldata
),
max_payment_month AS (
    SELECT
        MAX(PAYMENT_MONTH) AS max_payment_month
    FROM
        JOB_PORTAL.PREP.prep_fulldata
),
full_table AS (
    SELECT
        c.CUSTOMER_NAME,
        c.PRODUCT_ID,
        c.PRODUCT_FAMILY,
        c.PAYMENT_MONTH,
        m.max_payment_month
    FROM
        customer_data c
    JOIN
        max_payment_month m ON 1=1
),
product_count AS (
    SELECT
        CUSTOMER_NAME,
        COUNT(DISTINCT PRODUCT_ID) AS product_count
    FROM
        customer_data
    GROUP BY
        CUSTOMER_NAME
),
product_churn AS (
    SELECT
        CUSTOMER_NAME,
        COUNT(DISTINCT CASE WHEN PAYMENT_MONTH < DATEADD(MONTH,-3,max_payment_month) THEN PRODUCT_ID END) AS Product_Churn
    FROM
        full_table
    GROUP BY
        CUSTOMER_NAME
),
ranked_customers AS (
    SELECT
        c.CUSTOMER_NAME,
        c.product_count,
        p.Product_Churn,
        (c.product_count-p.Product_Churn) AS Cross_Sell,
        DENSE_RANK() OVER (ORDER BY c.product_count-p.Product_Churn DESC) AS Cross_Sell_Rank,
        DENSE_RANK() OVER (ORDER BY p.Product_Churn DESC) AS Product_Churn_Rank
    FROM
        product_count c
    JOIN
        product_churn p ON c.CUSTOMER_NAME = p.CUSTOMER_NAME
)
SELECT
    CUSTOMER_NAME,
    product_count,
    Cross_Sell,
    Product_Churn,
    Cross_Sell_Rank,
    Product_Churn_Rank
FROM
    ranked_customers
ORDER BY
    Cross_Sell_Rank,
    Product_Churn_Rank
        );
[0m19:30:16.194106 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:30:18.654433 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:30:18.670277 [debug] [Thread-2 (]: Timing info for model.mini_project.mart_product_rank (execute): 19:30:16.160111 => 19:30:18.670277
[0m19:30:18.670277 [debug] [Thread-2 (]: On model.mini_project.mart_product_rank: Close
[0m19:30:19.055308 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:30:19.066318 [debug] [Thread-1 (]: Timing info for model.mini_project.cross_sell_and_product_churn (execute): 19:30:16.185433 => 19:30:19.065313
[0m19:30:19.068559 [debug] [Thread-1 (]: On model.mini_project.cross_sell_and_product_churn: Close
[0m19:30:19.321613 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f676da5-299b-4a74-aabe-cc40a7ca3faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B257FA8D0>]}
[0m19:30:19.321613 [info ] [Thread-2 (]: 19 of 22 OK created sql table model JOB_PORTAL.MART.mart_product_rank .......... [[32mSUCCESS 1[0m in 3.17s]
[0m19:30:19.321613 [debug] [Thread-2 (]: Finished running node model.mini_project.mart_product_rank
[0m19:30:19.321613 [debug] [Thread-2 (]: Began running node model.mini_project.prep_extradata
[0m19:30:19.321613 [info ] [Thread-2 (]: 21 of 22 START sql table model JOB_PORTAL.PREP.prep_extradata .................. [RUN]
[0m19:30:19.321613 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mini_project.mart_product_rank, now model.mini_project.prep_extradata)
[0m19:30:19.321613 [debug] [Thread-2 (]: Began compiling node model.mini_project.prep_extradata
[0m19:30:19.337365 [debug] [Thread-2 (]: Writing injected SQL for node "model.mini_project.prep_extradata"
[0m19:30:19.337365 [debug] [Thread-2 (]: Timing info for model.mini_project.prep_extradata (compile): 19:30:19.321613 => 19:30:19.337365
[0m19:30:19.337365 [debug] [Thread-2 (]: Began executing node model.mini_project.prep_extradata
[0m19:30:19.337365 [debug] [Thread-2 (]: Writing runtime sql for node "model.mini_project.prep_extradata"
[0m19:30:19.353507 [debug] [Thread-2 (]: Using snowflake connection "model.mini_project.prep_extradata"
[0m19:30:19.353507 [debug] [Thread-2 (]: On model.mini_project.prep_extradata: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.prep_extradata"} */
create or replace transient table JOB_PORTAL.PREP.prep_extradata
         as
        (SELECT CUSTOMER_ID, 
PRODUCT_ID, 
LAG(PAYMENT_MONTH) OVER(
  PARTITION BY CUSTOMER_ID 
  ORDER BY 
    PAYMENT_MONTH
) AS LAST_MONTH, 
PAYMENT_MONTH, 
REVENUE, 
SUM(REVENUE) OVER(
  PARTITION BY PAYMENT_MONTH 
  ORDER BY 
    PAYMENT_MONTH
) AS MONTH_REVENUE, 
CUSTOMER_NAME, 
PRODUCT_FAMILY, 
PRODUCT_SUB_FAMILY, 
LAG(PRODUCT_FAMILY) OVER(
  PARTITION BY CUSTOMER_ID, 
  PAYMENT_MONTH 
  ORDER BY 
    PAYMENT_MONTH
) AS LAST_PRODUCT, 
LAG(PRODUCT_SUB_FAMILY) OVER(
  PARTITION BY CUSTOMER_ID, 
  PAYMENT_MONTH 
  ORDER BY 
    PAYMENT_MONTH
) AS LAST_PRODUCT_SUB 
FROM 
  JOB_PORTAL.PREP.prep_fulldata 
ORDER BY 
  CUSTOMER_ID, 
  PAYMENT_MONTH
        );
[0m19:30:19.353507 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:30:19.733834 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f676da5-299b-4a74-aabe-cc40a7ca3faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B257A9DF0>]}
[0m19:30:19.733834 [info ] [Thread-1 (]: 20 of 22 OK created sql table model JOB_PORTAL.KPI.cross_sell_and_product_churn  [[32mSUCCESS 1[0m in 3.56s]
[0m19:30:19.733834 [debug] [Thread-1 (]: Finished running node model.mini_project.cross_sell_and_product_churn
[0m19:30:19.733834 [debug] [Thread-1 (]: Began running node model.mini_project.mart_cross_sell_and_product_churn
[0m19:30:19.733834 [info ] [Thread-1 (]: 22 of 22 START sql table model JOB_PORTAL.MART.mart_cross_sell_and_product_churn  [RUN]
[0m19:30:19.733834 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.cross_sell_and_product_churn, now model.mini_project.mart_cross_sell_and_product_churn)
[0m19:30:19.733834 [debug] [Thread-1 (]: Began compiling node model.mini_project.mart_cross_sell_and_product_churn
[0m19:30:19.733834 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.mart_cross_sell_and_product_churn"
[0m19:30:19.733834 [debug] [Thread-1 (]: Timing info for model.mini_project.mart_cross_sell_and_product_churn (compile): 19:30:19.733834 => 19:30:19.733834
[0m19:30:19.733834 [debug] [Thread-1 (]: Began executing node model.mini_project.mart_cross_sell_and_product_churn
[0m19:30:19.746606 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.mart_cross_sell_and_product_churn"
[0m19:30:19.746606 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.mart_cross_sell_and_product_churn"
[0m19:30:19.746606 [debug] [Thread-1 (]: On model.mini_project.mart_cross_sell_and_product_churn: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.mart_cross_sell_and_product_churn"} */
create or replace transient table JOB_PORTAL.MART.mart_cross_sell_and_product_churn
         as
        (
SELECT
     *
FROM
    JOB_PORTAL.KPI.cross_sell_and_product_churn
        );
[0m19:30:19.746606 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:30:22.393094 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:30:22.400976 [debug] [Thread-2 (]: Timing info for model.mini_project.prep_extradata (execute): 19:30:19.337365 => 19:30:22.399975
[0m19:30:22.401976 [debug] [Thread-2 (]: On model.mini_project.prep_extradata: Close
[0m19:30:23.050855 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f676da5-299b-4a74-aabe-cc40a7ca3faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B257A9B50>]}
[0m19:30:23.050855 [info ] [Thread-2 (]: 21 of 22 OK created sql table model JOB_PORTAL.PREP.prep_extradata ............. [[32mSUCCESS 1[0m in 3.73s]
[0m19:30:23.050855 [debug] [Thread-2 (]: Finished running node model.mini_project.prep_extradata
[0m19:30:23.166205 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:30:23.166205 [debug] [Thread-1 (]: Timing info for model.mini_project.mart_cross_sell_and_product_churn (execute): 19:30:19.733834 => 19:30:23.166205
[0m19:30:23.166205 [debug] [Thread-1 (]: On model.mini_project.mart_cross_sell_and_product_churn: Close
[0m19:30:23.825622 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f676da5-299b-4a74-aabe-cc40a7ca3faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B257AA870>]}
[0m19:30:23.826625 [info ] [Thread-1 (]: 22 of 22 OK created sql table model JOB_PORTAL.MART.mart_cross_sell_and_product_churn  [[32mSUCCESS 1[0m in 4.09s]
[0m19:30:23.827620 [debug] [Thread-1 (]: Finished running node model.mini_project.mart_cross_sell_and_product_churn
[0m19:30:23.830868 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:30:23.831659 [debug] [MainThread]: Connection 'list_JOB_PORTAL' was properly closed.
[0m19:30:23.831659 [debug] [MainThread]: Connection 'list_JOB_PORTAL' was properly closed.
[0m19:30:23.831659 [debug] [MainThread]: Connection 'list_JOB_PORTAL_PREP' was properly closed.
[0m19:30:23.832887 [debug] [MainThread]: Connection 'list_JOB_PORTAL_KPI' was properly closed.
[0m19:30:23.832887 [debug] [MainThread]: Connection 'model.mini_project.mart_cross_sell_and_product_churn' was properly closed.
[0m19:30:23.833886 [debug] [MainThread]: Connection 'model.mini_project.prep_extradata' was properly closed.
[0m19:30:23.833886 [info ] [MainThread]: 
[0m19:30:23.834886 [info ] [MainThread]: Finished running 22 table models in 0 hours 0 minutes and 49.69 seconds (49.69s).
[0m19:30:23.840887 [debug] [MainThread]: Command end result
[0m19:30:23.856476 [info ] [MainThread]: 
[0m19:30:23.857477 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:30:23.857477 [info ] [MainThread]: 
[0m19:30:23.858582 [info ] [MainThread]: Done. PASS=22 WARN=0 ERROR=0 SKIP=0 TOTAL=22
[0m19:30:23.859591 [debug] [MainThread]: Command `dbt run` succeeded at 19:30:23.859591 after 50.45 seconds
[0m19:30:23.859591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B234F4D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B234F4E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B234F5100>]}
[0m19:30:25.326555 [debug] [MainThread]: Flushing usage events
