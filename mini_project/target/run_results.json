{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.19", "generated_at": "2025-03-14T14:00:23.835852Z", "invocation_id": "4f676da5-299b-4a74-aabe-cc40a7ca3faa", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T13:59:46.668917Z", "completed_at": "2025-03-14T13:59:46.691515Z"}, {"name": "execute", "started_at": "2025-03-14T13:59:46.695351Z", "completed_at": "2025-03-14T13:59:49.375985Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.3577520847320557, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb00e7-0004-bb9d-0005-d15300019442"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.mini_project.raw_customers", "compiled": true, "compiled_code": "\nSELECT \n    * \nFROM \n    MINI_PROJECT.RAW.Customers \n    WHERE CUSTOMER_ID \n          IS NOT NULL", "relation_name": "JOB_PORTAL.RAW.raw_customers"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T13:59:46.684873Z", "completed_at": "2025-03-14T13:59:46.700725Z"}, {"name": "execute", "started_at": "2025-03-14T13:59:46.716766Z", "completed_at": "2025-03-14T13:59:49.394516Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 3.38702130317688, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb00e7-0004-c144-0005-d1530001d15e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.mini_project.raw_products", "compiled": true, "compiled_code": "\nSELECT \n     *\nFROM \n     MINI_PROJECT.RAW.Products \n     WHERE PRODUCT_ID \n           IS NOT NULL", "relation_name": "JOB_PORTAL.RAW.raw_products"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T13:59:50.078969Z", "completed_at": "2025-03-14T13:59:50.089699Z"}, {"name": "execute", "started_at": "2025-03-14T13:59:50.089699Z", "completed_at": "2025-03-14T13:59:52.643613Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 3.208757162094116, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb00e7-0004-bb9f-0005-d1530001a3ba"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.mini_project.prep_customers", "compiled": true, "compiled_code": "\nWITH CTE_1 AS(\n    SELECT DISTINCT\n    LOWER(TRIM(COMPANY)) AS COMPANY,\n    CUSTOMER_ID::NUMBER AS CUSTOMER_ID,\n    LOWER(\n        REGEXP_REPLACE(\n            TRIM(REGEXP_SUBSTR(CUSTOMERNAME, '^[^(]+')), \n            ',', \n            ''\n        )\n    ) AS CUSTOMERNAME,  --  name without commas\n\n    \nFROM JOB_PORTAL.RAW.raw_customers\n)\nSELECT\n    C.COMPANY,\n    C.CUSTOMER_ID,\n    C.CUSTOMERNAME,\n    T.country\nFROM CTE_1 C LEFT JOIN MINI_PROJECT.RAW.Mapping T ON C.CUSTOMER_ID = T.CUSTOMER_ID", "relation_name": "JOB_PORTAL.PREP.prep_customers"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T13:59:50.062574Z", "completed_at": "2025-03-14T13:59:50.078969Z"}, {"name": "execute", "started_at": "2025-03-14T13:59:50.078969Z", "completed_at": "2025-03-14T13:59:52.719963Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.3181114196777344, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb00e7-0004-bde4-0005-d1530001c1da"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.mini_project.raw_transaction", "compiled": true, "compiled_code": "\nSELECT \n     *\nFROM \n    MINI_PROJECT.RAW.Transaction \n    WHERE CUSTOMER_ID \n          IS NOT NULL", "relation_name": "JOB_PORTAL.RAW.raw_transaction"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T13:59:53.363812Z", "completed_at": "2025-03-14T13:59:53.379848Z"}, {"name": "execute", "started_at": "2025-03-14T13:59:53.379848Z", "completed_at": "2025-03-14T13:59:56.027840Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.3378069400787354, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb00e7-0004-c144-0005-d1530001d162"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.mini_project.prep_transaction", "compiled": true, "compiled_code": "\n    SELECT DISTINCT\n        CUSTOMER_ID::NUMBER AS CUSTOMER_ID,\n        PRODUCT_ID::VARCHAR AS PRODUCT_ID,\n        TO_DATE(PAYMENT_MONTH) AS PAYMENT_MONTH,\n        REVENUE_TYPE::NUMBER AS REVENUE_TYPE,\n        REVENUE::NUMBER(38,2) AS REVENUE,\n        QUANTITY::NUMBER AS QUANTITY,\n        LOWER(TRIM(COMPANIES)) AS COMPANIES\n    FROM JOB_PORTAL.RAW.raw_transaction", "relation_name": "JOB_PORTAL.PREP.prep_transaction"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T13:59:53.289734Z", "completed_at": "2025-03-14T13:59:53.289734Z"}, {"name": "execute", "started_at": "2025-03-14T13:59:53.289734Z", "completed_at": "2025-03-14T13:59:56.121380Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 3.4760992527008057, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb00e7-0004-c0bd-0005-d15300018c8e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.mini_project.prep_products", "compiled": true, "compiled_code": "\nSELECT \n    PRODUCT_ID::VARCHAR AS PRODUCT_ID,\n    LOWER(TRIM(PRODUCT_FAMILY)) AS PRODUCT_FAMILY,\n    LOWER(TRIM(PRODUCT_SUB_FAMILY)) AS PRODUCT_SUB_FAMILY\nFROM JOB_PORTAL.RAW.raw_products", "relation_name": "JOB_PORTAL.PREP.prep_products"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T13:59:56.701619Z", "completed_at": "2025-03-14T13:59:56.717422Z"}, {"name": "execute", "started_at": "2025-03-14T13:59:56.717422Z", "completed_at": "2025-03-14T13:59:59.137472Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.084221839904785, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb00e7-0004-bb9f-0005-d1530001a3be"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.mini_project.churn_and_newcustomers", "compiled": true, "compiled_code": "\nWITH\n  CTE_1 AS (\n    SELECT\n      MAX(PAYMENT_MONTH) AS EOP\n    FROM\n      JOB_PORTAL.PREP.prep_transaction\n  ),\n  CTE_2 AS (\n    SELECT\n      *\n    FROM\n      JOB_PORTAL.PREP.prep_transaction\n      INNER JOIN CTE_1 AS CT ON 1 = 1\n  ),\n  CTE_3 AS (\n    SELECT\n      CUSTOMER_ID,\n      MAX(PAYMENT_MONTH) AS LATEST,\n      MIN(PAYMENT_MONTH) AS FIRST,\n      DATEADD (MONTH, -3, EOP) AS L3M,\n      EOP,\n      CASE\n        WHEN (FIRST <= L3M) THEN 0\n        ELSE 1\n      END AS IS_NEW,\n      CASE\n        WHEN (\n          FIRST <= L3M\n          AND LATEST < EOP\n        ) THEN 1\n        ELSE 0\n      END AS IS_CHURN\n    FROM\n      CTE_2\n    GROUP BY\n      CUSTOMER_ID,\n      EOP\n  )\nSELECT\n  SUM(IS_CHURN) AS CHURNED_CUSTOMERS,\n  SUM(IS_NEW) AS NEW_CUSTOMERS,\n  EOP\nFROM\n  CTE_3\nGROUP BY\n  EOP", "relation_name": "JOB_PORTAL.KPI.churn_and_newcustomers"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T13:59:56.765834Z", "completed_at": "2025-03-14T13:59:56.780863Z"}, {"name": "execute", "started_at": "2025-03-14T13:59:56.781869Z", "completed_at": "2025-03-14T13:59:59.252370Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 3.1557559967041016, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb00e7-0004-bde4-0005-d1530001c1de"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.mini_project.customer_rank", "compiled": true, "compiled_code": "\nwith\n  cte_1 as (\n    select\n      T.customer_id,\n      c.customername,\n      c.country,\n      sum(T.revenue) as revenue\n    from\n      JOB_PORTAL.PREP.prep_transaction T\n      LEFT JOIN JOB_PORTAL.PREP.prep_customers c on T.customer_id = c.customer_id\n    where\n      T.revenue_type = 1\n    group by\n      T.customer_id,\n      c.customername,\n      c.country\n  ),\n  cte_2 as (\n    select\n      customer_id,\n      customername,\n      country,\n      revenue,\n      dense_rank() over (\n        order by\n          revenue desc\n      )\n    from\n      cte_1\n  )\nselect\n  *\nfrom\n  cte_2", "relation_name": "JOB_PORTAL.KPI.customer_rank"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T13:59:59.921590Z", "completed_at": "2025-03-14T13:59:59.928353Z"}, {"name": "execute", "started_at": "2025-03-14T13:59:59.928353Z", "completed_at": "2025-03-14T14:00:02.197900Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 2.938856840133667, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb00e7-0004-bde4-0005-d1530001c1e2"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.mini_project.monthly_loss", "compiled": true, "compiled_code": "\nWITH revenue_loss AS(\n  SELECT \n    payment_month, \n    SUM(revenue) AS this_month_revenue, \n    LAG (\n      SUM(revenue)\n    ) OVER (\n      ORDER BY \n        payment_month\n    ) AS previous_month_revenue \n  FROM \n    JOB_PORTAL.PREP.prep_transaction \n  where \n    revenue_type = 1 \n  GROUP BY \n    payment_month\n) \nSELECT \n  PAYMENT_MONTH, \n  this_month_revenue, \n  PREVIOUS_MONTH_REVENUE, \n  This_month_revenue - PREVIOUS_MONTH_REVENUE AS MONTHLY_LOSS \nFROM \n  revenue_loss \nwhere \n  monthly_loss < 0 \nORDER BY \n  payment_month", "relation_name": "JOB_PORTAL.KPI.monthly_loss"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T13:59:59.785841Z", "completed_at": "2025-03-14T13:59:59.799285Z"}, {"name": "execute", "started_at": "2025-03-14T13:59:59.799285Z", "completed_at": "2025-03-14T14:00:02.153472Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.2633297443389893, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb00e7-0004-bb9f-0005-d1530001a3c2"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.mini_project.fiscal_year_logos", "compiled": true, "compiled_code": "\nWITH CTE_1 AS(\n  SELECT \n    CUSTOMER_ID, \n    MIN(PAYMENT_MONTH) AS FIRST_MONTH \n  FROM \n    JOB_PORTAL.PREP.prep_transaction \n  GROUP BY \n    CUSTOMER_ID\n) \nSELECT \n  DISTINCT DATE_TRUNC('YEAR', FIRST_MONTH) AS FISCAL_YEAR, \n  (\n    COUNT(CUSTOMER_ID)\n  ) AS NEW_CUSTOMERS \nFROM \n  CTE_1 \nGROUP BY \n  FISCAL_YEAR", "relation_name": "JOB_PORTAL.KPI.fiscal_year_logos"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T14:00:02.865534Z", "completed_at": "2025-03-14T14:00:02.869476Z"}, {"name": "execute", "started_at": "2025-03-14T14:00:02.870477Z", "completed_at": "2025-03-14T14:00:05.415023Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 3.1899759769439697, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb00e8-0004-bde4-0005-d1530001c1e6"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.mini_project.nrr_and_drr", "compiled": true, "compiled_code": "with prev as (\n    select\n        customer_id,\n        revenue,\n        lag(revenue) over (partition by customer_id order by PAYMENT_MONTH) as previous_revenue\n    from JOB_PORTAL.PREP.prep_transaction\n),\ntransactions AS (\n SELECT\n        customer_id,\n        SUM(revenue) AS total_revenue,  \n        sum(previous_revenue) as prev_total_revenue,\n        CASE WHEN total_revenue > prev_total_revenue THEN total_revenue-prev_total_revenue ELSE 0 END AS expansion_revenue,  \n        CASE WHEN total_revenue < prev_total_revenue THEN prev_total_revenue-total_revenue ELSE 0 END AS contraction_revenue  \n    FROM prev\n    GROUP BY 1\n)\nSELECT\n    customer_id,\n    total_revenue,\n    prev_total_revenue,\n    expansion_revenue,\n    contraction_revenue,\n    CASE\n        WHEN total_revenue = 0 THEN 0\n        ELSE (((total_revenue)+(expansion_revenue - contraction_revenue)) / total_revenue)*100\n    END AS net_revenue_retention_in_percentage,\n    CASE\n        WHEN total_revenue = 0 THEN 0\n        ELSE (((total_revenue)-(expansion_revenue - contraction_revenue)) / total_revenue)*100\n    END AS gross_revenue_retention_in_percentage\nFROM transactions", "relation_name": "JOB_PORTAL.KPI.nrr_and_drr"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T14:00:03.055152Z", "completed_at": "2025-03-14T14:00:03.059562Z"}, {"name": "execute", "started_at": "2025-03-14T14:00:03.060614Z", "completed_at": "2025-03-14T14:00:05.717698Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.3282597064971924, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb00e8-0004-bb9f-0005-d1530001a3c6"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.mini_project.product_rank", "compiled": true, "compiled_code": "\nwith\n  cte_1 as (\n    select\n      product_id,\n      sum(revenue) as revenue\n    from\n      JOB_PORTAL.PREP.prep_transaction\n    where\n      revenue_type = 1\n    group by\n      product_id\n  ),\n  cte_2 as (\n    select\n      product_id,\n      revenue,\n      dense_rank() over (\n        order by\n          revenue desc\n      )\n    from\n      cte_1\n  )\nselect\n  *\nfrom\n  cte_2", "relation_name": "JOB_PORTAL.KPI.product_rank"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T14:00:06.393923Z", "completed_at": "2025-03-14T14:00:06.398859Z"}, {"name": "execute", "started_at": "2025-03-14T14:00:06.400859Z", "completed_at": "2025-03-14T14:00:08.833602Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.1039276123046875, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb00e8-0004-c144-0005-d1530001d16a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.mini_project.mart_churn_and_newcustomers", "compiled": true, "compiled_code": "\nSELECT\n     *\nFROM\n    JOB_PORTAL.KPI.churn_and_newcustomers", "relation_name": "JOB_PORTAL.MART.mart_churn_and_newcustomers"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T14:00:06.054477Z", "completed_at": "2025-03-14T14:00:06.067351Z"}, {"name": "execute", "started_at": "2025-03-14T14:00:06.067351Z", "completed_at": "2025-03-14T14:00:09.060424Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 3.652146339416504, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb00e8-0004-c144-0005-d1530001d166"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.mini_project.prep_fulldata", "compiled": true, "compiled_code": "\nWITH CTE_1 AS(\n    SELECT DISTINCT\n        ST.CUSTOMER_ID,\n        ST.PRODUCT_ID,\n        ST.PAYMENT_MONTH,\n        ST.REVENUE,\n        ST.REVENUE_TYPE,\n        ST.QUANTITY,\n        CUST.COMPANY AS CUSTOMER_COMPANY,\n        CUST.CUSTOMERNAME AS CUSTOMER_NAME,\n        PROD.PRODUCT_FAMILY,\n        PROD.PRODUCT_SUB_FAMILY\n    FROM JOB_PORTAL.PREP.prep_transaction ST\n    LEFT JOIN JOB_PORTAL.PREP.prep_customers CUST ON ST.CUSTOMER_ID = CUST.CUSTOMER_ID\n    LEFT JOIN JOB_PORTAL.PREP.prep_products PROD ON ST.PRODUCT_ID = PROD.PRODUCT_ID\n)\nSELECT\n     *\nFROM\n    CTE_1\n    WHERE REVENUE_TYPE = 1", "relation_name": "JOB_PORTAL.PREP.prep_fulldata"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T14:00:09.713426Z", "completed_at": "2025-03-14T14:00:09.713426Z"}, {"name": "execute", "started_at": "2025-03-14T14:00:09.713426Z", "completed_at": "2025-03-14T14:00:12.359847Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 3.3045992851257324, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb00e8-0004-bb9f-0005-d1530001a3ca"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.mini_project.mart_monthly_loss", "compiled": true, "compiled_code": "\nSELECT\n     *\nFROM\n    JOB_PORTAL.KPI.monthly_loss", "relation_name": "JOB_PORTAL.MART.mart_monthly_loss"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T14:00:09.503824Z", "completed_at": "2025-03-14T14:00:09.510825Z"}, {"name": "execute", "started_at": "2025-03-14T14:00:09.512824Z", "completed_at": "2025-03-14T14:00:12.440375Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.598179340362549, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb00e8-0004-c0bd-0005-d15300018c92"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.mini_project.mart_customer_rank", "compiled": true, "compiled_code": "\nSELECT\n     *\nFROM\n    JOB_PORTAL.KPI.customer_rank", "relation_name": "JOB_PORTAL.MART.mart_customer_rank"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T14:00:13.018025Z", "completed_at": "2025-03-14T14:00:13.030064Z"}, {"name": "execute", "started_at": "2025-03-14T14:00:13.030064Z", "completed_at": "2025-03-14T14:00:15.474024Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 3.1306211948394775, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb00e8-0004-c144-0005-d1530001d16e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.mini_project.mart_fiscal_year_logos", "compiled": true, "compiled_code": "\nSELECT\n     *\nFROM\n    JOB_PORTAL.KPI.fiscal_year_logos", "relation_name": "JOB_PORTAL.MART.mart_fiscal_year_logos"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T14:00:13.108290Z", "completed_at": "2025-03-14T14:00:13.113293Z"}, {"name": "execute", "started_at": "2025-03-14T14:00:13.114253Z", "completed_at": "2025-03-14T14:00:15.505378Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.0586581230163574, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb00e8-0004-bb9f-0005-d1530001a3ce"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.mini_project.mart_nrr_and_drr", "compiled": true, "compiled_code": "\nSELECT\n     *\nFROM\n    JOB_PORTAL.KPI.nrr_and_drr", "relation_name": "JOB_PORTAL.MART.mart_nrr_and_drr"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T14:00:16.148647Z", "completed_at": "2025-03-14T14:00:16.156837Z"}, {"name": "execute", "started_at": "2025-03-14T14:00:16.160111Z", "completed_at": "2025-03-14T14:00:18.670277Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 3.172966241836548, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb00e8-0004-bb9f-0005-d1530001a3d2"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.mini_project.mart_product_rank", "compiled": true, "compiled_code": "\nSELECT\n     *\nFROM\n    JOB_PORTAL.KPI.product_rank", "relation_name": "JOB_PORTAL.MART.mart_product_rank"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T14:00:16.179349Z", "completed_at": "2025-03-14T14:00:16.184432Z"}, {"name": "execute", "started_at": "2025-03-14T14:00:16.185433Z", "completed_at": "2025-03-14T14:00:19.065313Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.557427406311035, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb00e8-0004-c0bd-0005-d15300018c96"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.mini_project.cross_sell_and_product_churn", "compiled": true, "compiled_code": "\n WITH customer_data AS (\n    SELECT\n        CUSTOMER_NAME,\n        PRODUCT_ID,\n        PRODUCT_FAMILY,\n        PAYMENT_MONTH\n    FROM\n        JOB_PORTAL.PREP.prep_fulldata\n),\nmax_payment_month AS (\n    SELECT\n        MAX(PAYMENT_MONTH) AS max_payment_month\n    FROM\n        JOB_PORTAL.PREP.prep_fulldata\n),\nfull_table AS (\n    SELECT\n        c.CUSTOMER_NAME,\n        c.PRODUCT_ID,\n        c.PRODUCT_FAMILY,\n        c.PAYMENT_MONTH,\n        m.max_payment_month\n    FROM\n        customer_data c\n    JOIN\n        max_payment_month m ON 1=1\n),\nproduct_count AS (\n    SELECT\n        CUSTOMER_NAME,\n        COUNT(DISTINCT PRODUCT_ID) AS product_count\n    FROM\n        customer_data\n    GROUP BY\n        CUSTOMER_NAME\n),\nproduct_churn AS (\n    SELECT\n        CUSTOMER_NAME,\n        COUNT(DISTINCT CASE WHEN PAYMENT_MONTH < DATEADD(MONTH,-3,max_payment_month) THEN PRODUCT_ID END) AS Product_Churn\n    FROM\n        full_table\n    GROUP BY\n        CUSTOMER_NAME\n),\nranked_customers AS (\n    SELECT\n        c.CUSTOMER_NAME,\n        c.product_count,\n        p.Product_Churn,\n        (c.product_count-p.Product_Churn) AS Cross_Sell,\n        DENSE_RANK() OVER (ORDER BY c.product_count-p.Product_Churn DESC) AS Cross_Sell_Rank,\n        DENSE_RANK() OVER (ORDER BY p.Product_Churn DESC) AS Product_Churn_Rank\n    FROM\n        product_count c\n    JOIN\n        product_churn p ON c.CUSTOMER_NAME = p.CUSTOMER_NAME\n)\nSELECT\n    CUSTOMER_NAME,\n    product_count,\n    Cross_Sell,\n    Product_Churn,\n    Cross_Sell_Rank,\n    Product_Churn_Rank\nFROM\n    ranked_customers\nORDER BY\n    Cross_Sell_Rank,\n    Product_Churn_Rank", "relation_name": "JOB_PORTAL.KPI.cross_sell_and_product_churn"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T14:00:19.321613Z", "completed_at": "2025-03-14T14:00:19.337365Z"}, {"name": "execute", "started_at": "2025-03-14T14:00:19.337365Z", "completed_at": "2025-03-14T14:00:22.399975Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 3.7292423248291016, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb00e8-0004-bde4-0005-d1530001c1ea"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.mini_project.prep_extradata", "compiled": true, "compiled_code": "SELECT CUSTOMER_ID, \nPRODUCT_ID, \nLAG(PAYMENT_MONTH) OVER(\n  PARTITION BY CUSTOMER_ID \n  ORDER BY \n    PAYMENT_MONTH\n) AS LAST_MONTH, \nPAYMENT_MONTH, \nREVENUE, \nSUM(REVENUE) OVER(\n  PARTITION BY PAYMENT_MONTH \n  ORDER BY \n    PAYMENT_MONTH\n) AS MONTH_REVENUE, \nCUSTOMER_NAME, \nPRODUCT_FAMILY, \nPRODUCT_SUB_FAMILY, \nLAG(PRODUCT_FAMILY) OVER(\n  PARTITION BY CUSTOMER_ID, \n  PAYMENT_MONTH \n  ORDER BY \n    PAYMENT_MONTH\n) AS LAST_PRODUCT, \nLAG(PRODUCT_SUB_FAMILY) OVER(\n  PARTITION BY CUSTOMER_ID, \n  PAYMENT_MONTH \n  ORDER BY \n    PAYMENT_MONTH\n) AS LAST_PRODUCT_SUB \nFROM \n  JOB_PORTAL.PREP.prep_fulldata \nORDER BY \n  CUSTOMER_ID, \n  PAYMENT_MONTH", "relation_name": "JOB_PORTAL.PREP.prep_extradata"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T14:00:19.733834Z", "completed_at": "2025-03-14T14:00:19.733834Z"}, {"name": "execute", "started_at": "2025-03-14T14:00:19.733834Z", "completed_at": "2025-03-14T14:00:23.166205Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.091788291931152, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb00e8-0004-c144-0005-d1530001d172"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.mini_project.mart_cross_sell_and_product_churn", "compiled": true, "compiled_code": "\nSELECT\n     *\nFROM\n    JOB_PORTAL.KPI.cross_sell_and_product_churn", "relation_name": "JOB_PORTAL.MART.mart_cross_sell_and_product_churn"}], "elapsed_time": 49.68505120277405, "args": {"partial_parse_file_diff": true, "log_level": "info", "use_colors": true, "use_colors_file": true, "introspect": true, "which": "run", "log_path": "C:\\Users\\DasariUday\\venv\\.venv\\mini_project\\logs", "profiles_dir": "C:\\Users\\DasariUday\\.dbt", "require_explicit_package_overrides_for_builtin_materializations": false, "defer": false, "version_check": true, "vars": {}, "strict_mode": false, "printer_width": 80, "invocation_command": "dbt run", "enable_legacy_logger": false, "print": true, "log_file_max_bytes": 10485760, "project_dir": "C:\\Users\\DasariUday\\venv\\.venv\\mini_project", "log_format_file": "debug", "log_format": "default", "macro_debugging": false, "static_parser": true, "populate_cache": true, "favor_state": false, "select": [], "show_resource_report": false, "write_json": true, "log_level_file": "debug", "warn_error_options": {"include": [], "exclude": []}, "exclude": [], "cache_selected_only": false, "indirect_selection": "eager", "quiet": false, "partial_parse": true, "send_anonymous_usage_stats": true}}